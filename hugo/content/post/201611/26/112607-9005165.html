+++
date = "2016-11-26T07:00:00"
title = "Android 手機越用越卡，這事兒得解決啊"
titleimage = "http://pic4.zhimg.com/fc22da4377aa6acf061f57c0b9714ee7.jpg"
ga = 112607
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">Android 手機是否會越用越卡？</h2>

<div class="answer">



<div class="content">
<p>【前言】答得不是很全面，也沒法一次性太詳細地展開，想到哪寫到哪，不然寫成論文就累死了&hellip;&hellip;想到別的點再更新吧&hellip;&hellip;</p>
<p>【原因分析】</p>
<p>Ｑ：</p>
<blockquote>不是說用個一會會有點卡頓，而是一個 Android 手機，用個半年後就怎麼刷機都不會跟最開始一樣流暢了。</blockquote>
<p>A：目前想到的可能原因有：</p>
<p>1，手機存儲芯片隨着使用自然變慢</p>
<p>有些手機存儲芯片是 TLC，可能有提供一個特性，在內部存儲區域的 dirty 區域小於 1/3 之前呈現 SLC 特性，隨着各種使用，最後 dirty 區域會大於 1/3，然後退化爲 TLC。TLC 慢，SLC 快。這個特性是 EMMC 廠商加速出廠時的刷機速度引入。</p>
<p>需要說明的是，可能並不是所有 TLC 都有這個特性，另外，對於大 size 的 emmc，這個性能下降並不明顯，低端一些的，比如 8G 的速度可能掉到幾 M 寫速度，16G 的到十多 M 順序寫，32G 和 64G 的會好一些，是變慢但可能影響不大，大部分場合都感覺不出來。</p>
<p>2，硬件老化和各種跌落導致零件損壞</p>
<p>如果有部分器件損壞，可能會導致相應的驅動以及上層服務工作異常，負載很高，從而導致其他正常任務無法獲得足夠的處理器資源而變慢。</p>
<p>3，各種器件，觸點老化導致手機能耗增加，容易發熱以後會觸發系統溫控，從而引起 cpu 降頻導致系統變慢</p>
<p>4，各種新的大版本升級固件相比第一版固件，往往沒有相當的研發和測試投入，可能會導致新固件反而沒有老固件優化到位，所以感覺卡頓。沒有優化到位，也可能有供應商的原因，比如說 GPU 的閉源庫更新可能無法跟上 Android 新的顯示架構更新。當然，不排除新版本因爲 Android 新版本引入了新技術（比如 ART）以及其他方面的優化技術積累而做得更好。</p>
<p>5，落下一個很重要的原因，那就是隨着硬件的更新換代，Android 也不停地迭代，並且幾乎每一個版本都耗費更多的資源（更多的是內存與 flash），所以就同樣的硬件配置，老版本 Android 可能順暢得很，而新版本已經跑不動了。隨着 Android 新功能的不斷增加，對內存的消耗已經是無法剎車了，早期 512M 的如果不做特殊的定製和裁剪，可能完全跑不動了，1G 的甚至都必須配 ZRAM swap（時間換空間）。但是，也需要看到 Google 其他方面的努力，比如說 ART，比如說下一代 Android Ｍ即將推出的 Doze 和 App Standby。</p>
<p>如果是針對同一個固件，原因則：</p>
<p>1，主要是各類軟件開啓後導致後臺軟件運行得越來越多，各類默認負載不斷加大，空閒處理器資源減少</p>
<p>2，隨着後臺應用的疊加，內存耗費也會逐步增加，導致最後空閒內存下降，新的任務啓動甚至老的任務回到前臺需要內存資源時可能需要觸發 zram swap 或者 lowmemkiller，這些都會不可避免的帶來延遲，而一旦有持續的內存泄露，甚至無法回收內存而會導致系統最後崩潰</p>
<p>3，還有一個特別典型的原因就是，當後臺駐留應用氾濫後，隨着內存耗費的增加，內存的碎片化會很嚴重，也就是物理連續的內存會越來越少，這會引起嚴重的 IO 性能衰退，可能會導致 IO 從順序操作轉變爲隨機操作。</p>
<p>4，類似地，隨着應用增多，系統更容易發熱，更容易觸發系統溫控，從而引起降頻等動作，各類資源供給降低自然會引起體驗下降</p>
<p>5，除此之外，部分溫控技術引入了降 FPS，這個是明顯影響用戶體驗感知的，當然這也無可厚非，平衡發熱和性能一直是硬件固化之後的必由之路</p>
<p>【解決辦法】</p>
<p>一，對用戶</p>
<p>1，一鍵清理後臺</p>
<p>2，自啓動管理，只允許部分自啓動</p>
<p>3，後臺管理，只允許部分後臺</p>
<p>3，重啓</p>
<p>4，換新機（建議選購時用 16G+，8G 的話確認下是不是 MLC，更多選購考慮的因素很多，沒法一一列出，後面有機會從技術的角度寫個新機選購指南。）</p>
<p>注：第 2，3 個有的系統自帶（包括最新版的 MIUI，Flyme 等都有自帶了），有的要安裝第三方 app，比如綠色守護，下一代 Android M 有 Doze+App Standby，具體效果如何，讓我們拭目以待吧。</p>
<p>二，對手機廠商</p>
<p>研發方面做好各類預研，選型，設計，開發，測試和優化，例如：</p>
<p>1，限制後臺任務個數</p>
<p>2，解決系統和內核內存泄露</p>
<p>3，錯誤注入與容錯</p>
<p>4，更均衡的 cpu/gpu/mem/emmc 等</p>
<p>5，做好結構散熱</p>
<p>6，優化系統能耗</p>
<p>7，智能清理後臺 + 白名單</p>
<p>8，優化應用</p>
<p>9，資源配額</p>
<p>10，防止信號干擾</p>
<p>11，自啓動管理 + 白名單 &hellip;&hellip;</p>
<p>其中，Android 本身在好幾個方面還有極大地改善空間，比如說 IO 資源配額和信息 Push，這些都是客製化廠商和 Google 需要努力的空間，甚至需要廠商之前協同制定統一的標準。</p>
<p>部分性能問題跟功耗關聯，有興趣可以看我早期寫的&ldquo;長篇大論&rdquo;，<a href="http://link.zhihu.com/?target=http%3A//www.tinylab.org/meizu-mx3-flyme-3-0-power-save-tech/">魅族 MX3 Flyme 3.0 省電技術詳解</a>，當然，裏頭的東西也不是很全面，後續有空再展開。</p>
<p>三，對應用開發廠商</p>
<p>很多應用做得很流氓，包括很多大廠，想盡辦法讓自己駐留在後臺，還沒有節制的活動；而另外一部分可能受限於技術積累和架構能力，開發出來的應用對各類系統資源的需求很大。前段時間 Google 放出了好多性能優化相關的視頻，這個是很好的信號吧，不過整個行業的應用質量要逐步提高起來，還是需要一個過程，先期望那些大廠能做一些實質的努力。</p>
<p>當然，供應商們的驅動，HAL 以及上層 APP 也會有很多優化的空間。</p>
<p>【結尾】</p>
<p>Android 在不斷地迭代，包括客製化廠商和 Google 都在不斷努力完善，所以長遠來看，體驗應該是不斷優化的...</p>
<p>對於用戶來說，學習一些選購知識和一些基本的用法就好了，實在不行就換個口碑更好的機子或者自己到體驗店或者借其他同學的手機感受下，然後稍微學習一些簡單的用法就好。好的系統的交互設計往往會降低用戶的學習成本。</p>
<p>對於身在客製化廠商或者應用開發的各類 Engineer，學習一些優化知識，研究各種改善體驗的技術，研究競品，相互學習，與公司內部各個部門協同，致力於改善用戶體驗應該是我們持久的使命。</p>
<p>除了性能，穩定性，功耗，溫控和安全等幾個，事關用戶的核心體驗，都需要整個行業一起努力，持續的優化。</p>
<p>用戶不是傻子，最後都得拿產品說話。</p>
</div>
</div>




</div>


</div>
</div>