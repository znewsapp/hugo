+++
date = "2016-11-17T12:00:00"
title = "大誤 · 「你談過幾個男朋友？」"
titleimage = "http://pic4.zhimg.com/22d65791d391845e192ab34e0a951ceb.jpg"
ga = 111712
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">如果一個女生說，她集齊了十二個星座的前男友，我們應該如何估計她前男友的數量？</h2>

<div class="answer">



<div class="content">
<img class="content-image" src="http://pic4.zhimg.com/70/92f0aaa35817cf6d022bf2ed6a5b6723_b.jpg" alt="">
<p>公式:</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5C%5BE%5Cleft%28+T+%5Cright%29+%3D+n%7BH_n%7D%5C%5D" alt="">
<p>數據:</p>
<p>{白羊座， 金牛座， 雙子座， 巨蟹座， 獅子座， 處女座， 天秤座， 天蠍座， 射手座， 摩羯座， 水瓶座， 雙魚座}</p>
<p>實現:</p>
<p>N@# HarmonicNumber@# &amp;@12</p>
<p>答案:37.2385</p>
<img class="content-image" src="http://pic2.zhimg.com/70/180e4efbf7390450cfbcf20234ae5fa9_b.jpg" alt="">
<p>公式:</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5C%5B%7Bp%5Ec%7D%5Cleft%28+n+%5Cright%29+%3D+%5Cfrac%7B%7Bc%21S_%7Bn+-+1%7D%5E%7B%5Cleft%28+%7Bc+-+1%7D+%5Cright%29%7D%7D%7D%7B%7B%7Bc%5En%7D%7D%7D%5C%5D" alt="">
<p>數據:</p>
<p>n=12</p>
<p>實現:</p>
<p>DiscretePlot[c!StirlingS2[n-1，c-1]/c^n/.c-&gt;12，{n，1，100}]</p>
<p>答案:</p>
<img class="content-image" src="http://pic3.zhimg.com/70/424407568218ea0f68a3a12e0b221d7e_b.jpg" alt="">
<p>有 10%的把握少於 17 個，有 50%的把握少於 35 個。<br>有 90%的把握少於 55 個，有 99%的把握少於 82 個。</p>
<img class="content-image" src="http://pic3.zhimg.com/70/d39b15c11fe335f4587b66a9fda9dffa_b.jpg" alt="">
<p>公式</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5C%5B%5Cint_0%5E%5Cinfty++%7B1+-+%5Cmathop+%5Cprod+%5Climits_%7Bi+%3D+1%7D%5En+%5Cleft%28+%7B1+-+%7Be%5E%7B+-+%7Bp_i%7Dt%7D%7D%7D+%5Cright%29%7B%5Ctext%7Bd%7D%7Dt%7D+%5C%5D" alt="">
<p>數據</p>
<p>額外假設 1：題主是中國人，所以使用中國的星座分佈數據</p>
<p>額外假設 2：題主是適齡青年，所以使用年齡 18-36 的星座分佈數據</p>
<p>第一個是白羊座，然後是金牛，以此類推&hellip;&hellip;</p>
<p>p={0.1028，0.0911，0.0843，0.0822，0.0848，0.085，0.0857，0.0795，0.0753，0.0761，0.0808，0.073}</p>
<p>注 1:不要吐槽總和不是 1，因爲有舍入誤差&hellip;&hellip;</p>
<p>實現</p>
<p>NIntegrate[1-Fold[Times，1，1-E^（-#t）&amp;/@p]，{t，0，9527}]</p>
<p>答案:37.7424，就比均勻分佈多了 0.5 個&hellip;&hellip;</p>
<p>可以類比均值不等式理解爲何分佈默認均勻的時候最小</p>
<img class="content-image" src="http://pic2.zhimg.com/70/09acf2be9fb963cdb1d583e3bf8acf81_b.jpg" alt="">
<p>比如&hellip;&hellip;哦不&hellip;&hellip;顯然</p>
<p>上任是處女（座），估摸着下任怎麼着也不會是處女（座）了&hellip;&hellip;</p>
<p>上任是天蠍（座），那麼我打包票，你不會也不敢有下任了&hellip;&hellip;</p>
<p>然後順便把上面的星座分佈不均也考慮進去&hellip;&hellip;</p>
<p>所以我們可以用一個轉移矩陣來刻畫這個情況。</p>
<p>或者畫成 12 個節點的加權有向圖&hellip;&hellip;</p>
<img class="content-image" src="http://pic3.zhimg.com/70/f91a4eb0c895ea1906c1b9bdc43691b2_b.jpg" alt="">
<p>然後求這個加權圖 G 的隨機遊走覆蓋時間（Cover Time）</p>
<p>考慮到嚴謹性我應該證明一下上面的一堆公式，不過上面三個公式每個都能寫篇大論文，知乎短短篇幅說不清，所以解釋就化歸到這個問題一併解決&hellip;&hellip;</p>
<p>隨機遊走</p>
<ul>
<li>把 12 星座畫成 12 個節點，然後可以作爲下任的話就畫個箭頭</li>
<li>箭頭有個粗細程度，這個叫加權，加權決定了選這個下任的概率有多大，實際概率波動不大所以不明顯</li>
<li>分析這 144 個關係全都畫出來就是上面這張圖</li>
<li>選男友的過程數學上被稱爲圖 G 上的隨機遊走</li>
</ul>
<p>Cover Time</p>
<ul>
<li>這些節點全部經過至少一遍所需要的時間叫做<strong>Cover Time</strong></li>
<li>子問題包括各種<strong>著名概率問題</strong>，生日問題啊，贈券收集啊等等&hellip;&hellip;</li>
<li>衍生問題還有復遍歷，多重遍歷什麼的，可以有效用於<strong>氪金估計</strong>&hellip;&hellip;</li>
<li>退化問題，退化爲 Tree 的話可以相當有效的進行<strong>爬蟲策略優化</strong>&hellip;&hellip;</li>
</ul>
<p>顯然上面三個公式都是這個問題的特例</p>
<ol>
<li>小學生:12 階非加權完全圖的 Cover Time</li>
<li>初中生:12 階非加權完全圖指定 Cover 程度後的 Time 分佈</li>
<li>高中生:12 階加權完全圖的 Cover Time</li>
</ol>
<p>這個問題數學上來說的話不難，窮舉所有路徑首次通過時間的分佈的平均值的交錯和就行了&hellip;&hellip;寫成公式就是這樣：</p>
<p>記 A 爲 G 的所有可能通過的路徑</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5C%5B%7B%5Ctau+_G%7D+%3D+%5Csum%5Climits_A+%7B%7B%7B%5Cleft%28+%7B+-+1%7D+%5Cright%29%7D%5E%7B%5Cleft%7C+A+%5Cright%7C+-+1%7D%7DE%5Cleft%28+%7B%7BT_A%7D%7D+%5Cright%29%7D+%5C%5D" alt="">
<p>雖然能寫出公式然而並沒有什麼用，求解精確值還是個世界難題&hellip;&hellip;</p>
<p>寫成代碼是這個樣子的，複雜度足夠讓算法學家爆氣&hellip;&hellip;</p>
<p>幸好星座只有 12 個我的小 CPU 還能踉蹌跑完&hellip;&hellip;56 個民族的話到宇宙滅亡也跑不完</p>
<p>（*M 表示轉移矩陣,i 表示起始節點編號 *）</p>
<p>CoverTime[M_,i_]:=Module[{Start,Roads,Ex,Si},<br> Start=ConstantArray[0,Length[M]];Start[[i]]=1;<br> Roads=Subsets[DeleteCases[Range@Length[M],i]][[2;;-1]];<br> Ex=Mean@FirstPassageTimeDistribution[<br> DiscreteMarkovProcess[Start,M],#]&amp;/@Roads;<br> Si=If[Length[#]~Mod~2==1,1,-1]&amp;/@Roads;<br> Total[Ex*Si]];<br>CoverTime[M,#]&amp;/@Range[12]</p>
<p>而且蒙特卡洛效果也不太，,小規模精度不，,大規模基本跑不完&hellip;&hellip;</p>
<p>一般可以用 Matthews 逼近來稍稍有效的求一下上下界&hellip;&hellip;</p>
<p>見 Markov Chains and Mixing Times 一書</p>
<p>忘記說計算結果，初始節點對最後的結果影響不，所以第一個男友很重要啊</p>
<p>第一任是處女座的話最，只要 31.64 ，其他都在在 35-38 之間&hellip;&hellip;</p>
<img class="content-image" src="http://pic3.zhimg.com/70/13e2483894001135666ee1af40d3ca72_b.jpg" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5C%5B%5Cfrac%7B1%7D%7Be%7D%5C%5D" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5C%5B%5Cfrac%7B1%7D%7Be%7D%5C%5D" alt="">
<p>Well&hellip;&hellip;S，Reasons to believe that you are the 13th rebound guy&hellip;&hellip;</p>
<p>簡單地說就是找 12 個星座的男生採樣比較均勻&hellip;&hellip;</p>
<p>如果你相信真愛的，說不定是這種情況：</p>
<img class="content-image" src="http://pic3.zhimg.com/70/051aa4c1a4a1358956bbb4ca17e10de2_b.jpg" alt="">
<hr>
<p>編輯瞎注：圖片來自網絡，侵刪</p>
</div>
</div>

<div class="answer">



<div class="content">
<p>你們這邊技術大咖和數學大咖太欺負人，動不動就寫程序做模擬，或者拋個名詞和公式而不給解釋。讓我這個小白之友放出一個小學數學的解法。</p>
<p>要想集齊 12 個星座的前男友，需要經歷 13 個狀態：</p>
<ul>
<li>(狀態 0) 玩過 0 個星座的男友</li>
<li>(狀態 1) 玩過 1 個星座的男友</li>
<li>&hellip;&hellip;</li>
<li>(狀態 12) 玩過 12 個星座的男友</li>
</ul>
<p>狀態 0 是初始態，狀態 12 是終止態，這 13 個狀態是順序發生而一個不能漏的。</p>
<p>要實現狀態升級，就需要玩新的男友，且他們中有人的星座之前沒玩過。</p>
<ul>
<li>從狀態 0 到 1，只要玩 1(=12/12) 個就好。因爲之前本姑娘還處於含苞待放的狀態</li>
<li>從狀態 1 到 2，新玩男友數量的期望值爲 12/11。因爲之前已經玩過一個星座，所以遇到一個新星座男友的概率爲(12-1)/12</li>
<li>&hellip;&hellip;</li>
<li>從狀態 i 到 i+1，新玩男友的期望值爲 12/(12-i)。因爲之前已經玩過 i 個星座，所以遇到一個新星座男友的概率爲(12-i)/12</li>
<li>&hellip;&hellip;</li>
<li>從狀態 11 到 12，完成任務，新玩男友的期望值爲 12/1。因爲之前已經玩過 11 個星座，所以遇到一個新星座男友的概率爲(12-11)/12</li>
</ul>
<p>把這 12 次狀態升級所需的新男友數量的期望值加在一起就等於前男友數量的期望值，12/12+12/11+12/10+...+12/1=37.23</p>
<p>最後再提醒一下各位宅男，準確的說，37.23 是該妹子初次集滿 12 星座時候的前男友數目期望值，而不是該妹子前男友的期望值。因爲，集滿 12 星座之後，妹子是否還收集 12 個生肖以及 12 種「不可描述」，還未得知。千萬不要興奮過早，如同郭德綱的一個相聲所說：于謙老婆的前男友夠一幅麻將，（于謙說，四個呀？），錯，一副麻將牌！！！</p>
</div>
</div>




</div>


</div>
</div>