+++
date = "2017-01-19T10:00:00"
title = "把互聯網叫做「信息高速公路」，真是太貼切了"
titleimage = "http://pic3.zhimg.com/0b354a64499be043cfd18706bc60d8d6.jpg"
ga = 011910
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">運營商對帶寬進行限制的原理是怎樣的？</h2>

<div class="answer">



<div class="content">
<p>這個問題很有趣，更像一個科學幻想，我只問一個現實問題：<strong>如果用戶之間直連的話，那用戶需要幾塊網卡？</strong></p>
<p>如果是一塊，則只能倆倆相連，網線也有長度限制，一般不推薦超過 100 米，也就是說你只能和鄰居 P2P 連接，那麼你們倆就是一個孤島。</p>
<p>如果是兩塊，可以形成一個封閉的鏈狀（頭尾相連），</p>
<img class="content-image" src="http://pic3.zhimg.com/70/v2-97bef9a3e74684936bc6bc51909957d2_b.jpg" alt="">
<p>理論上應該沒有問題，需要專業人員配置，但是一旦中間有用戶關機了，整個網絡就全斷了。</p>
<p>通過以上分析，用戶要和自己需要通信的朋友都有一個 P2P 物理連接<strong>（Full Mesh）</strong>，有的朋友在東北長白山，有的在青藏高原，有的在美國夏威夷，難不成拉一條海底光纜把你們連接起來？</p>
<p>我們需要面對現實，接下來談談通信網絡的一般構造，其實通信網絡的構思和高速公路網的構思是一樣的：</p>
<img class="content-image" src="http://pic2.zhimg.com/70/v2-5336ed177c1907da1c63201ceea14f59_b.jpg" alt="">
<p><strong>主幹高速（核心網）</strong></p>
<p>首先建造幾條縱橫交錯（南北方向、東西方向）的主幹高速：如京滬高速、京粵高速、瀋海高速、京哈高速、滬渝高速、滬昆高速、滬陝高速、連霍高速，這些高速沿途有很多出入口，可以方便流量的流出、流入；高速之間有的還有交叉，方便流量的互相交換。</p>
<p><strong>主幹高速實現的任務：</strong>將用戶快速送達主幹高速的<strong>最靠近目的地網格。</strong></p>
<p><strong>支線高速（傳輸網）</strong></p>
<p>還需要建造一些支線高速，用於將車流輸送到主幹高速的入口，以及主幹高速流量的出口，比如上海的外環高速、滬嘉高速、延安高架路</p>
<p><strong>支線高速實現的任務：</strong>將車流<strong>匯聚導入</strong>到主幹高速（入方向），同時將主幹高速的流量疏散下來（出方向）。</p>
<p><strong>普通公路 （接入網）</strong></p>
<p>這些公路就是用戶去往目的地的第一段路，沒有這些路的存在，車流無法上支線高速、更無法上主幹高速；</p>
<p><strong>普通公路實現的任務：</strong>將汽車和公路網連接起來，沒有這個前提，汽車寸步難行。</p>
<p><strong>高速公路對車流的限速是在最靠近用戶的入口收費處。</strong></p>
<p>把以上的之<strong>主幹高速、支線高速、普通公路，換成核心網（Core）、傳輸網（Aggregate)、接入網(Access)，那麼就是通信網絡的一般構造。</strong></p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-5489fbe31431a12fd8ae5231447e70a8_b.jpg" alt="">
<p><strong>運營商如何對用戶限速</strong></p>
<p>限速的位置位於接入網的入口（最靠近用戶），一旦用戶流量跨過接入網，就不再限速。</p>
<p>限速的原理很簡單，在物理接口或虛擬接口下配置，有上下行方向 inbound /outbound，配置一二條命令即可，對於<strong>超出的流量</strong>可以丟（嚴格帶寬限制），也可以不丟（不嚴格帶寬限制，有一個前提，網絡不擁塞，如果擁塞，需要丟棄）。</p>
<p><strong>網絡流量是誰產生的？</strong></p>
<p>先來回答容易的問題，高速公路的車流量是誰產生的？很顯然是老司機，沒有老司機上路，高速公路收費處就是擺設，所以是司機們產生了車流量，我們稱之爲<strong>用戶流量（User Traffic）。</strong></p>
<p>爲了更好服務司機們，高速公路還有保養路段的車輛、清障車，也會產生一定的流量，我們稱之爲<strong>控制流量（Control Traffic）</strong>、<strong>管理流量（Management Traffic）</strong>，但相比用戶流量，這些流量可以忽略不計。</p>
<p>所以<strong>高速公路的流量是司機們製造的，這是流量的源頭。</strong></p>
<p>同理，網絡也有控制流量，網絡設備通過路由協議、標籤協議交換路由信息、轉發信息來爲用戶流量服務；也有管理流量，如網絡設備的配置流量、以及 SNMP 網絡故障報警的流量，但相比用戶流量，這些流量也可以忽略不計。</p>
<p><strong>網絡流量主要是各位老司機制造的（用戶流量）</strong></p>
<p>爲了克服各位老司機將自己 P2P 共享過快注入網絡，接入網採用上下行不對稱的方式，一般上行爲 200K-4M 不等，這樣就從源頭上限制了用戶流量注入運營商網絡的速度。</p>
<p>雖然老司機們下行很快，比如 100M，但是共享文件的源頭被限速了，所以下載會大受影響，儘管可以從多個 P2P 用戶共享同時傳輸。</p>
</div>
</div>




</div>


</div>
</div>