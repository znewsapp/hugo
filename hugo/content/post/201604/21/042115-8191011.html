+++
date = "2016-04-21T15:00:00"
title = "從零開始，用你最熟悉的工具，六步畫出一目瞭然的數據地圖"
titleimage = "http://pic2.zhimg.com/ec39f2a7765f180be040b2f9e7057911.jpg"
ga = 042115
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">怎麼在 Excel 上做數據地圖？</h2>

<div class="answer">



<div class="content">
<p>我在專欄（<a href="http://zhuanlan.zhihu.com/qianliang28">錢糧衚衕 28 號</a>）裏寫了一篇文章：<a href="http://zhuanlan.zhihu.com/p/20756711?refer=qianliang28">用 Excel 做出強大漂亮的數據地圖 - 錢糧衚衕 28 號</a> 放在這裏分享給大家。</p>
<p><strong>這個方法的好處是：1）不累，快；2）不需要任何插件；3）彈性強</strong>，可以利用同樣的方法，很快做出各種各樣的熱感地圖。</p>
<p><strong>#正文走起</strong></p>
<p>我個人比較喜歡從零 DIY 熱感地圖，學會了整套流程和方法，以後遇到任何類似問題都好解決。正好有很多知友在我的一些回答中問過我，我的那些熱感地圖怎麼做出來的（<strong>我的那些回答請參考這個答案末尾的各種熱感圖圖例</strong>）。借這個機會，<strong>我毅然決定</strong>，專寫一篇文章來說說我的數據地圖是怎麼畫的。</p>
<p>很簡單，<strong>按照我的方法，六步你就可以畫出自己的熱感地圖</strong>，不需要 GIS 軟件，各種地圖都適用。</p>
<p><strong>前提：</strong>你要有 Excel 這個軟件啊（否則搞毛），還要能上網啊（能看到這回答說明正在上網吧？）</p>
<p><strong>第一步</strong>：需要一張普通的地圖圖片</p>
<p>這個很簡單，網上到處都有。中國的省級地圖，地級市地圖，甚至縣級地圖都可以找到。<strong>這裏兩個小要求</strong>：1）儘量找張乾淨的圖，乾淨指的是地圖的邊界清晰；2）svg 格式的圖（Scalable Vector Graphics）- 別慌，<strong>推薦你個下載 svg 格式地圖模板的好去處</strong>： <a href="https://commons.wikimedia.org/">Wikimedia Commons</a></p>
<p>在這個網站搜索<strong>China provinces</strong>，可以得到下面這些圖（上百張），第一張圖就很符合我們的要求：</p>
<img class="content-image" src="http://pic2.zhimg.com/70/9706acb38864564516fce6cf4a75935d_b.jpg" alt="">
<p><strong>第二步：</strong>打開下載的 svg 圖。這裏推薦個免費開源的軟件：<a href="https://inkscape.org/en/">Inkscape</a>。用這個軟件打開 svg 的地圖，然後另存爲 Enhanced Meta File（emf）格式的文件。</p>
<p><strong>第三步：</strong>用 excel 導入 emf 的文件，然後 ungroup 這個地圖變成 freeform 的圖形，如下圖。</p>
<img class="content-image" src="http://pic4.zhimg.com/70/b049a89338e424877ae2b0a8eaf5f4fb_b.jpg" alt="">
<p>這樣我們就得到了 excel 裏面的地圖素材。</p>
<p><strong>第四步</strong>：每個省現在對應的名字都沒有，我們需要重新命名。簡單的方法：鼠標點擊選一個省，在左上角公式旁邊的文本框裏輸入省的名字，如下圖：</p>
<img class="content-image" src="http://pic4.zhimg.com/70/f5f697f5db4c33c787f812729fa581db_b.jpg" alt="">
<p><strong>第五步</strong>：在 excel 裏另建一個 worksheet，<strong>按照下圖來設計數據版面</strong>：</p>
<img class="content-image" src="http://pic2.zhimg.com/70/0b5dadbad3e0d72347a0ac096b6d9271_b.jpg" alt="">
<p><strong>漸變顏色可以自己選擇</strong>，目前這個例子是從 0 到 5 六種類別（顏色），根據你的研究需要（比如各省人均收入水平你按照高低分了 10 類，那就 10 種），隨便改多少種都可以，<strong>唯一注意的就是命名的區域要跟着變</strong>。<strong>再囉嗦一下</strong>：根據你自己的分類標準，篩選你的數據，將篩選後的分類結果（比如 6 種 0-5）對應到之前提到的類別中，這樣也就對應好了顏色。</p>
<p><strong>第六步</strong>：這些都做完了，<strong>在地圖那頁 worksheet 裏面加個按鈕，把下面這段 VBA 程序 copy 進去</strong>：</p>
<div class="highlight">
<pre><code class="language-text">For i = 2 To 32 '這裏是省的數量，2 代表的是後面連接的數據表起始位是第二行，可以根據你自己的設計更改

    Range("actRegProvince").Value = Range("Data_Province!D" &amp; i).Value '按順序選取數據表中省份
    
    ActiveSheet.Shapes(Range("actRegProvince").Value).Select '激活對應的省份地圖

    Selection.ShapeRange.Fill.ForeColor.RGB = Range(Range("actRegCodeProvince")).Interior.Color '將數據表中省份對應的顏色類別賦值給對應的省份地圖

Next i
</code></pre>
</div>
<p><strong>補充說明</strong>：Data_Province!D 中 Data_Province 是數據表（worksheet）的名字，D 指的是省份名字所在的列（見上面那張截圖）。根據自己的需要可以改成你喜歡的名字或位置。</p>
<p><strong>第七步</strong>：這步不算了啊！就是六步~</p>
<p><strong>點擊按鈕，享受成果，不謝!</strong></p>
<p>把剛纔的地圖換成紫色漸變色，效果如下：</p>
<img class="content-image" src="http://pic4.zhimg.com/70/6e819805077a4f7e869c4cc8d2a7bf43_b.jpg" alt="">
<p><strong>我過去的研究裏用過的一些樣圖</strong>（ps: 數據原因，有些圖未包含臺灣）<strong>：</strong></p>
<p><strong>地級市級別方言地圖，</strong>請參考：<a href="https://www.zhihu.com/question/29533414/answer/91734169">文化對經濟有着怎樣的影響？ - 錢糧衚衕的回答</a></p>
<img class="content-image" src="http://pic4.zhimg.com/70/286725982483a617db1cf127f0d935bf_b.jpg" alt="">
<p><strong>地級市層面經濟集羣圖</strong>，請參考：<a href="https://www.zhihu.com/question/26529595/answer/93279614">中國是否真的需要均衡發展？ - 錢糧衚衕的回答</a></p>
<img class="content-image" src="http://pic4.zhimg.com/70/b24a0b305a2e5347100f14c8e0706b5f_b.jpg" alt="">
<p><strong>神經網絡算法分類中國地級市</strong>，請參考：<a href="https://www.zhihu.com/question/37870042/answer/92024325">機器學習（machine learning）在經濟學領域是否有應用前景？ - 錢糧衚衕的回答</a></p>
<img class="content-image" src="http://pic4.zhimg.com/70/440af99809b8f062a1139e980506232b_b.jpg" alt="">
<p><strong>同樣方法制作縣級地圖</strong></p>
<img class="content-image" src="http://pic2.zhimg.com/70/f786fc32b53e916d4f685f360c8bd1c1_b.jpg" alt="">
<p>如果製作過程中遇到問題，請留言。</p>
</div>
</div>




</div>


</div>
</div>