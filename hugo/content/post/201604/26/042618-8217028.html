+++
date = "2016-04-26T18:00:00"
title = "原來這就是黑客們「幹壞事」時候的基本修養"
titleimage = "http://pic1.zhimg.com/46010d1d28a5a8b9a0c215d007cfd388.jpg"
ga = 042618
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">經常聽說某某網站被黑，請問黑人家網站的基本原理是什麼呢？</h2>

<div class="answer">



<div class="content">
<p>SQL</p>
<p>首先說明幾點基本背景知識：</p>
<p>1. 不管是代碼還是數據，它在計算機底層看來，都不過是二進制字節流而已，沒有區別；</p>
<p>2. 與程序交互往往意味着數據的輸入，黑客就可以寫一段代碼輸入進去；</p>
<p>3. 這就是<strong>&ldquo;遠程代碼執行&rdquo;</strong>漏洞了，感覺大部分漏洞都可以歸類於此。他本質上就是：使用某個輸入數據的時候，因爲各種各樣的原因，把這段數據作爲可執行程序運行了，然後就會出現寫這個輸入的黑客希望的結果了；</p>
<p>然後具體討論這個案例。</p>
<p><strong>第一步是 SQL 注入，網站裏最常見的注入攻擊之一。</strong></p>
<p>由於網站需要存儲數據，通常而言都會使用數據庫，而數據庫的查詢通常而言都會使用 SQL 語句。</p>
<p>關於 SQL 的介紹參見&nbsp;<a href="https://en.wikipedia.org/wiki/SQL">SQL</a>。</p>
<p>這裏提到的"注入點"，其實就是"提交一個特殊數據讓網站執行有害 SQL 語句"的點。</p>
<p>例如：</p>
<p>可能網站功能是輸入名字查詢信息，假設輸入的數據在後臺是$data,</p>
<p>那麼寫得不好的後臺可能會執行 select * from info where name = '$data'，</p>
<p>正常情況可能就是 select * from info where name = 'thyyyy'，</p>
<p>然而黑客可以寫這麼一個輸入: abc' or 'a'='a</p>
<p>這樣的話 語句變成了 select * from info where name = 'abc' or 'a'='a'，就變成查詢到全部數據了。</p>
<p>更實際的 SQL 注入會有更復雜的情況，以上只是舉例。</p>
<p>總之，他找到這樣的點之後，就可以執行他需要的語句，然後顯示出本無法看到的數據庫內容了。</p>
<p><strong>第二步是找到管理員權限，</strong></p>
<p>這裏他是利用上面的注入，查詢出數據庫裏的用戶數據，然後得到了 admin 密碼的 MD5 值。</p>
<p>md5 的介紹參見&nbsp;<a href="https://en.wikipedia.org/wiki/MD5">MD5</a>，</p>
<p>簡單來說 md5 是一個不可逆的函數，會把密碼映射成一個沒有規律的字符串，原則上講這樣是可以保護密碼的。</p>
<p>但它畢竟是一個確定的函數，因此 input 和 output 是對應的，因此機智的黑客們就想到，可以造一個表預先存好一些密碼對應的 md5，這樣就可以反查。 這個叫彩虹表：<a href="https://zh.wikipedia.org/wiki/%E5%BD%A9%E8%99%B9%E8%A1%A8">彩虹表</a></p>
<p>因此利用這樣的根據，使用了簡單密碼的話，還是很容易就被查表破解，於是這裏管理員密碼就被拿到了。</p>
<p><strong>第三步就是利用管理員權限去黑網站了</strong>，</p>
<p>不過管理員權限不是萬能的，所以這裏答主提到一句沒有上傳點，也就是說功能受限。</p>
<p>這裏他提到使用一個工具叫做&ldquo;菜刀&rdquo;打開了他的權限，這個工具我不太熟悉，瞭解的知友可以幫我補充一下。</p>
<p>這裏簡單查了一下，它的核心原理應該還是遠程代碼執行，通過給網站提交有害的 PHP 代碼，達到提升權限做各種各樣事情的能力。</p>
<p>做到這一步，網站裏所有文件都可以被修改了，那就意味着&ldquo;黑進去一個網站&rdquo;了。</p>
<p>以上根據個人淺薄的知識回答，望各位指正~</p>
</div>
</div>




</div>


</div>
</div>