+++
date = "2016-10-17T07:00:00"
title = "試着用數學建模來破案，發現毛利大叔其實做得不差"
titleimage = "http://pic4.zhimg.com/c0e9547e17f10699ab1f9ab69fbcaaa3.jpg"
ga = 101707
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">



<div class="question">
<h2 class="question-title">用樸素貝葉斯模型預測柯南里的被害人和兇手</h2>
<div class="answer">



<div class="content">
<p>這個研究是我在一門課上的期末作業，旨在用一些廣泛流傳的《柯南》"規律"（比如毛利小五郎指出的兇手大多是好人）預測兇手和被害人，並定量地探索作者&mdash;&mdash;青山剛昌&mdash;&mdash;在創作角色時的一些"隱藏信念"（hidden belief）。分析漫畫的研究我並沒有見過，不過還是有不少研究使用數學建模方法識別文學作品的作者 (Madigan, Genkin, Lewis, Argamon, Fradkin, &amp; Ye, 2005; Zhao &amp; Zobel, 2007; Zheng, Li, Chen &amp; Huang, 2006)， 或文學風格（比如中國古詩的風格 Yi, He, Li, &amp; Yu, 2004。這些作品大多使用主成分分析、機器學習等方法對文學作品中的詞彙、語法、結構和內容進行分析。</p>
<p>本文先介紹樸素貝葉斯模型通過角色特徵（性格、行爲、與他人關係等）預測其身份（兇手 / 被害人）的結果，再對一些相關的社會、心理學現象進行討論。總的來說，樸素貝葉斯模型建立在已有數據基礎上，此處使用長春版漫畫單行本 1-70 卷中的事件，以下稱"訓練數據"。模型先計算出訓練數據中角色擁有各種特徵（組合）時是兇手或被害人的概率，再以此預測新數據中角色的身份。</p>
<p>首先需要收集數據，即 1-70 卷的事件中的兇手、被害人都有些什麼特徵。因爲我感興趣的是殺人事件，類似於怪盜基德對決 / 少年偵探團尋寶這些沒有兇殺案發生的事件、自殺事件和兇手一開始就被鎖定的事件就被排除了。於是共 81 個事件被統計，皆有且只有一名兇手和一至兩名被害人。涉案角色（除主角、警察等）爲 3 至 9 不等，平均 5 人，共 404 名角色的二十個特徵被統計。</p>
<p>這些特徵的選擇基於個人經驗和一些大家熟悉的對劇情或人物的調侃。 比如兇手一開始大多慈眉善目甚至案發後有不在場證明；被害人一般都凶神惡煞讓人討厭，或者在大家說最好待在一起時非要自己待着；還有事後被證明無辜的人中有部分會被毛利大叔錯誤指認。這些特徵首先被以"0"、"1"編碼（表現出某個特徵則編碼爲 1，否則爲 0）。於是每個角色就有了 20 個代表他們特徵的值（由 0 或 1 組成），並且也有兩個值代表他們是否爲兇手或被害人（比如某個人是兇手，那麼他的這兩個值就是 1，0；是被害人就是 0，1；都不是就是 0，0）。</p>
<p>有了這些值之後就可以通過迴歸分析看兇手和被害人這兩個身份可能被哪些特徵預測了，這裏我使用了邏輯斯蒂迴歸（logistic linear regression）。這一步是因爲這二十個特徵並不一定都有很好的預測能力，預先篩選一下可以讓之後的貝葉斯模型更精簡。這一步後對"兇手"或"被害人"在.05 水平上顯著的特徵們被留下並進入貝葉斯模型。對兇手有預測能力（包括正相關和負相關）的特徵包括"對除主角以外的周圍人不友善"、"對周圍人友善"、"有不在場證明等有利證據"、"遭遇攻擊但未死"、"與死者是戀人或婚姻關係"。對被害人有預測能力的特徵包括"對除主角以外的周圍人不友善"、"對主角不友善"、"表現出緊張或驚恐"、"要自己待着"。被害人相關特徵在有人被殺前統計，因爲對被害人的預測需要在事件發生前做出；相反，兇手相關特徵則根據兇手被正確指出前所有角色的表現來統計。</p>
<p>接下來的一步是分別對兇手和被害人建立樸素貝葉斯模型，算出各個可能的特徵組合有多大概率對應"兇手"或"被害人"身份。兇手模型公式如下：</p>
<img class="content-image" src="https://pic2.zhimg.com/v2-5e63790e7abc890dc6502c37cd253941_b.png" alt="">
<p>等號左邊是我們要求的條件概率，即在一個角色有某些特徵時這個角色是兇手的概率。x1,...,xn 是各個特徵的取值的組合，如"1，0，0，1，1"。P((x1,...,xn)|offender)是所有兇手中出現某個特徵組合的概率。P(offender)是個先驗概率，對所有角色來說沒有區別，因此在實際計算中可忽略。等式右邊分母則是某個特徵組合在所有角色中出現的概率。</p>
<p>同理，被害人模型公式如下：</p>
<img class="content-image" src="https://pic4.zhimg.com/v2-817785634373e490451009c691d5e7df_b.png" alt="">
<p>在對全部訓練數據中的 404 個角色進行計算之後，我們就得到了各個特徵組合對應的兇手概率和被害人概率。然後就可以把這兩個概率應用在新數據（70 卷之後的單行本）上了。具體來說，就是先把新數據中每個涉案角色的特徵組合統計出來，然後分別計算他們是兇手或被害人的概率。在每個事件中，"兇手"概率最高的人被預測爲兇手，"被害人"概率最高的人被預測爲被害人。如果出現多於一個概率最高值，則擁有這個值的人都被預測爲兇手 / 被害人。</p>
<p>之後就是計算模型預測準確率並將其與機遇水平（瞎蒙正確率）相比較。那麼預測準確率怎麼算呢？如果是隻預測其中一個人爲兇手，那麼在每個事件中預測對了就記爲 100%，錯了就記爲 0；如果預測多於一人（M 人，M&gt;1）爲兇手，且其中一個正確，則記爲（100/M）%，如果沒有一個正確則記爲 0。預測被害人準確率的計算與預測兇手準確率類似，只是被害人有可能多於一個。這種情況下，完全預測正確記爲 100%，只預測正確其中一人記爲 50%。預測兇手的機遇水平爲(100/A)%，此處 A 爲還活着的人的人數，因爲被害人已經被排除了；預測被害人的機遇水平爲(100/N)%，N 爲事件涉案人數。總的來說預測被害人的機遇水平更低一些。結果如圖：</p>
<img class="content-image" src="https://pic1.zhimg.com/v2-a2f8302c57d0a350174de50e0a99a3a8_b.png" alt="">
<p>左圖爲預測兇手的模型準確率與機遇水平，模型將兇手範圍從 3.7 人（平均值）縮小到 2.2 人。右圖爲預測被害人的模型準確率與機遇水平，模型講被害人範圍從 4.9 人縮小到 1.4 人。</p>
<p>可以看到預測兇手的模型表現還是比較一般，於是我加入了另外三個特徵以期對其進行提升，結果如下：</p>
<img class="content-image" src="https://pic1.zhimg.com/v2-0dd0761742df96ea20c7b926d8af09ec_b.png" alt="">
<p>基本算是將 3.7 人中的 2 人排除了，不盡如人意但還是有所提高。</p>
<p>總得來說，通過這些特徵預測被害人的準確率高於預測兇手的準確率，這說明青山對被害人的塑造更爲臉譜化，而兇手特徵則比較多變。從偵探漫畫的角度來說也可以理解，畢竟作者不能讓讀者僅通過一些性格、行爲表現就輕易將兇手猜出來。儘管如此，以上模型還是反映出青山在創作兇手角色時的一些隱藏信念，或者說用於"隱藏"兇手的技法，比如兇手在一開始時通常很友好，而不友好或表現出與被害人不和的反而可能是清白的。此外，作者也利用了大家普遍擁有的一個想法&mdash;&mdash;沒人會傷害自己&mdash;&mdash;來試圖隱藏真兇。若干兇手都在事件過程中傷害自己（雖然沒有死）。</p>
<p>更值得注意的是作者塑造被害人時的"臉譜化"，它反映了一個在司法領域和社會文化上有很大影響的心理現象&mdash;&mdash;正義世界謬誤（"just-world" fallacy）。這個概念由 Lerner and Simmons 在 1966 年首次提出。在他們的第一個研究中，被試的任務是觀察另一個人（受害者）在學習任務中的表現並對這個人做出評價。被觀察的人之所以被稱爲受害者，是因爲其在任務中犯錯時會遭受電擊。雖然這只是實驗的一部分，但至少被試看到被觀察者在遭受電擊時很疼。研究者發現，當被試得知並相信被觀察者還要在第二輪任務中遭受電擊、且自己無力改變被觀察者的悲慘命運時，被試對被觀察者的評價更低。這反映出人們根深蒂固的"善有善報，惡有惡報"的信念，人們傾向於認爲個人得到的結果是由其自身行爲造成的，世界是相對正義且公平的，有一種無形且普適的力量在維持世間的平衡 (Hafer &amp; Begue, 2005; Lerner, 1980)。這是因爲人們需要證據來相信自己生活在一個正義的世界，從而不會感到時刻受到威脅。 這種信念在很多時候會成爲對受害者的二次打擊，比如"認爲強姦案受害者本身不檢點"這種想法在我們的生活中也是不少見。</p>
<p>此外，一味地積極評價受害人也會對犯罪者的審判產生影響。有研究表明，當陪審團相信受害人是一個值得尊敬的人時，他們會多受害人及其家庭產生更多的同情，並傾向於認爲犯罪者的罪行更爲嚴重（Greene, Koehring, &amp; Quiat，1998)。直覺上這種情緒會導致犯罪者的量刑更重，事實也的確如此。當被害人被描述得更值得尊重或更有人格魅力時，犯罪者會更可能被判處監禁 (Landy &amp; Aronson, 1969)。</p>
<p>總得來說，人不總是理性的。我們對人、事、物的判斷會受到自己固有信念的影響，而我們的決定也會被當前情感所左右。有時候這些"人之常情"並沒有大的影響，但有的時候可能會決定另一個人的命運。在會對他人產生影響的時候，理性就顯得更爲重要。</p>
<p>最後說一點兒與本文內容無關的話：在寫這個作業時我的本意只是把我最喜歡的動漫作品與我喜歡的數學、人類行爲結合起來，但事後證明我的收穫遠不止做了一件我喜歡做的事&mdash;&mdash;女朋友（當時還是小學姐）因爲這篇論文芳心暗屬了 XD。當時看到小學姐熱情洋溢的"評論 / 吐槽"我還是很驚喜的，沒想到我如此得意的東西得到了另一個人的高度認可。就我個人而言，最搭的戀愛就是我做自己的時候，她也很開心。</p>
<p>今天正好在一起半年，發這篇紀念一下。</p>
<p>P.S. 我得爲毛利大叔正名，在統計的 81 個事件中大叔錯誤指出兇手的案件只有 12 個，其實概率還是不太大的。大概這麼爲人津津樂道只是因爲這個角色太深入人心了&hellip;&hellip;</p>
<p>具體的參考文獻列表可點擊「查看知乎討論」獲取。</p>



</div>
</div>
</div>


</div>
</div>