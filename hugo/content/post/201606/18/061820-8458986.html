+++
date = "2016-06-18T20:00:00"
title = "聽上去很有用的 iOS 10 來電自動識別，目前還很簡陋"
titleimage = "http://pic3.zhimg.com/fa5be09d4a3eda2e3c679d8aba34cb72.jpg"
ga = 061820
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">iOS 10 如何實現來電號碼識別？</h2>

<div class="answer">



<div class="content">
<p>作爲在中國的通訊安全行業奮戰了多年的一名程序猿，我覺得我是很有資格來回答這個問題的，相信關注這個問題的大家都知道，在本屆 WWDC 上蘋果推出了 Call Kit ，Call Kit 是 iOS 10 十大新特性之一，其帶來的一項重要的功能就是開放了來電識別功能。（根據蘋果官方的說法是專門爲了照顧中國用戶而開放的，也由此可見蘋果對中國市場的高度關注以及對中國騷擾電話的憂慮。）</p>
<p>但事實上我想說的是 iOS 10 來電識別的原理實際上非常簡單（簡陋）。</p>
<p>爲什麼說他簡陋呢，讓我來<strong>&ldquo;言簡意賅&rdquo;</strong>的給大家說明一下，如下圖中右側所示，爲 iOS 提供識別功能的第三方 App（例如搜狗號碼通）只需（僅能）通過系統提供的接口，預先將號碼和對應的識別結果寫入系統內部的數據庫中。來電時，系統會根據預設的號碼進行識別，而第三方 App 則完全無法參與識別過程。根據蘋果官方的說法，不直接把號碼交給第三方 App 進行查詢可以保護用戶隱私，但此舉也極大的限制了來電識別的效果。這種方式導致第三方 App 僅能通過預先內置少量（相對於雲端數據）號碼的方式進行識別，而無法利用雲端數據提供強大的服務，導致識別率直接損失一半。</p>
<img class="content-image" src="http://pic1.zhimg.com/70/f8a37c7a0f2502e142c35df10c487aa0_b.jpg" alt="">
<p>熟悉來電識別功能的同學應該已經注意到，iOS 10 的識別邏輯其實和兩年前搜狗號碼通 Lite 版完全相同。當時搜狗號碼通爲了繞開系統限制，創造性（腦洞大開）的通過把高頻號碼寫入通訊錄的方式，迂迴實現了來電識別功能。但這種實現方式除了由於號碼數量的限制導致的識別率降低，還帶來了諸如通訊錄卡頓等副作用，使得用戶和業內人士的評價褒貶不一。但爲了幫助那些對來電識別強烈需求的 iOS 用戶，我們最終決定犧牲一些口碑發佈了 Lite 版。而現在 iOS 10 提供的方式是把號碼庫從通訊錄轉移到了一個獨立的系統數據庫，雖然可以避免之前的諸多問題，但並沒有太多本質上的改進。</p>
<p><strong>iOS 10 來電識別的預期效果如何？</strong></p>
<p>關於識別率，我個人還是對目前 iOS 10 的做法表示擔憂。如前所述，iOS 與之前搜狗號碼通的 Lite 版一樣，僅由系統依賴本地數據庫離線識別，這與安卓系統中第三方 App 完全參與的在線識別方式有較大差距。</p>
<p>首先，本地號碼數量十分有限（本地的數萬相對雲端的數億）。如前圖所示，目前安卓系統中無論是搜狗號碼通還是其他第三方 App 都對整個識別過程有完整的控制權，既可以通過預先同步的本地號碼庫進行離線識別，也可以聯網請求雲端強大的識別服務。本地庫覆蓋高頻號碼，而云服務則包含了所有的長尾數據。離開了雲端服務，就失去了大量相對低頻來電號碼的識別能力。</p>
<p>其次，本地號碼無法隨時更新。當時安卓版本地號碼庫僅僅從每週更新提升至每天，就爲識別率帶來了超過 10% 的相對提升。可見及時更新的顯著效果。然而本地號碼庫很難做到時刻更新，也必然會因此降低識別質量。</p>
<p>所以，雲端服務在來電識別中依然會發揮巨大作用，而離開了雲端服務的本地識別效果勢必大打折扣。</p>
<p><strong>如何提高本地號碼庫的識別率？</strong></p>
<p>既然 iOS 不允許第三方應用參與來電識別過程，那麼預先寫入系統的本地號碼庫就對實際識別效果起到了決定性的作用。由於系統本地號碼庫的容量十分有限，如何優化這個本地庫就成爲了能否最大限度識別來電的關鍵性問題。</p>
<p>如果我們能夠把某個用戶可能接到的所有電話，按來電的可能性從大到小排列好，那麼我們在號碼庫容量有限的前提下，一定是優先存入排在前面最有可能來電的號碼，才能夠達到最高的識別率。正如下圖所示，隨着數據庫中號碼量的增加，識別率會逐漸提高，但越往後增長的速度越慢。</p>
<img class="content-image" src="http://pic1.zhimg.com/70/d466292bcaf5bc1f8981362268a1309c_b.jpg" alt="">
<p>然而理想狀況總是美好的，現實卻很骨感。我們並沒有所有號碼的身份信息，也無法知道每個用戶來電的概率。所以如何在現有的號碼身份數據中爲每位用戶量身預測來電數據，就成爲了提高本地號碼庫識別率的最關鍵問題。從最初搜狗號碼通安卓版發佈時起，我們就已經非常重視本地號碼庫的研究和改進，併爲此投入了大量精力。在多年的優化過程中，我們通過從多個維度、針對各個用戶篩選出電概率最大的號碼，加上之後 iOS Lite 版小容量號碼庫的優化經驗，最終在號碼數量不變的情況下，使識別率提高了一倍。（雖然這已經是業內的領先水平，但依然和搜狗號碼通 Android 版的雲端識別率有非常大的差距。輸入法都有完全訪問，來電識別爲什麼不給在線查！</p>
<p><strong>安裝多個識別 App 能否提高識別率？</strong></p>
<p>從目前看，iOS 10 的確支持多個 App 提供多份數據供系統進行號碼識別。聽上去是不是之前的問題都解決了？一個 App 的本地數據量有限，我多裝 7 個、8 個就可以了。然而事實並沒有這麼簡單，關於使用多個來電識別 App 能否有效提高識別率，我認爲並不樂觀。</p>
<p>因爲在系統的限制下，各個 App 都會努力把各自認爲的高頻號碼集成進來。雖然現在大家對本地號碼庫的理解和實現還有所差距，但隨着數據質量的提升，勢必導致各個 App 數據的重合度非常高，從而很難通過多個 App 得到號碼絕對數量的提升。但是如果能夠出現協作（拜託怎麼可能），或是一個廠商發佈多個 App （或多個數據庫，尚不知是否可行）以覆蓋不同維度的號碼的話，也許還是有幫助的。</p>
<p><strong>結論</strong></p>
<p>iOS 10 雖然無法最大程度的實現號碼識別服務，但畢竟讓號碼識別服務成爲了可能。我們依然期待 iOS 後續能像對輸入法一樣，在號碼識別服務上爲用戶提供更多的選擇，使開發者能爲用戶提供更完美的服務。</p>
<p>當然，目前 iOS 10 還處於 beta 階段，現有功能隨時可能改動，任何結論性的觀點都還爲時過早，一切都還需要等到正式版發佈纔有定論，讓我們拭目以待。</p>
<p>利益相關方：搜狗號碼通</p>
</div>
</div>




</div>


</div>
</div>