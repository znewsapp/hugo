+++
date = "2016-08-03T08:00:00"
title = "VR 實現 120 幀刷新，索尼這回又搞出黑科技了嗎？"
titleimage = "http://pic2.zhimg.com/d2a788b296f4b359252368a25fea64b9.jpg"
ga = 080308
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">PS VR 是如何實現 120 Hz 的刷新率的？刷新頻率高是一種顯著優勢嗎？</h2>

<div class="answer">



<div class="content">
<p>Sony 是通過 Asynchronous Reprojection 來輔助做到 120 幀的遊戲顯示，但並不能說是假的。</p>
<p>首先要確認的是，PSVR 屏幕支持三種模式，1，原生 60fps 的渲染幀率, 再通過 Asynchronous Reprojection 轉換成 120；2，原生 120hz；3，原生 90hz。這是後來的新固件支持的新模式。</p>
<p>是的，有原生的真 120hz 的顯示刷新率，只要你對應用優化夠好，或者應用本身就對機能要求不高。至於 90hz，自然是折中的一種方案，開發者如果發現自己的應用超過 60fps 輕鬆，達到 120 又困難，那可以選擇這個來作爲優化目標。</p>
<p>而把 60 通過重投射的方式翻倍的做法比較扎眼，導致大家忽略了 2 和 3。</p>
<p>顯然，這種方式並不是靈丹妙藥，肯定有侷限性，不然索尼也不會推出原生 90 和 120 的模式。</p>
<p>首先要指出的是，無論是基於這個技術的硬件 OLED，還是異步重投影技術，都是 Oculus 給 Sony 的建議。基本上 Reprojection = Timewarp</p>
<p>在索尼 2014 年 GDC 上首次公佈 Project Morpheus 的時候，屏幕用的還是普通的 LCD 屏幕，至於宣佈 120 Hz 全 RGB 像素排列的 1080p OLED 屏，已經是 2015 年的 GDC 了。</p>
<p>用上 OLED 自然爲的是低餘暉，而 120hz 也是爲了降低低餘暉可能帶來的閃爍問題。關於低餘暉，就是利用 OLED 自發光可以快速開關像素的特性來讓每一幀只顯示一兩毫秒的方式，以此來降低拖影，和早期的 CRT 類似。背光發光的 LCD 像素開關沒法那麼快，所以以前寧願用大笨顯示器的電子競技職業選手可不是矯情，別人真的是覺得液晶屏模糊。</p>
<p>不過由於每一幀持續時間，如果按 60hz 刷新率的顯示屏來算的話，只有 16.7 毫秒，意味着十多毫秒都是黑的，所以會讓一部分敏感人羣察覺到閃爍。基於這個原因，索尼決定直接通過重投影把幀率翻倍。</p>
<p>重投影的具體方式是這樣的：渲染一幀畫面的開銷是很大的，有可能十多毫秒。對於延遲要求極高的 VR 來說，你得到目前頭顯位置再渲染再傳回屏幕的 MTP 延遲，一旦錯過當前幀的 vsync，延遲就直接到下一個幀之後了。</p>
<p>而 Timewarp/Reprojection 就是想辦法去充分利用兩幀之間畫面接近的特性，用盡量小的開銷來生成對應當前人眼位置的方式。由於傳感器是 1000hz 的，意味着每一毫秒都會有新的位置數據。於是<strong>你可以在刷新下一幀畫面之前，利用最新的位置數據扭曲最近的一幀畫面來對應你的頭部數據</strong>。</p>
<p>而異步，則是把這個線程和圖像渲染線程分離開來。如果在一起順序進行的話，由於 vsync 的時刻是固定的，一旦當前一幀畫面沒有渲染完成，Timewarp 也被延後了，失去了它的意義。解決的方式是在每一幀 vsync 之前以一定的空餘時間量強制進行 Timewarp，那麼就會涉及到 context switch，如果是 Nvidia 顯卡的話由於用到 preemption 會有固定的毫秒級的開銷，而且細密度只能在 drawcall 邊界，如果開發者一個 drawcall 太長也會 miss 掉一個 vsync。按 Oculus 的說法，即使是三角形級別的細膩度都是不夠的。但是由於索尼在策劃 PS4 時期就引入了 ACE 異步計算引擎，因此不會有這些問題。異步重投影就是一幀是真實的，下一幀就是根據上一幀通過上面<strong>黑字</strong>的方式人工生成的（有很多人說插幀或者中間幀，指的是通過前一幀和後一幀的平均值得到的，意味着你得先得到後一幀數據才行，因此只能延遲至少兩幀的顯示時間才行得通，對於電視來說沒影響但在 VR 裏這種程度的延遲是不能接受的）。Oculus 和索尼的不同在於，索尼是每隔一幀固定用一次，用這個來進行幀率翻倍，生成僞畫面；而 Oculus 則是每一幀都會扭一下來保證當前幀率不掉到 90 以下。Valve 這邊目前沒有用這種方式，不過在他們兩年的 Advanced Rendering 演講裏多次提到相關研究以及一些類似的解決方式。</p>
<p>本質上來講，這類似於在玩家攝像機位的圖像渲染線程之外，還有一個以玩家攝像機機位爲圓心的球的顯示線程以 120hz 的刷新率在運行；玩家如果頭動得足夠快，機器畫面渲染不跟上，理論上是可以看到身後的空白 / 虛無。而如果你關閉了這種方式，效果就是一旦卡了，機能跟不上了，畫面就會卡在玩家眼前而不隨頭部運動發生改變，這時候人的體驗就和被一拳打臉上的感覺差不多。</p>
<p>當然，這種方式本身會有一些缺陷，比如最簡單的，一旦畫面中有移動的物體，顯然當前幀根據上一幀扭曲得到的畫面這個物體還是在原來的位置，那麼這個物體雖然相對你的大腦理解位置還是對的，但是在下一幀更新時會有突然跳一下的現象出現。</p>
<p>另外，所有根據你的攝像機向量得到的效果，都會出現奇怪的問題，什麼鏡面高光和反射之類的，都是基於你的眼睛向量得到的，而在扭曲的時候並不會照顧到。</p>
<p>最後就是，牽扯到位置改變（translation），而不僅僅是方向（orientation）改變的話，複雜度一下子上升很多。方向改變基本上就是把上一幀按新位置扭一下就好了，而方位改變則意味着本來被擋住的地方可能會露出來，而上一幀根本就沒有被擋住的地方的數據。再加上透明、抗鋸齒等等&hellip;&hellip;</p>
<p>E3 上我體驗蝙蝠俠的時候，當我拿起鋼琴架上的照片相框來回翻看時，重投影的 artifacts 就出現了，手的部分開始跳動，類似你在迪廳裏跳舞時那種頻閃燈造成的效果一樣。</p>
<p>因此，這個補幀的方式是爲了在性能跟不上和卡頓時，也能照顧人大腦對現實世界理解的一種顯示方式。如果你優化夠牛，還是可以直接 90，甚至 120。</p>
</div>
</div>




</div>


</div>
</div>