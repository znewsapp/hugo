+++
date = "2017-05-31T13:00:00"
title = "草莓是紅的？然而相機會告訴你——不是"
titleimage = "https://pic4.zhimg.com/v2-b624e346b143e47de6ecdc20a6cd67ff.jpg"
ga = 053113
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">



<div class="question">
<h2 class="question-title">色溫、白平衡與色彩恆常性</h2>
<div class="answer">



<div class="content">
<p>有關色彩理論相關的文章，在這個專欄裏已經有三篇了（<a class="internal" href="https://zhuanlan.zhihu.com/p/24214731">《色彩空間基礎》</a>、 <a class="internal" href="https://zhuanlan.zhihu.com/p/24281841">《色彩空間表示與轉換》</a>、<a class="internal" href="https://zhuanlan.zhihu.com/p/24312022">《光譜渲染的幾個例子》</a>） 在三篇文章中，我介紹了色彩空間的基礎知識，並利用這些知識將物理上的「顏色」與顯示器的 RGB 數值聯繫起來，得到了我稱之爲「光譜渲染」的技術。</p>
<p>在這三篇文章之後我就沒有繼續寫關於色彩理論的文章了，一方面固然是覺得自己在理論積累方面還有所欠缺，不敢在知乎上班門弄斧，二來自己也沒有一個整體性的思路，零碎的知識點寫起來缺乏一個統一的脈絡。前兩天在知乎上刷出了一個問題 <a class="internal" href="https://www.zhihu.com/question/60266964">如何理解和分析手機相機的白平衡？</a>，裏面提到了相機白平衡的話題，似乎討論的還挺激烈，不免又勾起了心裏想寫點東西的慾望。</p>
<p>我現在刷知乎，發現很多時候爭論的各方其實都不明白各自討論的問題「定義」是什麼，討論來討論去，也不過是雞同鴨講，最後不免互相撕逼。在這篇文章裏我從我自己理解的角度出發，梳理一下與白平衡相關的幾個概念，在明確了概念的基礎上，再對這個問題進行深入的探討。</p>
<p><strong>1 色溫</strong></p>
<p>色溫這個概念是從黑體輻射來的。根據日常的經驗我們可以知道，給一個鐵塊加熱，隨着溫度升高，鐵塊開始是暗紅色，逐漸變成亮紅色，如果能達到鍊鋼爐裏那樣的高溫，鐵融化成鐵水，發出耀眼的金黃色光芒。而天文學家也告訴我們，宇宙中的恆星可以看做一個個黑體，隨着恆星溫度的升高，恆星的顏色也是從紅色到黃色，非常高溫度的恆星甚至發出偏藍色的光。</p>
<p>在之前的文章 <a class="internal" href="https://zhuanlan.zhihu.com/p/24312022">《光譜渲染的幾個例子》</a> 裏，我給出了一個簡單的例子，直接渲染了不同溫度下黑體輻射的顏色。下圖就是渲染出的不同溫度黑體的顏色。</p>
<img class="content-image" src="http://pic4.zhimg.com/v2-ae0b3bf51c241bdd3620d0eece24b07b_b.png" alt="">
<p>（黑體輻射的顏色）</p>
<p>從這個例子裏可以看出，隨着溫度的升高，黑體的顏色從暗紅到亮紅，逐漸到金黃色，再慢慢到藍色。在下面這個色品圖上可以看得更清楚，隨着溫度升高，黑體顏色在色品圖上移動，形成一條曲線軌跡。這條軌跡從右下角的紅色區域出發，經過黃色區域，中間的白色區域，到達左側的藍色區域。這條軌跡就叫做 <a class=" wrap external" href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/Planckian_locus" target="_blank" rel="nofollow noreferrer">普朗克軌跡</a>。下圖顯示了色品圖上的普朗克軌跡（來自維基百科 <a class=" wrap external" href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/Planckian_locus" target="_blank" rel="nofollow noreferrer">普朗克軌跡</a>）</p>
<img class="content-image" src="http://pic2.zhimg.com/v2-57a253d8d380357057c6d7ed157a98d9_b.png" alt="">
<p>（普朗克軌跡）</p>
<p>我們日常生活中，最重要的光源就是太陽，太陽發出的光很接近黑體光譜。我們的太陽表面溫度約爲 5500K，這個溫度的黑體發出的光，基本就是白色。讀過本專欄之前文章的讀者朋友肯定能理解，這當然不是巧合。在色彩空間中我們需要定義一個白點，而常見的一些標準白點，就是以 5500K 左右的黑體輻射（也就是我們的太陽）爲基礎的。CIE 委員會規定的幾種標準白點中，D50、D55 和 D65 是常用的白點，參照了 5000K、5500K 和 6500K 的黑體輻射來定義，模擬了不同條件下（比如地平線方向的光照，上下午的室外，正午室外）的光照。色彩空間 <a class=" wrap external" href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/SRGB" target="_blank" rel="nofollow noreferrer">sRGB</a> 所依賴的白點就是 D65。</p>
<p>對於色溫，通常有幾個誤解。第一個誤解是混淆了色溫和情感上的溫度傾向。我們必須理解，色溫是根據黑體輻射溫度來定義的，是物理上的溫度，而不是情感上的溫度。從我們的情感上來說，橙色紅色給人感覺溫暖，藍色給人感覺寒冷。但從色溫的定義來看，紅色橙色是溫度較低的黑體發出的顏色，而溫度高的黑體顏色反而是藍色。</p>
<p>第二個誤解是混淆了色溫針對的對象。狹義上來說，色溫是針對光源的。比如晴朗正午的室外，光源是太陽（以及部分藍天），這個時候的光源接近標準光源 D65，色溫接近 6500K；又比如說傍晚日落，經過大氣層的散射，陽光中的藍光大大減少，光線顏色偏黃，光源顏色也許接近 3500K 的黑體。</p>
<p>很多關於色溫方面的爭論都是從這兩個誤解而來，搞清楚討論對象的定義，很多爭論也就煙消雲散了。</p>
<p><strong>2 白平衡</strong></p>
<p>在本專欄之前的文章 <a class="internal" href="https://zhuanlan.zhihu.com/p/24214731">《色彩空間基礎》</a> 中提到，物理世界裏是無所謂「顏色」這個概念的，一切都是 <a class=" wrap external" href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/Spectral_power_distribution" target="_blank" rel="nofollow noreferrer">光譜功率分佈</a>，所謂的「顏色」，是人類視覺過程產生的一種感受。正是如此，我們纔有了「三原色」理論，我們纔可以用三種顏色的光來模擬世間萬物的顏色。</p>
<p>生活常識告訴我們，光源的顏色不同，照射到同一個物體上，會引起物體顏色的變化。從單純的物理的角度來看，這個事情再正常不過了。光源有光譜功率分佈，物體對不同波長的光線又有不同的反射率，那麼光源照射到物體上，再反射到眼睛裏的光，它的光譜功率分佈就和光源密切相關了。不同的光源，照射到同樣的物體上，物體反射光的光譜功率分佈就會不一樣。下圖展示了一個例子，物體的反射率是對藍色光更高，對紅色光更低。第一行的光源是一個接近白色的光源，照射到物體上之後，反射的光線就是藍色；而第二行的光源是一個黃色的光源，照射到物體上之後，反射的光線是偏棕紅色的。</p>
<img class="content-image" src="http://pic2.zhimg.com/v2-4fffd993107f75019f6db0d822cf6089_b.png" alt="">
<p>（不同光源下物體有不同顏色）</p>
<p>這裏需要再強調一下，物理上沒有所謂的「顏色」的概念，只有「光譜功率分佈」、「反射率」這些概念。一個物體的反射率是固定不變的，但是這個物體的「顏色」在不同條件下是不一樣的。</p>
<p>我們可以用一個標準白點（比如 D65）作爲光源，照射到物體上。我們認爲這個時候物體表現出來的「顏色」就是物體「本來」的顏色，可以定義爲物體的「固有色」。很顯然，固有色的光譜功率分佈曲線與物體本身的反射率曲線兩者是很接近的（參見上圖中第一行的例子）。</p>
<p>白平衡（<a class=" wrap external" href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/Color_balance" target="_blank" rel="nofollow noreferrer">White Balance</a>）要做的，就是在不同的光線條件下，根據當時得到的物體顏色，儘量恢復物體的「固有色」，或者說，儘量減小光源顏色對物體顏色的影響。（在下一節會繼續討論這個定義的合理性，本小節中先按照這個定義進行討論）。</p>
<p>根據之前的專欄文章 <a class="internal" href="https://zhuanlan.zhihu.com/p/24281841">《色彩空間表示與轉換》</a> 中討論的結果，我們可以在色彩轉換的過程中根據光源的情況指定不同的白點，從而得到相應正確的色彩轉換結果。舉例來說，在晴天正午室外拍攝的一張照片，光源近似於標準白點 D65，那麼我們就用 D65 點作爲白點進行色彩轉換（實際上就是直接用 sRGB 空間進行展示）。又比如在黃昏的光線下拍攝了照片，此時光源接近 2500K 的黑體，那麼我們從普朗克曲線上找到 2500K 的點，作爲新的白點，進行色彩轉換，就能得到正確的顏色。由於色彩空間的線性性質，這個轉換過程就是一個矩陣乘法，非常方便。詳細的計算過程可以參見之前的文章，這裏不再贅述。</p>
<p>這就是相機上色溫調節的原理。也就是說，相機上的色溫選項，調節的是色彩轉換中的白點的位置，在普朗克曲線上選取與色溫相對應的點作爲白點進行色彩轉換，從而得到正確的顏色。這個色溫選項，是要與拍攝時的光源色溫相匹配的，這也是爲什麼在晴朗的白天拍攝，色溫控制在 5000K ~ 6000K 是比較合適的，而在黃昏時候拍攝，色溫需要設置成 2500K ~ 3000K 才比較合適。</p>
<p>我們可以看到，沿着普朗克線移動白點，總體上是調節了畫面偏藍或者偏黃的色彩傾向。當然，完整的白平衡要求白點可以任意設置，所以必須增加第二個移動方向。最合理的選擇就是與普朗克線正交的另一個方向，從色品圖上看大致是從左上角到右下側直線邊的方向，也就是綠色到品紅的方向。</p>
<img class="content-image" src="http://pic1.zhimg.com/v2-392c0561d35f056b10fb2ca5b0835fa4_b.png" alt="">
<p>（色溫和色調調節）</p>
<p>正因爲如此，我們可以看到，Photoshop、Lightroom 這樣的照片處理軟件，白平衡的面板上總是會有兩個調節滑塊，一個調節黃 - 藍平衡，通常叫色溫（Temperature），一個調節綠 - 品紅平衡，通常叫色調（Tint）。這兩個方向互相配合，才能使得白點位於色品圖中的任意位置，才能對任意光線條件下拍攝的照片進行白平衡的調節。</p>
<img class="content-image" src="http://pic4.zhimg.com/v2-f6e517ba429e6464a32786b4ba007513_b.png" alt="">
<p>（Photoshop 中的白平衡調節面板）</p>
<p><strong>3 色彩恆常性</strong></p>
<p>白平衡解決了「怎樣才能正確得到白色」的問題，在上一小節中，我提出白平衡的目的是「在不同的光線條件下，根據當時得到的物體顏色，儘量恢復物體的固有色」，這句話看似簡單，仔細想想，卻又並不那麼顯然。一個很明顯的疑問是：我們怎麼知道什麼是物體的固有色？白熾燈照明下的一張白紙，與陽光照明下的一張橙黃色的紙，兩者從物理上而言可以是幾乎一樣的，或者說兩者的光譜功率分佈函數，可以是幾乎一樣的。那麼我們憑什麼說一張是白紙，一張是橙黃色的紙呢？</p>
<p>答案是，不能區分。如果僅僅看這張紙的話，我們不能區分哪張是白紙，哪張是黃紙。</p>
<p>但是，我們不僅僅只看了紙，我們還看到了周圍的景物，也許是擺放紙張的書桌，也許是周圍的植物盆景，也許是旁邊的水果，甚至是我們自己的手。所有這一切，都幫助我們認識周圍的環境，根據環境去推測這張紙本來的顏色。</p>
<p>人類視覺過程不僅僅有視網膜的參與，更重要的還有大腦的參與。視覺是人類獲取外界信息最重要的手段，在日復一日的使用中，人類大腦對外界環境建立起了複雜的感知和對應。我們的大腦早就知道，植物葉子是綠色的，櫻桃是紅色的，我們的皮膚是黃色的&hellip;&hellip;通過對這些周圍環境的感知，我們的大腦推斷出了這個時候光源的情況&mdash;&mdash;是白熾燈還是陽光，從而自動完成了「白平衡」的過程，使得我們迅速感知到一個物體本來的顏色是什麼。這就是人類視覺的色彩恆常性。</p>
<img class="content-image" src="http://pic3.zhimg.com/v2-c36468c41ad038a5c30f02d43cc8bbb2_b.jpg" alt="">
<p>沒有紅色的草莓</p>
<p>上圖是一個很好的例子（圖片來自 <a class=" wrap external" href="http://link.zhihu.com/?target=http%3A//www.psy.ritsumei.ac.jp/%7Eakitaoka/colorconstancy6e.html" target="_blank" rel="nofollow noreferrer">Color constancy</a>），在這幅圖中，如果我們單獨一個一個像素點來看，沒有一個像素點是紅色的，所有的像素點都是綠色、青色、灰色，圖中選取的幾個像素點的 RGB 值也充分說明了這一點。但是當我們從整體來這張圖，立刻會產生「紅色草莓」、「黃色木桌」、「白色盤子」的印象。這就是我們大腦根據一些「先驗知識」進行自動白平衡的結果。</p>
<p>當然，在沒有一個強有力的先驗知識的情況下，人類也很容易給出錯誤的答案。君不見引起網絡大撕逼的「白金、藍黑」神奇衣服？在我看來，這些爭論都是沒什麼意義的，因爲圖片提供的場景信息太少，人類的大腦還不足以利用先驗知識，建立對當場光源的感知，只能憑藉自身的經驗進行推斷，而每個人自身經驗千差萬別，自然也沒辦法正確推斷衣服的顏色了。如果大家能在現場看一眼，或者圖片作者能上傳一段附帶周圍環境的視頻，我想大概就不會有人對這件衣服的顏色有疑問了。</p>
<img class="content-image" src="http://pic2.zhimg.com/v2-00bad61e603bc2a2b5394bcbd98df1c5_b.jpg" alt="">
<p>（白金？藍黑？）</p>
<p>當然，我們可以有意識地利用這種錯覺，造成一些有趣的結果。比如下圖中，綠色條紋和藍色條紋，其實是同一種顏色（圖片來自 <a class=" wrap external" href="http://link.zhihu.com/?target=http%3A//www.independent.co.uk/news/weird-news/forget-the-dress-theres-another-optical-illusion-blowing-our-minds-10076727.html" target="_blank" rel="nofollow noreferrer">independent</a>）。</p>
<img class="content-image" src="http://pic1.zhimg.com/v2-ea9e5b6a9f6369a7f653509bbefb4b9c_b.jpg" alt="">
<p>（綠色？藍色？）</p>
<p><strong>4 小結</strong></p>
<ol>
<li>色溫是根據黑體輻射進行定義的，橙黃色色溫低，藍色色溫高；</li>
<li>相機中的色溫設置，需要與當時光源的色溫相匹配；</li>
<li>白平衡的目的，是希望在不同光線條件下，都能正確得到物體的固有色；</li>
<li>白平衡本質上是調節兩個參數：色溫和色調，色溫調節藍 - 黃偏色，色調調節綠 - 品紅偏色。通過調節兩個參數，來設置白點的位置，從而得到正確的色彩轉換；</li>
<li>人類視覺具有色彩恆常性，是大腦對外界環境感知的反應。當外界環境信息不足時，無法建立正確的色彩恆常感知。</li>
</ol>



</div>
</div>
</div>





<div class="question">
<h2 class="question-title">如何理解和分析手機相機的白平衡？</h2>

<div class="answer">



<div class="content">
<p>這個問題出現在我時間線上有幾天了，全程圍觀了大家的一些爭論，覺得有很多爭論都是不必要的。如果大家對一些概念有了統一的認識，可以減少很多無謂的口舌之爭。我在我的專欄寫了一篇關於色溫、白平衡和色彩恆常性（<a href="https://zhuanlan.zhihu.com/p/27165715">色溫、白平衡與色彩恆常性 - 知乎專欄</a>）的文章，有助於幫助大家更好地釐清概念。全文轉發到這個問題下，充當一個回答吧。</p><p>以下是文章原文（自己的 專欄文章，就不加引用標記了）</p><br><p>有關色彩理論相關的文章，在這個專欄裏已經有三篇了（<a href="https://zhuanlan.zhihu.com/p/24214731">《色彩空間基礎》</a>、 <a href="https://zhuanlan.zhihu.com/p/24281841">《色彩空間表示與轉換》</a>、<a href="https://zhuanlan.zhihu.com/p/24312022">《光譜渲染的幾個例子》</a>） 在三篇文章中，我介紹了色彩空間的基礎知識，並利用這些知識將物理上的「顏色」與顯示器的 RGB 數值聯繫起來，得到了我稱之爲「光譜渲染」的技術。
</p><p>在這三篇文章之後我就沒有繼續寫關於色彩理論的文章了，一方面固然是覺得自己在理論積累方面還有所欠缺，不敢在知乎上班門弄斧，二來自己也沒有一個整體性的思路，零碎的知識點寫起來缺乏一個統一的脈絡。前兩天在知乎上刷出了一個問題 如何理解和分析手機相機的白平衡？，裏面提到了相機白平衡的話題，似乎討論的還挺激烈，不免又勾起了心裏想寫點東西的慾望。</p><p>我現在刷知乎，發現很多時候爭論的各方其實都不明白各自討論的問題「定義」是什麼，討論來討論去，也不過是雞同鴨講，最後不免互相撕逼。在這篇文章裏我從我自己理解的角度出發，梳理一下與白平衡相關的幾個概念，在明確了概念的基礎上，再對這個問題進行深入的探討。</p><h2><b>1 色溫</b></h2><p>色溫這個概念是從黑體輻射來的。根據日常的經驗我們可以知道，給一個鐵塊加熱，隨着溫度升高，鐵塊開始是暗紅色，逐漸變成亮紅色，如果能達到鍊鋼爐裏那樣的高溫，鐵融化成鐵水，發出耀眼的金黃色光芒。而天文學家也告訴我們，宇宙中的恆星可以看做一個個黑體，隨着恆星溫度的升高，恆星的顏色也是從紅色到黃色，非常高溫度的恆星甚至發出偏藍色的光。</p><p>在之前的文章 <a href="https://zhuanlan.zhihu.com/p/24312022">《光譜渲染的幾個例子》</a> 裏，我給出了一個簡單的例子，直接渲染了不同溫度下黑體輻射的顏色。下圖就是渲染出的不同溫度黑體的顏色。</p><br><img src="http://pic4.zhimg.com/70/v2-ae0b3bf51c241bdd3620d0eece24b07b_b.jpg" data-width="709" data-height="491"><p>（黑體輻射的顏色）</p><p>從這個例子裏可以看出，隨着溫度的升高，黑體的顏色從暗紅到亮紅，逐漸到金黃色，再慢慢到藍色。在下面這個色品圖上可以看得更清楚，隨着溫度升高，黑體顏色在色品圖上移動，形成一條曲線軌跡。這條軌跡從右下角的紅色區域出發，經過黃色區域，中間的白色區域，到達左側的藍色區域。這條軌跡就叫做 <a href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/Planckian_locus">普朗克軌跡</a>。下圖顯示了色品圖上的普朗克軌跡（來自維基百科 <a href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/Planckian_locus">普朗克軌跡</a>）
</p><img src="http://pic2.zhimg.com/70/v2-57a253d8d380357057c6d7ed157a98d9_b.jpg" data-width="600" data-height="675"><br><p>（普朗克軌跡）</p><p>我們日常生活中，最重要的光源就是太陽，太陽發出的光很接近黑體光譜。我們的太陽表面溫度約爲 5500K，這個溫度的黑體發出的光，基本就是白色。讀過本專欄之前文章的讀者朋友肯定能理解，這當然不是巧合。在色彩空間中我們需要定義一個白點，而常見的一些標準白點，就是以 5500K 左右的黑體輻射（也就是我們的太陽）爲基礎的。CIE 委員會規定的幾種標準白點中，D50、D55 和 D65 是常用的白點，參照了 5000K、5500K 和 6500K 的黑體輻射來定義，模擬了不同條件下（比如地平線方向的光照，上下午的室外，正午室外）的光照。色彩空間 <a href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/SRGB">sRGB</a> 所依賴的白點就是 D65。</p><p>對於色溫，通常有幾個誤解。第一個誤解是混淆了色溫和情感上的溫度傾向。我們必須理解，色溫是根據黑體輻射溫度來定義的，是物理上的溫度，而不是情感上的溫度。從我們的情感上來說，橙色紅色給人感覺溫暖，藍色給人感覺寒冷。但從色溫的定義來看，紅色橙色是溫度較低的黑體發出的顏色，而溫度高的黑體顏色反而是藍色。</p><p>第二個誤解是混淆了色溫針對的對象。狹義上來說，色溫是針對光源的。比如晴朗正午的室外，光源是太陽（以及部分藍天），這個時候的光源接近標準光源 D65，色溫接近 6500K；又比如說傍晚日落，經過大氣層的散射，陽光中的藍光大大減少，光線顏色偏黃，光源顏色也許接近 3500K 的黑體。</p><p>很多關於色溫方面的爭論都是從這兩個誤解而來，搞清楚討論對象的定義，很多爭論也就煙消雲散了。</p><h2><b>2 白平衡</b></h2><p>在本專欄之前的文章 <a href="https://zhuanlan.zhihu.com/p/24214731">《色彩空間基礎》</a> 中提到，物理世界裏是無所謂「顏色」這個概念的，一切都是 <a href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/Spectral_power_distribution">光譜功率分佈</a>，所謂的「顏色」，是人類視覺過程產生的一種感受。正是如此，我們纔有了「三原色」理論，我們纔可以用三種顏色的光來模擬世間萬物的顏色。</p><p>生活常識告訴我們，光源的顏色不同，照射到同一個物體上，會引起物體顏色的變化。從單純的物理的角度來看，這個事情再正常不過了。光源有光譜功率分佈，物體對不同波長的光線又有不同的反射率，那麼光源照射到物體上，再反射到眼睛裏的光，它的光譜功率分佈就和光源密切相關了。不同的光源，照射到同樣的物體上，物體反射光的光譜功率分佈就會不一樣。下圖展示了一個例子，物體的反射率是對藍色光更高，對紅色光更低。第一行的光源是一個接近白色的光源，照射到物體上之後，反射的光線就是藍色；而第二行的光源是一個黃色的光源，照射到物體上之後，反射的光線是偏棕紅色的。</p><br><img src="http://pic2.zhimg.com/70/v2-4fffd993107f75019f6db0d822cf6089_b.jpg" data-width="2500" data-height="1600"><p>（不同光源下物體有不同顏色）</p><p>這裏需要再強調一下，物理上沒有所謂的「顏色」的概念，只有「光譜功率分佈」、「反射率」這些概念。一個物體的反射率是固定不變的，但是這個物體的「顏色」在不同條件下是不一樣的。</p><p>我們可以用一個標準白點（比如 D65）作爲光源，照射到物體上。我們認爲這個時候物體表現出來的「顏色」就是物體「本來」的顏色，可以定義爲物體的「固有色」。很顯然，固有色的光譜功率分佈曲線與物體本身的反射率曲線兩者是很接近的（參見上圖中第一行的例子）。</p><p>白平衡（<a href="http://link.zhihu.com/?target=https%3A//www.wikiwand.com/en/Color_balance">White Balance</a>）要做的，就是在不同的光線條件下，根據當時得到的物體顏色，儘量恢復物體的「固有色」，或者說，儘量減小光源顏色對物體顏色的影響。（在下一節會繼續討論這個定義的合理性，本小節中先按照這個定義進行討論）。</p><p>根據之前的專欄文章 <a href="https://zhuanlan.zhihu.com/p/24281841">《色彩空間表示與轉換》</a> 中討論的結果，我們可以在色彩轉換的過程中根據光源的情況指定不同的白點，從而得到相應正確的色彩轉換結果。舉例來說，在晴天正午室外拍攝的一張照片，光源近似於標準白點 D65，那麼我們就用 D65 點作爲白點進行色彩轉換（實際上就是直接用 sRGB 空間進行展示）。又比如在黃昏的光線下拍攝了照片，此時光源接近 2500K 的黑體，那麼我們從普朗克曲線上找到 2500K 的點，作爲新的白點，進行色彩轉換，就能得到正確的顏色。由於色彩空間的線性性質，這個轉換過程就是一個矩陣乘法，非常方便。詳細的計算過程可以參見之前的文章，這裏不再贅述。</p><p>這就是相機上色溫調節的原理。也就是說，相機上的色溫選項，調節的是色彩轉換中的白點的位置，在普朗克曲線上選取與色溫相對應的點作爲白點進行色彩轉換，從而得到正確的顏色。這個色溫選項，是要與拍攝時的光源色溫相匹配的，這也是爲什麼在晴朗的白天拍攝，色溫控制在 5000K ~ 6000K 是比較合適的，而在黃昏時候拍攝，色溫需要設置成 2500K ~ 3000K 才比較合適。</p><p>我們可以看到，沿着普朗克線移動白點，總體上是調節了畫面偏藍或者偏黃的色彩傾向。當然，完整的白平衡要求白點可以任意設置，所以必須增加第二個移動方向。最合理的選擇就是與普朗克線正交的另一個方向，從色品圖上看大致是從左上角到右下側直線邊的方向，也就是綠色到品紅的方向。</p><br><img src="http://pic1.zhimg.com/70/v2-392c0561d35f056b10fb2ca5b0835fa4_b.jpg" data-width="600" data-height="675"><p>（色溫和色調調節）</p><p>正因爲如此，我們可以看到，Photoshop、Lightroom 這樣的照片處理軟件，白平衡的面板上總是會有兩個調節滑塊，一個調節黃-藍平衡，通常叫色溫（Temperature），一個調節綠-品紅平衡，通常叫色調（Tint）。這兩個方向互相配合，才能使得白點位於色品圖中的任意位置，才能對任意光線條件下拍攝的照片進行白平衡的調節。</p><br><img src="http://pic4.zhimg.com/70/v2-f6e517ba429e6464a32786b4ba007513_b.jpg" data-width="580" data-height="340"><p>（Photoshop 中的白平衡調節面板）</p><h2><b>3 色彩恆常性</b></h2><p>白平衡解決了「怎樣才能正確得到白色」的問題，在上一小節中，我提出白平衡的目的是「在不同的光線條件下，根據當時得到的物體顏色，儘量恢復物體的固有色」，這句話看似簡單，仔細想想，卻又並不那麼顯然。一個很明顯的疑問是：我們怎麼知道什麼是物體的固有色？白熾燈照明下的一張白紙，與陽光照明下的一張橙黃色的紙，兩者從物理上而言可以是幾乎一樣的，或者說兩者的光譜功率分佈函數，可以是幾乎一樣的。那麼我們憑什麼說一張是白紙，一張是橙黃色的紙呢？</p><p>答案是，不能區分。如果僅僅看這張紙的話，我們不能區分哪張是白紙，哪張是黃紙。</p><p>但是，我們不僅僅只看了紙，我們還看到了周圍的景物，也許是擺放紙張的書桌，也許是周圍的植物盆景，也許是旁邊的水果，甚至是我們自己的手。所有這一切，都幫助我們認識周圍的環境，根據環境去推測這張紙本來的顏色。</p><p>人類視覺過程不僅僅有視網膜的參與，更重要的還有大腦的參與。視覺是人類獲取外界信息最重要的手段，在日復一日的使用中，人類大腦對外界環境建立起了複雜的感知和對應。我們的大腦早就知道，植物葉子是綠色的，櫻桃是紅色的，我們的皮膚是黃色的……通過對這些周圍環境的感知，我們的大腦推斷出了這個時候光源的情況——是白熾燈還是陽光，從而自動完成了「白平衡」的過程，使得我們迅速感知到一個物體本來的顏色是什麼。這就是人類視覺的色彩恆常性。</p><br><img src="http://pic3.zhimg.com/70/v2-c36468c41ad038a5c30f02d43cc8bbb2_b.jpg" data-width="1257" data-height="1008"><p>（沒有紅色的草莓）</p><p>上圖是一個很好的例子（圖片來自 <a href="http://link.zhihu.com/?target=http%3A//www.psy.ritsumei.ac.jp/%7Eakitaoka/colorconstancy6e.html">Color constancy</a>），在這幅圖中，如果我們單獨一個一個像素點來看，沒有一個像素點是紅色的，所有的像素點都是綠色、青色、灰色，圖中選取的幾個像素點的 RGB 值也充分說明了這一點。但是當我們從整體來這張圖，立刻會產生「紅色草莓」、「黃色木桌」、「白色盤子」的印象。這就是我們大腦根據一些「先驗知識」進行自動白平衡的結果。</p><p>當然，在沒有一個強有力的先驗知識的情況下，人類也很容易給出錯誤的答案。君不見引起網絡大撕逼的「白金、藍黑」神奇衣服？在我看來，這些爭論都是沒什麼意義的，因爲圖片提供的場景信息太少，人類的大腦還不足以利用先驗知識，建立對當場光源的感知，只能憑藉自身的經驗進行推斷，而每個人自身經驗千差萬別，自然也沒辦法正確推斷衣服的顏色了。如果大家能在現場看一眼，或者圖片作者能上傳一段附帶周圍環境的視頻，我想大概就不會有人對這件衣服的顏色有疑問了。</p><br><img src="http://pic2.zhimg.com/70/v2-00bad61e603bc2a2b5394bcbd98df1c5_b.jpg" data-width="640" data-height="970"><p>（白金？藍黑？）</p><p>當然，我們可以有意識地利用這種錯覺，造成一些有趣的結果。比如下圖中，綠色條紋和藍色條紋，其實是同一種顏色（圖片來自 <a href="http://link.zhihu.com/?target=http%3A//www.independent.co.uk/news/weird-news/forget-the-dress-theres-another-optical-illusion-blowing-our-minds-10076727.html">independent</a>）。</p><br><img src="http://pic1.zhimg.com/70/v2-ea9e5b6a9f6369a7f653509bbefb4b9c_b.jpg" data-width="2048" data-height="1536"><p>（綠色？藍色？）</p><h2><b>4 小結</b></h2><ol><li>色溫是根據黑體輻射進行定義的，橙黃色色溫低，藍色色溫高；
</li><li>相機中的色溫設置，需要與當時光源的色溫相匹配；
</li><li>白平衡的目的，是希望在不同光線條件下，都能正確得到物體的固有色；
</li><li>白平衡本質上是調節兩個參數：色溫和色調，色溫調節藍-黃偏色，色調調節綠-品紅偏色。通過調節兩個參數，來設置白點的位置，從而得到正確的色彩轉換；
</li><li>人類視覺具有色彩恆常性，是大腦對外界環境感知的反應。當外界環境信息不足時，無法建立正確的色彩恆常感知。</li></ol>
</div>
</div>




</div>


</div>
</div>