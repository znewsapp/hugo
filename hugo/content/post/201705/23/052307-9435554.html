+++
date = "2017-05-23T07:00:00"
title = "AlphaGo 對圍棋的理解比人類高一個境界，不禁爲柯潔捏了把汗"
titleimage = "https://pic4.zhimg.com/v2-3824d1389aecc7ab6b7dbe98fff6778b.jpg"
ga = 052307
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



<div class="headline-background">
<a class="headline-background-link" href="http://www.cnbeta.com/articles/tech/614873.htm">
<div class="heading">相關新聞</div>
<div class="heading-content">「最強棋手」柯潔對戰 AlphaGo</div>
<i class="icon-arrow-right"></i>
</a>
</div>

</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">AlphaGo「理解」圍棋嗎？</h2>

<div class="answer">



<div class="content">
<p>還是先上結論。我認爲<strong>AlphaGo 理解圍棋，而且 AlphaGo 比人類對圍棋的理解高一個層次。</strong></p>
<p>這個問題下面, @SIY.Z 的答案對我很有啓發，推薦大家可以看看。</p>
<p>這位答主提到，</p>
<blockquote>你或許還是不能接受 AlphaGo 這個樣子，我想這是因爲，人們下圍棋，一定要先理解&ldquo;圍棋&rdquo;什麼東西，下面纔可以操作。但是 AlphaGo 卻是在不知道(或者沒有被提供數據)&ldquo;圍棋是一種 2 個人的，而且兩個人面對面做的，對抗的，零和的，棋盤 19*19 的，棋盤是方的，上面是打格子的，格子也是方的，有黑白兩個子的，黑子先下的，兩個輪流下的，要下在格點而不是格子中間的，有限時要求的，棋子數量足夠的，一個棋子不會佔超過一格的，棋子是圓的，兩邊凸起的，中國古代發明的，一種博弈遊戲&rdquo;中的任何一點的時候，可以戰勝人類。</blockquote>
<p>說得好。不過，AlphaGo 眼裏其實是有&ldquo;圍棋&rdquo;這個概念的。計算機圍棋界有基於中國規則的 Tromp-Taylor 規則（<a href="http://senseis.xmp.net/?TrompTaylorRules">Tromp-Taylor Rules</a>）。詳細的條文就不在這裏貼了，我簡單轉述一下。Tromp-Taylor 規則定義，圍棋是一個在 19*19 格點上進行，兩個玩家&ldquo;小黑&rdquo;、&ldquo;小白&rdquo;，輪流分別把棋盤上的某一個格點染成黑色或白色的遊戲。再加上提子和禁循環的規則，以及終局判斷，就是完整的 Tromp-Taylor 規則。請各位想一想，這樣的圍棋，和我們眼中的圍棋，有什麼本質區別嗎？如果不考慮圍棋文化，那麼我可以肯定地說，沒有區別。</p>
<p>既然對於 AlphaGo，&ldquo;圍棋&rdquo;這個概念本身，和人類理解的&ldquo;圍棋&rdquo;這個概念沒有區別，那我們就先聊聊我們人類，特別是職業棋手，是怎麼理解圍棋的。</p>
<p>這裏引用一段我去年寫的文章。</p>
<p>圍棋是世界上最複雜的遊戲之一。所謂&ldquo;一着不慎，滿盤皆輸&rdquo;，每一步棋都可能左右全局的結果。一般來說，一手棋的決策分兩步。第一步，&ldquo;選點&rdquo;：憑經驗或感覺給出幾個候選的點；第二步，&ldquo;判斷&rdquo;：分別對這幾個點做形式判斷，並進行比較。這兩步，說來容易，但要做到笑傲衆生的水平，對於天賦和勤勉的要求，不亞於一個優秀數學家所需要的。</p>
<p>從初學者成長爲大師，棋手需要先學會基本的佈局理論、掌握基本的死活、對殺常識，然後熟記數百個定式及掌握其主要分支（飛刀）、練習數萬死活題，同時在大量對局中磨練。有些外行據此認爲，圍棋只是複雜一點的&ldquo;體力勞動&rdquo;。對於這一觀點，下圖古力同學白 1 這一招抵得上千言萬語。</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-9d6670ed133b562a291745395219c8f3_b.jpg" alt="">
<p>圖中右上的形狀，在任何一本死活題的書中都不曾出現。實戰白棋這一招的位置，也屬於一般&ldquo;選點&rdquo;思路下的盲點。但小明同學在短時間內看到了這一招，一舉扭轉乾坤。</p>
<p><strong>&ldquo;體力勞動&rdquo;讓天賦平平者能夠成爲業餘高手，但山巔最美的風景只屬於天才</strong>。</p>
<p>我們再說&ldquo;判斷&rdquo;。判斷很難嗎？在中國象棋或者國際象棋中，形勢判斷對於程序來說並非難事：只需觀察雙方子力的差距就可以大致判斷出形式的好壞。當年戰勝卡斯帕羅夫的&ldquo;深藍&rdquo;，其形式判斷算法大致就是如此，非常簡潔。而圍棋的形勢判斷是個真正的難題。圍棋的勝負由終局時雙方控制地盤的多寡決定。然而棋局進行到一半，雙方的地盤都尚未封閉，怎麼判斷形勢呢？</p>
<p>職業棋手採用的算法是估算雙方的目數（地盤大小）差距。那如果地盤的邊界沒有完全確定怎麼辦呢？如果有先手官子就判給先手方，如果是雙方後手官子就算一人一半。如果有一些模糊的地方，比如說一塊厚勢折算成幾目呢？這時候就只能憑經驗感覺了。職業棋手之間微妙的水平差異，很多時候也體現在模糊判斷能力上。</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-6b1d95d2a141eb1f03b24ae0c4f5e443_b.jpg" alt="">
<p>對於如圖所示的中盤階段末期的局面，職業棋手一般能在一到兩分鐘內大致判斷出雙方地盤的差距，並據此決定接下來的策略是保守或是激進。這樣的判斷速度和準確度，和&ldquo;搜索&rdquo;能力的訓練一樣，背後也是數千盤對局積累下來的經驗。</p>
<p>---</p>
<p>小結一下，對於高手來說，除了十幾年日復一日訓練的積累以外，靈感和天賦也是必不可少的。在複雜局面下，棋手的選點需要靈光一現，而模糊判斷的準確性，離不開棋手的天賦。</p>
<p>這聽上去有點像藝術創作。確實，圍棋自古以來與琴、書、畫並稱君子四藝，現在我們仍然這麼提。但是，圍棋終究是一個遊戲。如果你對博弈論有所涉獵，大概會知道，圍棋是一種&ldquo;完全信息&rdquo;博弈。更懂行一點的讀者知道，根據<strong>策梅洛定理</strong>，像圍棋這樣的二人、完全信息、無運氣成分、有限回合、且不存在和棋的遊戲，對局的其中一方是有必勝策略的。（這裏有必要解釋一下&ldquo;有限回合&rdquo;和&ldquo;不存在和棋&rdquo;。圍棋的中國規則中，有&ldquo;禁循環&rdquo;一條，這就杜絕了棋局無限制進行下去的可能。另外，如果嚴格執行&ldquo;禁循環&rdquo;規則，三劫循環、長生等特殊棋型，相當於打一個普通的劫爭，不必判和棋。現實中將三劫循環判和，只是一種權宜之計，相信未來可能會改變。）</p>
<p>那麼，既然必勝策略一定存在，爲什麼圍棋手不去研究必勝策略，搞什麼選點、判斷？爲什麼圍棋手不能踏踏實實用邏輯推理解決戰鬥，是不是他們在故弄玄虛，或者說裝逼？</p>
<p>當然不是。</p>
<p><strong>因爲圍棋太難了。</strong></p>
<p>1950 年，&ldquo;信息論之父&rdquo;克勞德&middot;香農在論文&ldquo;Programming a Computer for Playing Chess&rdquo; 中給出了國際象棋複雜度的一個下限。香農寫道，一盤象棋一般有 40 個回合，平均每回合的變化總量大約在 10^3 這個數量級，那麼國際象棋的變化總數至少是 10^120 這個數量級。後人把 10^120 這個數稱作&ldquo;香農數(Shannon Number)&rdquo;。香農用此計算說明，利用純暴力搜索破解國際象棋是不現實的。</p>
<p>如果我們估計一下圍棋的香農數呢？19 路圍棋盤上，一盤棋大約是 120 個回合（240 手），平均每回合的變化數總量在 10^5 以上，這樣算下來，圍棋的變化總數不少於 10^600。可觀測宇宙的原子總量 10^80，相形之下，真是小巫見大巫。劉慈欣的小說《詩云》中寫道，就算把宇宙中的每一個原子都做成儲存器，而且技術先進到一個原子能儲存一比特信息，也只能存下很小一部分的棋局。</p>
<p>誠然，計算，或者說單純的邏輯推理，是圍棋技藝的基礎。不過，當計算量遠遠超出人腦的能力之時，減少計算量的技巧，選點、判斷，就必須出場了。經驗性的選點，讓棋手快速將有限的計算力集中到幾個重要分支上；而準確的判斷，能夠讓棋手在優勢局面下鳴金收兵，避免複雜計算，減小風險；或者在劣勢局面下放棄幻想，奮力一搏。當然，選點、判斷時的模糊性，在邏輯上難免不嚴謹，有一定風險，這就要求棋手權衡利弊，合理分配時間。</p>
<p>---</p>
<p>講了很多人類棋手的事，是時候讓 AlphaGo 出場了。事實上，擺在 AlphaGo 面前的最大問題，和人類棋手是一樣的：<strong>圍棋太難了，計算力不夠</strong>。&ldquo;深藍&rdquo;戰勝卡斯帕羅夫那一套，對國際象棋還行，套用到圍棋上根本不可能，畢竟圍棋的複雜度遠超國際象棋。想要戰勝人類，只能把有限的計算力用在刀刃上。怎麼辦？AlphaGo 團隊的做法是，<strong>像人類棋手一樣，去選點和判斷</strong>。</p>
<p>深度卷積神經網絡，是 AlphaGo 採用的一項先進技術。我們可以把神經網絡看成一個黑箱。</p>
<img class="content-image" src="http://pic3.zhimg.com/70/v2-c92f59f0c8ebbc8bf42f3fc682d589d2_b.jpg" alt="">
<p>如上圖。給定一個輸入，神經網絡經過一系列處理後輸出結果。具體到 AlphaGo 的架構，可以用下圖粗略地解釋。</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-9547cdb0398f486533062252c64bc8cf_b.jpg" alt="">
<p>請看上圖。人類棋手的思維方式，是根據輸入的局面，輸出候選招法和形勢判斷，綜合以後給出最終輸出。AlphaGo 的大框架與此非常相似。AlphaGo 的策略網絡，大致對應人類&ldquo;選點&rdquo;的決策；AlphaGo 的價值網絡，大致對應人類&ldquo;判斷&rdquo;的決策。</p>
<img class="content-image" src="http://pic2.zhimg.com/70/v2-a2a860b6937c35a21d09c5f4df79a409_b.jpg" alt="">
<p>在此基礎上，蒙特卡洛搜索樹算法將策略網絡和價值網絡串聯起來，形成完整的決策系統。</p>
<img class="content-image" src="http://pic3.zhimg.com/70/v2-0e017bc05d319041c3d92da0d75da592_b.jpg" alt="">
<p>AlphaGo 基於蒙特卡洛搜索樹的單次決策過程，附有我的詮釋。進行此循環多次以後，AlphaGo 選擇在過程中<strong>重複次數最多</strong>的分支爲最終落子點。</p>
<p>以上我對 AlphaGo 的解讀爲了方便大家理解，有不嚴謹之處。關於 AlphaGo 原理的深度解讀，推薦 @袁行遠 的答案<a href="https://www.zhihu.com/question/41176911/answer/90118097">DeepMind 研發的圍棋 AI AlphaGo 是如何下棋的？</a>。輕鬆一點的解讀，也可以看<a href="https://www.zhihu.com/question/58921302/answer/161850993">圍棋 AI（人工智能）的發展歷程是怎麼樣的？</a>，我和 @Haochen Liu 以及 @雲天外 一起做的 Live 的逐字稿。</p>
<p>前面的內容講到，AlphaGo 下棋時決策的方式和人類相似，因此可以說 AlphaGo&ldquo;理解&rdquo;圍棋。接下來進入我要論證的主題，<strong>AlphaGo 比人類更懂圍棋</strong>。</p>
<p>AlphaGo 以 4:1 戰勝李世乭，又化名 Master 在快棋中橫掃職業棋手，實力無疑超過所有人類棋手。然而，還有更恐怖的事情。棋手們在這一年多以來，一直在向 AlphaGo 學習。在具體招法上，也有了不少心得。<strong>但是，AlphaGo 的判斷力是人類永遠沒法學習或者模仿的。</strong>下面這一段，我將人類與 AlphaGo 的判斷能力做個簡單比較。</p>
<p>---</p>
<p>人類&ldquo;數地盤&rdquo;式的判斷常有失靈之時。除了模糊判斷可能帶來的誤差以外，對於某一塊地盤歸屬的錯判也是經常發生的。李世乭 -AlphaGo 五番棋第一局中，職業棋手們就在局中集體給我們演示了一次這樣的錯判。</p>
<img class="content-image" src="http://pic2.zhimg.com/70/v2-a35d70b0ef8f7ac7218742ed2212e441_b.jpg" alt="">
<p>這是棋局進行到第 101 手時的局面。李世乭在棋盤上落下的這一手確保了右上黑棋的安全。由於 AlphaGo 在左下步伐紊亂，黑棋收穫頗豐。沉浸在樂觀情緒中的職業棋手們一致判斷黑棋明顯優勢。直觀來看，此局面的判斷並不複雜：黑方下邊一塊確定的目數，基本可以和白方全局確定的目數 + 厚味抗衡；黑方額外多出右邊紅框裏的地盤，意味着黑棋盤面（即不計貼目）領先 15 目左右。然而，當時沒有人想到，右邊紅框範圍內看上去已經萬無一失屬於黑棋的地盤，即將被 AlphaGo 掏空。</p>
<p>敏銳如柯潔者，第一時間看到了白棋在 R10（圖中綠圈）打入的手段。不過，柯潔當時的說法是，這是落後一方孤注一擲的手法。局後回顧，才發現此處黑棋已無法全身而退，而 AlphaGo 對此早已成竹在胸。從 DeepMind 公佈的數據來看，AlphaGo 認爲此局面下白方的勝率超過 75%，這意味着 AlphaGo 對 R10 打入之後的變化充滿信心。棋局的走向證明了 AlphaGo 判斷的正確，而職業棋手的直覺在此處集體失靈。</p>
<p>---</p>
<p>AlphaGo 在複雜局面下的形勢判斷，比職業棋手的判斷更精準。</p>
<p>更重要的是，AlphaGo 基於概率的形勢判斷，比人類棋手比較地盤多寡的判斷，更接近圍棋的本質。學棋的時候，老師常說，贏半目和贏一百目沒有區別。圍棋十訣第一條就是&ldquo;不得貪勝&rdquo;。說明人類棋手都認同，保住勝利果實，比拿到更多地盤更重要（也許藤澤秀行棋聖是個例外）。然而，具體操作中，人類的形勢判斷算法並不能實現這一目標。</p>
<p>爲了幫助理解，我舉個例子。</p>
<p>在某一盤棋的後半盤，黑方確定目數 70 目，沒有潛力。白方確定目數 40 目，有一塊 40 目潛力的大空。如果黑方立即打入（選項 A）並活出（結局 A1），則 40 目的潛力只能轉化成 10 目的實地，黑方獲勝。如果黑方打入失敗（結局 A2），則白棋 40 目大空圍成，白方獲勝。黑棋也可以選擇保守的淺消（選項 B），則白方的 40 目潛力<strong>大約</strong>能轉換爲 25 目實地<strong>。</strong></p>
<p>這個局面下，如果選擇淺消（選項 B），雖然最後差距會縮小，然而其實勝機也很少。很遺憾，這種局面下，職業棋手很難準確估算打入成活的概率，然而 AlphaGo 可以。於是心存幻想的人類棋手覺得落後不多，而打入無成算，選擇淺消白棋大空，結果白方 40 目的潛力轉化成 25 目實地，黑棋盤面僅多 5 目，從而落敗。阿爾法狗估算出選擇打入（選項 A）的勝率是 40%，而選擇淺消勝率僅爲 25%，於是毅然選擇打入。不論最後勝負如何，選擇打入顯然是更好的策略。</p>
<p>換句話說，只&ldquo;領先兩目&rdquo;而勝率 80%，和&ldquo;領先五目&rdquo;而勝率 70%，其實是前者優勢更大，然而人類會認爲後者優勢更大。</p>
<p><strong>AlphaGo 有能力精確地估算勝率，人類棋手不能。因此我說，AlphaGo 對圍棋的理解，比人類高一個境界。</strong></p>
<p>我們可以進一步想象，假如有一天，人類造出了一臺能夠做無限快計算，且儲存能力無限大的機器。那麼這臺機器判斷一個圍棋局面，不會輸出勝率，而是會輸出&ldquo;此局面黑棋（白棋）必勝&rdquo;。這就又比 AlphaGo 對圍棋的理解高一個境界，是真正破解了圍棋。</p>
<p>不過，由於圍棋的複雜度，我不認爲這樣的機器能夠在一千年以內被髮明出來。<strong>換句話說，AlphaGo 的算法，是目前我們能做到的對圍棋問題的最好解決方案。</strong>此後的圍棋 AI，大概只需要在這個框架的基礎上修修補補了吧。</p>
<p>而人類也沒必要爲此感到悲哀。AlphaGo 是個好老師。雖然學不了她的判斷方法，但是具體招法可以借鑑。將來 AlphaGo 或者其他 AI 的形勢判斷，也可供參考。將來十年，圍棋技術一定會快速發展變化，我等棋迷有好戲可以看了。</p>
<p>相關文章：<a href="https://zhuanlan.zhihu.com/p/22520903">AlphaGo 與人類的恩怨情仇（一）：世紀難題 - 知乎專欄</a></p>
</div>
</div>




</div>





<div class="question">
<h2 class="question-title"></h2>

<div class="answer">

<div class="content">
<p>更多討論，查看 &middot;&nbsp;<a href="https://www.zhihu.com/roundtable/kejie-vs-alphago">人機對弈終章</a></p>
</div>
</div>


</div>


</div>
</div>