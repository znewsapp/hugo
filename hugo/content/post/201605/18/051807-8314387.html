+++
date = "2016-05-18T07:00:00"
title = "每天能賺幾千萬美元，Facebook 的首頁厲害在哪裏？"
titleimage = "http://pic4.zhimg.com/619e3529f6d6a7854fe882e1bd38ab3f.jpg"
ga = 051807
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">



<div class="question">
<h2 class="question-title">關於 Facebook NewsFeed，看這一篇就夠了！</h2>
<div class="answer">



<div class="content">
<p><strong><strong>NewsFeed 怎麼來的</strong></strong></p>
<p>2004 年，Facebook 問世，兩年後的 9 月份，NewsFeed 問世，同時問世的還有 MiniFeed（個人動態）。今年是 NewsFeed 上線十週年了，這 10 年裏，Facebook 是怎麼一步一步把 NewsFeed 打造成了日收入幾千萬美金的現金牛的？不管你對這充滿銅臭的問題感不感興趣，反正我很感興趣。</p>
<p>今天我們都已經習慣了把照片、文字等內容主動分享給好友，但是當時 Facebook 上線了這個功能時，引起了廣泛的爭議，焦點就是&ldquo;隱私&rdquo;問題，用戶認爲我發的動態怎麼能讓別人看見呢[1]？用戶一直不停質疑和抗議，又忍不住繼續使用，Facebook 就這樣在爭議聲中增加了最初的隱私控制，比如隱藏自己的動態，而 NewsFeed 就這樣堅持了下來。看來，小扎真是一個撩妹高手，看穿了用戶們&ldquo;嘴上說不要，身體卻誠實&rdquo;的內在。</p>
<p>隨着用戶們漸漸地愛上了瀏覽好友的分(xuan)享(yao)了，2009 年，Facebook 加上了贊(like)功能（FriendFeed 在 2007 年發明了贊按鈕，FriendFeed 後來於 2009 年被 Facebook 收購，並將贊這個功能整合進來），開始按照熱門程度對 Feed 重排序，不出意外，這又引起了用戶們的反抗，因爲大家已經習慣按照時間順序閱讀。</p>
<p>伴隨這麼多爭議，爲什麼 Facebook 一直堅持做興趣 feed？從數據上看，平均每個用戶每天待看的新鮮事有 1500 條之多，但平均每個用戶每天只能閱讀 300 條；從商業角度，將 Feed 排序交給上帝的做法，非常不利於商業化且有損用戶體驗，公共主頁可以使用很多伎倆吸引用戶關注，然後肆無忌憚發廣告。</p>
<p>10 年來，NewsFeed 有數不清的改進，甚至每天線上會同時部署很多算法版本進行 AB 測試。但 EdgeRank 是這條優化迭代之路上的一個標誌性建築。我們可以將 NewsFeed 排序策略按照 EdgeRank 分爲 PreEdgeRank 時代、InEdgeRank 時代、PostEdgeRank 時代。</p>
<p><strong><strong>EdgeRank 算法</strong></strong></p>
<p>EdgeRank，顧名思義，就是對邊（Edge）進行排序（Rank）[2]。</p>
<p>每一個朋友的每一個操作（Action）都可能以新鮮事（News）的方式呈現在用戶面前，比如朋友發佈了一條新鮮事，朋友讚了朋友的朋友一條新鮮事，朋友評論了朋友的朋友一條新鮮事，朋友給自己的照片加了一個標籤，等等。稍微用腳後跟想一想就知道，按照這樣羅列的話，每個用戶得看多少新鮮事？於是 FB 就想在一條動態呈現給一個用戶之前，先預估一下這個用戶對這條新鮮事感興趣程度。在 FB 的定義下，一個 Action 就是一個 Edge，所以這套量化興趣的算法就叫做 EdgeRank。</p>
<p>別看今天 Facebook 各種高大上，又是深度學習又是人工智能，要知道，在 EdgeRank 提出之前，FB 也是有過刀耕火種時代的，FB 的首席產品官 Chris Cox 談及早期 NewsFeed 是這樣說的[3]：</p>
<blockquote>&ldquo;In the beginning, News Feed ranking was turning knobs. Turn up photos a little bit, turn down platform stories a little bit.&rdquo;（最初，NewsFeed 排序就是在主觀拍腦袋，給照片加點權重，給平臺動態消息降點權重）<br><br>&ldquo;a photo might be worth 5 points, while joining a group was worth 1 point&rdquo; （把照片權重定爲 5，把加羣權重定爲 1）</blockquote>
<p>國內算法工程師們聽到這些，想必都要會心地笑了：原來 FB 也是從這個時代走過來的。但 Facebook 不同的是，這只是暫時的情形，他們已經走到更高級的階段了。</p>
<p>Serkan Piantino 在 2010 年左右領導並開發了第一版 EdgeRank 算法[4]。下面說說大名鼎鼎的 EdgeRank 是怎麼回事。</p>
<p>EdgeRank 主要有三個因素在起作用：</p>
<ul>
<li>親密度（Affinity Score）</li>
<li>邊的權重（Edge Weight）</li>
<li>新鮮程度（Time Decay）</li>
</ul>
<p>想象一條內容誕生後，途經什麼路徑流動到你的面前？</p>
<ol>
<li>首先經你的一個朋友（或者你的關注源）的之手產生了一條新鮮事（他發佈、贊、加標籤這些產生了新鮮事）；</li>
<li>然後經過你這個朋友（或者你的關注源）的介紹，到了你家門口，你一開門（登錄）就可能看見它；</li>
<li>內容不多時，開門一個一個寒暄可能還行，它們也等得起，也無所謂先來後到，內容太多時，就得考慮個先來後到了。</li>
</ol>
<p>這三個步驟，就大致刻畫了 EdgeRank 的思想了，其實還是很簡單直接的。</p>
<p>親密度對應了第二個步驟背後的思想，那麼多人介紹過來，我們當然要優先照顧更&ldquo;喜歡&rdquo;的人了，親密度的量化要考慮平常裏你和這個朋友&ldquo;走動&rdquo;是否頻繁，連接是否緊密。主要考慮下面幾點：</p>
<ol>
<li>你們連接的強度，點贊之交，還是評論之交，或是私信之交，連接方式不同，強度就不同；</li>
<li>你們連接的頻繁程度，一日百贊，還是百日一讚，差別也很大；</li>
<li>你們有多久沒有建立連接了，一年沒有了，關係自然就更淡了；</li>
<li>親密度是單向的，也就是說你對朋友的親密度，和朋友對你的親密度可能不一樣哦。</li>
</ol>
<p>你看，看似神祕的 EdgeRank 算法，其實跟大家不太待見的雞湯居然意思是一樣的，是不是覺得它竟然如此平易近人？</p>
<p>邊的權重也很直接，其實它反映了產生一條新鮮事的成本，成本越高的，權重越大。點贊、評論、發一條文字、發一張照片、發一個鏈接，背後用戶付出的成本不一樣，反應在邊的權重上也就不一樣。顯然，你點個讚的成本，和你發佈一條新鮮事的成本差別很多。</p>
<p>最後，新鮮程度，也是一個符合直覺的自然假設：NewsFeed 總是青睞 New 一些的 Feed，新的新鮮事總體上更可能得到用戶的臨幸。FB 用了一個類似指數衰減的函數來量化動態的新舊程度。</p>
<p>三個分數，最終用相乘的方式共同作用於每一條新鮮事的分數，用於排序和篩選。</p>
<p>這個排序方法的確是很簡單，基本上只考慮了社交方面的因素，而沒有考慮太多內容本身對用戶吸引力。</p>
<p>從公開的資料看 EdgeRank，並不是什麼高深的算法，它只是量化了三個主要因素，然後主觀地相乘，而沒有任何目標優化思想在背後，根據 Facebook 披露的消息看，早期的 EdgeRank 的確沒有引入機器學習，所以根本稱不上是智能的算法。</p>
<p>爲什麼 EdgeRank 這麼有名？因爲它是在 F8 開發者大會上公開介紹過的，經過一知半解的媒體渲染，變成了一個神祕高深的存在。</p>
<p><strong><strong>後 EdgeRank 時代</strong></strong></p>
<p>2011 年之後，Facebook 內部就不再提 EdgeRank 算法了，因爲用戶數和廣告主的飛增，導致 NewsFeed 的排序算法必須要更上一層樓。如今月活躍超過 10 億用戶，約 2000 萬的公共主頁，移動設備貢獻了大多數流量，複雜的上下文因素，必須引入機器學習才能 Hold 住整個場面。</p>
<p>在原來 EdgeRank 的基礎上，更加細緻地定義了不同層級的親密度。用深度神經網絡理解圖片內容和文字內容[5]，從而可以知道相片中的物體是不是用戶感興趣的，可以知道新鮮事的討論話題。隨着產品迭代，也加入了更多產品特徵，諸如閱讀時間長短、視頻內容、鏈接內容等，取關、隱藏一個源。前前後後一共考慮了 10 萬 + 的變量（模型的特徵空間應該會更高），如果還按照原來的方式去調節權重，顯然既不科學又很低效。</p>
<p>從 Facebook 的機器學習應用博客頁面可以看到，2010 年之後就開始逐漸有機器學習方面的文章出現了[5]。</p>
<p>相關資料顯示[6]，2011 年之後的 NewsFeed 排序算法，全面轉向了機器學習，用優化理論來決定每個因素的權重，將人從繁雜的策略量化中解放出來。</p>
<p>在被機器學習接管後的 NewsFeed，很多地方都更加細緻。</p>
<p>用機器學習預估新鮮事的質量[7]。通過構造了一份問卷調查，訪問了若干用戶來收集數據，用收集的數據構建了一個機器學習模型，用於 NewsFeed 排序時預測一條動態的質量，將預測的質量分數作爲最終排序的一個特徵。用樹模型構造離散特徵，結合最常見的 LR 模型預估廣告點擊率[8]。</p>
<p>除了全面轉向機器學習之外，NewsFeed 團隊也在重新思考人和算法的關係。他們要關心的是到底&ldquo;如何把用戶真正最關心的找出來&rdquo;，而不僅僅是&ldquo;提高點擊率&rdquo;。Facebook 一直是數據驅動的，也是他們能夠在爭議中把 NewsFeed 堅持下來的信念來源，而是不是唯數據馬首是瞻，團隊內部有很多思考，也有很多變化。</p>
<p>僅舉幾例：</p>
<ul>
<li>團隊發現有 85%的隱藏新鮮事操作來自 5%的人，經過與這些用戶溝通才發現，原來這 5%的人把&ldquo;隱藏&rdquo;當作郵件裏的&ldquo;標記已讀&rdquo;了，對喜不喜歡的新鮮事只要看過就會點擊隱藏。</li>
<li>對於悲傷的事情，用戶可能關心但不會點讚的。</li>
<li>對於有些點贊，用戶可能並不是真的感興趣，只是&ldquo;點贊狂魔&rdquo;發狂而已。</li>
<li>用戶閱讀一篇長帖子，讀到一半不讀了，也並不能說明他對這篇帖子不感興趣。</li>
</ul>
<p>這些 case，都讓他們開始關注到機器學習和數據的侷限[9]。</p>
<p>於是，在算法團隊之外，Facebook 搭建了一個遍佈全球的人肉評測小組。人肉評測小組不是簡單地對算法篩選結果進行喜歡 / 不喜歡的標註，而是會非常深入地闡述爲什麼喜歡 / 不喜歡算法篩選結果，而且會與工程師詳細交流評測結果，因爲這種人肉評測方式可以有效地拆穿數據說謊，讓產品遠離一味追求提高數據指標的怪圈。</p>
<p>除此之外，產品上還加強了過濾器功能（Filter）：你可以選擇你的動態給誰看，你可以選擇不看誰的動態（Hide），你也可以選擇優先看到誰的動態（See first），當然你可以取消關注一些人或者公共主頁，將這些控制權交給用戶，一方面安撫了用戶被算法接管的不安，另一方面也是一項重要的數據來源。事實上，如今的過濾器已經複雜到大多數用戶都不會使用這些控制權。</p>
<p>&ldquo;如何衡量用戶真的感興趣&rdquo;這個問題也許遠遠沒有最終答案，爲什麼？因爲人的非理性佔據了絕大多數時候，而&ldquo;不一致性&rdquo;又是非理性的最重要表現，根據心情不同，用戶有不同的感興趣的標準，而且這些標準也許還是相互矛盾的。</p>
<p><strong><strong>NewsFeed 的配套設施</strong></strong></p>
<p>NewsFeed 存在的前提是要依賴用戶建立大量的社交聯繫，這樣纔會出現信息過載，因此 NewsFeed 的一個重要的配套設施就是&ldquo;你可能感興趣的人&rdquo;（People you may like）推薦系統。</p>
<p>這是一個我們在產品形式上比較熟悉的推薦系統，它是一套大規模矩陣分解算法[10]，利用已有的協同矩陣爲你推薦你可能想建立聯繫的新 Item，包括用戶、app、公共主頁等。</p>
<p>NewsFeed 還有另一個配套設施，也是它爲什麼每天能吸金幾千萬刀的原因：廣告系統。Facebook 的廣告形態多樣[11]：</p>
<ul>
<li>Suggested Page (你可能喜歡的公衆頁)</li>
<li>Page Post (公衆號帖子推廣)</li>
<li>Suggested App (你可能喜歡的應用)</li>
<li>Video Ads (視頻廣告)</li>
</ul>
<p>現在，每一次 NewsFeed 調整算法都會引來廣告主們的抗議，他們都是在 FB 上擁有公共主頁的商業機構。</p>
<p>在以前，FB 鼓勵這些商業機構花錢投廣告增加粉絲，彼時的 NewsFeed 算法允許隨意發廣告（以原生的新鮮事形式）。而現在，FB 嚴格限制商業廣告和普通用戶的觸達。商業機構感覺自己被耍了，花錢買粉之後卻不能發原生廣告，無獨有偶，根據微博 CEO（@來去之間）在微博上的披露，現在微博企業號也是被限制博文達到粉絲 feed 次數的[12]。</p>
<p>據國外某專門做 NewsFeed 推廣的公司追蹤，1000 個公共主頁的 50000 條內容以原生方式觸達用戶的比例，從 2012 年 16%降低到了 2014 年的 6.51%，降了一倍還多，這當然也可能因爲用戶平均關注的公共主頁增多了[13]。</p>
<p>世界上最遙遠的距離，就是：手握大把粉絲，卻不能隨心所欲地曝光自己的產品。</p>
<p>當然，所有的公共主頁們，不要灰心，並不是沒有辦法，NewsFeed 的廣告系統大門永遠向你們敞開。</p>
<p><strong><strong>對 NewsFeed 的展望</strong></strong></p>
<p>具體 NewsFeed 會怎麼發展，無法預測，但是可以肯定的有三點：</p>
<ol>
<li>NewsFeed 的算法會一直進化下去。</li>
<li>NewsFeed 團隊把人和算法的關係處理得更好，從數據驅動（Data-Driven）到數據啓示（Data-Informed）。</li>
<li>越來越多的 Feed 型產品會效仿 NewsFeed，加入到興趣 feed 的潮流中去。</li>
</ol>
<p>本篇完。敬請期待下一篇《Pinterest 的 Smart Feed 架構與算法》。</p>
<p>[1] <a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Criticism_of_Facebook%23News_Feed_and_Mini-Feed" target="_blank" rel="nofollow noreferrer">Criticism of Facebook</a></p>
<p>[2] <a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//edgerank.net/" target="_blank" rel="nofollow noreferrer">EdgeRank</a></p>
<p>[3] <a class=" external" href="https://link.zhihu.com/?target=http%3A//marketingland.com/edgerank-is-dead-facebooks-news-feed-algorithm-now-has-close-to-100k-weight-factors-55908" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">marketingland.com/edger</span><span class="invisible">ank-is-dead-facebooks-news-feed-algorithm-now-has-close-to-100k-weight-factors-55908</span><span class="ellipsis"></span></a></p>
<p>[4] <a class=" external" href="https://link.zhihu.com/?target=https%3A//research.facebook.com/serkan-piantino" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">research.facebook.com/s</span><span class="invisible">erkan-piantino</span><span class="ellipsis"></span></a></p>
<p>[5] <a class=" external" href="https://link.zhihu.com/?target=https%3A//research.facebook.com/publications/machinelearning" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">research.facebook.com/p</span><span class="invisible">ublications/machinelearning</span><span class="ellipsis"></span></a></p>
<p>[6] <a class=" external" href="https://link.zhihu.com/?target=http%3A//www.dailydot.com/technology/facebook-news-feed-algorithm-edgerank/" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://www.</span><span class="visible">dailydot.com/technology</span><span class="invisible">/facebook-news-feed-algorithm-edgerank/</span><span class="ellipsis"></span></a></p>
<p>[7] <a class=" external" href="https://link.zhihu.com/?target=https%3A//www.facebook.com/business/news/News-Feed-FYI-Showing-More-High-Quality-Content" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://www.</span><span class="visible">facebook.com/business/n</span><span class="invisible">ews/News-Feed-FYI-Showing-More-High-Quality-Content</span><span class="ellipsis"></span></a></p>
<p>[8] <a class=" external" href="https://link.zhihu.com/?target=https%3A//pdfs.semanticscholar.org/daf9/ed5dc6c6bad5367d7fd8561527da30e9b8dd.pdf" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">pdfs.semanticscholar.org</span><span class="invisible">/daf9/ed5dc6c6bad5367d7fd8561527da30e9b8dd.pdf</span><span class="ellipsis"></span></a></p>
<p>[9] <a class=" external" href="https://link.zhihu.com/?target=http%3A//www.slate.com/articles/technology/cover_story/2016/01/how_facebook_s_news_feed_algorithm_works.html" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://www.</span><span class="visible">slate.com/articles/tech</span><span class="invisible">nology/cover_story/2016/01/how_facebook_s_news_feed_algorithm_works.html</span><span class="ellipsis"></span></a></p>
<p>[10] <a class=" external" href="https://link.zhihu.com/?target=https%3A//code.facebook.com/posts/861999383875667/recommending-items-to-more-than-a-billion-people/" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">code.facebook.com/posts</span><span class="invisible">/861999383875667/recommending-items-to-more-than-a-billion-people/</span><span class="ellipsis"></span></a></p>
<p>[11] <a class="internal" href="http://zhihu.com/question/20553088/answer/78721851">爲 Facebook 每天帶來 4000 萬美元收入的 News Feed 到底是一種什麼樣的廣告形式？ - 連喬的回答</a></p>
<p>[12] <a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//weibo.com/1111681197/D0qNcDlcc" target="_blank" rel="nofollow noreferrer">之前信息流算法爲了提升體驗，跟 FB 類似，對... 來自來去之間</a></p>
<p>[13] <a class=" external" href="https://link.zhihu.com/?target=http%3A//techcrunch.com/2014/04/03/the-filtered-feed-problem/" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">techcrunch.com/2014/04/</span><span class="invisible">03/the-filtered-feed-problem/</span></a></p>
<p>---</p>
<p>作者簡介：陳開江@刑無刀</p>
<ol>
<li>2013 年之前在新浪微博搜索部和商業產品部任資深算法工程師，先後負責過微博反垃圾、基礎數據挖掘、智能客服平臺、個性化推薦等產品的後端算法。</li>
<li>2012-2013 領導翻譯了《機器學習：實用案例解析》一書。</li>
<li>2013 年末加入傳統媒體公司車語傳媒，任算法主管，負責從零打造公司轉型產品考拉 FM 的個性化推薦系統，如今個性化推薦已成爲考拉 FM 與其他 FM 之間最大差異化特性。</li>
<li>2015 年初，離職創業，公司拿到 IDG 和晨興資本的天使投資，產品幾經調整，如今專注在用視頻分享購物經驗，App 名稱：邊逛邊聊。</li>
</ol><hr>
<p>微信公衆號【<strong>ResysChina</strong>】，中國最專業的個性化推薦技術社區。</p>



</div>
</div>
</div>


</div>
</div>