+++
date = "2017-03-03T12:00:00"
title = "大誤 · 已知我交往過所有血型的女孩"
titleimage = "http://pic3.zhimg.com/d79e845e7801fd4cdeeb31b9c243f00e.jpg"
ga = 030312
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">如果一個男生說，他集齊了 4 個血型的前女友，我們應該如何估計他前女友的數量？</h2>

<div class="answer">



<div class="content">
<p>有一些重要的前提沒有討論清楚，比如說男人找女友的標準是否跟血型有關，如果是故意去集齊的，那四個就夠了；即使不是故意，如果找女友上有血型的偏好，也會影響四種血型的分佈。</p>
<p>如果找女友過程跟血型完全獨立，可以這麼估計：</p>
<p>當有 N 個女友時，完全集齊的概率用容斥原理計算爲：</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=1+-+0.9%5EN+-+0.7%5EN+%2A+3+%2B+0.6%5EN+%2A+3+%2B+0.4%5EN+%2A+3+-+0.3%5EN+%2A+3+-+0.1%5EN" alt="">
<p>N = 4 時概率爲 0.0648，N = 5 時概率爲 0.162，N = 9 時概率爲 0.5225，N = 29 時概率爲 0.9528，因此 9 個女朋友時大約有一半概率集齊，29 個女朋友時幾乎一定集齊了。因爲可以拿來炫耀，其實可能是運氣很好的情況，所以甚至 N = 5, N = 6 也有不小的可能性了。</p>
<p>這種使用概率值進行估計的方法叫做置信區間法。</p>
<p>另一個角度，如果男人是在 N - 1 個女朋友時沒有集齊，N 個女朋友時恰好集齊了，這件事發生的概率是：</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=3+%2A+%280.7+%5E+%7BN+-+1%7D+-+0.6+%5E+%7BN+-+1%7D+-+2+%2A+0.4+%5E+%7BN+-+1%7D+%2B+2+%2A+0.3+%5E+%7BN+-+1%7D+%2B+0.1+%5E+%7BN+-+1%7D%29+%2A+0.3%0A%2B+%280.9+%5E%7BN+-+1%7D+-+3+%2A+0.6+%5E+%7BN+-+1%7D+%2B+3+%2A+0.3+%5E+%7BN+-+1%7D%29+%2A+0.1" alt="">
<p>注意這個公式只在 N &gt; 1 時成立，N = 1 時不成立。</p>
<p>可以根據這個概率值算出 N 的期望，巧合的是</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Calpha+%5Csum_%7Bn%3D1%7D%5E%7B%2B%5Cinfty+%7D%7Bn+%5Calpha++%5E+%7Bn-1%7D%7D%0A%3D+%5Csum_%7Bn%3D1%7D%5E%7B%2B%5Cinfty+%7D%7Bn+%5Calpha++%5E+n%7D%0A%3D+%5Csum_%7Bn%3D0%7D%5E%7B%2B%5Cinfty+%7D%7Bn+%5Calpha++%5E+n%7D%0A%3D+%5Csum_%7Bn%3D1%7D%5E%7B%2B%5Cinfty+%7D%7B%28n-1%29+%5Calpha++%5E+%7Bn-1%7D%7D%0A%3D+%5Csum_%7Bn%3D1%7D%5E%7B%2B%5Cinfty+%7D%7Bn+%5Calpha++%5E+%7Bn-1%7D%7D+-+%5Csum_%7Bn%3D1%7D%5E%7B%2B%5Cinfty+%7D%7B%5Calpha++%5E+%7Bn-1%7D%7D%0A%3D+%5Csum_%7Bn%3D1%7D%5E%7B%2B%5Cinfty+%7D%7Bn+%5Calpha++%5E+%7Bn-1%7D%7D+-+%5Cfrac%7B1%7D%7B1+-+%5Calpha%7D+" alt="">
<p>因此</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Csum_%7Bn%3D1%7D%5E%7B%2B%5Cinfty+%7D%7Bn+%5Calpha++%5E+%7Bn-1%7D%7D+%3D+%5Cfrac%7B1%7D%7B%281-%5Calpha%29%5E2%7D" alt="">
<p>（順帶一提這個公式的另一個簡單證明方法是 1/(1-&alpha;)兩邊同時對&alpha;求導）</p>
<p>因此</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Csum_%7BN%3D2%7D%5E%7B%2B%5Cinfty+%7D%7BN+%2A+%283+%2A+%280.7+%5E+%7BN+-+1%7D+-+0.6+%5E+%7BN+-+1%7D+-+2+%2A+0.4+%5E+%7BN+-+1%7D+%2B+2+%2A+0.3+%5E+%7BN+-+1%7D+%2B+0.1+%5E+%7BN+-+1%7D%29+%2A+0.3%0A%2B+%280.9+%5E%7BN+-+1%7D+-+3+%2A+0.6+%5E+%7BN+-+1%7D+%2B+3+%2A+0.3+%5E+%7BN+-+1%7D%29+%2A+0.1%29%7D" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=%3D+3+%2A+%281+%2F+0.3%5E2+-+1+%2F+0.4%5E2+-+2+%2A+1%2F0.6%5E2+%2B+2+%2A+1%2F0.7%5E2+%2B+1+%2F+0.9%5E2%29+%2A+0.3%0A%2B+%281%2F0.1%5E2+-+3%2F0.4%5E2+%2B+3+%2F+0.7%5E2%29+%2A+0.1+-+1%0A%3D+1499%2F126+%3D+11.897" alt="">
<p>也就是 N 的期望是 11.897</p>
<p>雖然 N 的期望接近 12，但是我們同時可以算出 N 在各個取值時的概率：</p>
<p>4 0.0648</p>
<p>5 0.0972</p>
<p>6 0.10368</p>
<p>7 0.0972</p>
<p>8 0.08586648</p>
<p>9 0.07373268</p>
<p>10 0.062536536</p>
<p>11 0.052858332</p>
<p>12 0.044751658248</p>
<p>13 0.038058890364</p>
<p>14 0.0325596411504</p>
<p>15 0.0280356987456</p>
<p>16 0.0242957939843</p>
<p>17 0.0211818683966</p>
<p>18 0.0185674298865</p>
<p>19 0.0163530409383</p>
<p>可以看到雖然期望值是 12 左右，但概率最大（最概然）的 N 取值爲 N = 6，大約爲 10%。</p>
<p>這兩種方法都給出了同一個模型下的不同估計值，前一種叫做最小二乘估計（或者最小均方誤差估計，MMSE），後一種叫做最大似然估計（MLE），各有各的應用。</p>
<p>我們的最後一種方法叫做貝葉斯估計，假如我們對這個男人的女朋友數量的分佈有一個先驗概率的估計，可以用加入這個先驗概率估計來計算後驗概率估計。比如說這個男人今年 25 歲，從 20 歲開始找女朋友，平均半年可以找到一個女朋友，那麼找到女朋友的數量可以描述爲一個泊松分佈：</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=p%28N%29+%3D+%5Cfrac%7B%5Clambda+%5EN%7D%7BN%21%7Dexp%28-%5Clambda%29" alt="">
<p>其中</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Clambda+%3D+10" alt="">
<p>根據貝葉斯公式有</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=p%28N%7CA%29+%3D+%5Cfrac%7Bp%28A%7CN%29p%28N%29%7D%7B%5Csum%7Bp%28A%7CN%29p%28N%29%7D%7D" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=p%28A%7CN%29" alt="">
<p>可以根據前面的假設代入任意一個公式，由於我們有：</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Csum%7B%5Calpha%5EN%7D+p%28N%29+%3D+%5Cfrac%7Bexp%28-%5Clambda%29%7D%7Bexp%28-%5Calpha%5Clambda%29%7D+%3D+exp%28-%5Clambda%281-%5Calpha%29%29" alt="">
<p>如果</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=p%28A%7CN%29" alt="">
<p>取前一式，有</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Csum%7Bp%28A%7CN%29p%28N%29%7D+%3D+1+-+exp%28-10+%2A+0.1%29+-+exp%28-10+%2A+0.3%29+%2A+3+%2B+exp%28-10+%2A+0.4%29+%2A+3+%2B+exp%28-10+%2A+0.6%29+%2A+3+-+exp%28-10+%2A+0.7%29+%2A+3+-+exp%28-10+%2A+0.9%29+%3D+0.54228" alt="">
<p>爲簡短起見，直接用程序計算出貝葉斯意義下相應的概率值和期望：</p>
<p>4 0.00226043788653</p>
<p>5 0.0067813136596</p>
<p>6 0.0120556687282</p>
<p>7 0.0161459849038</p>
<p>8 0.01782920383</p>
<p>9 0.0170108415952</p>
<p>10 0.0144277830103</p>
<p>11 0.0110862980436</p>
<p>12 0.00782169689103</p>
<p>13 0.00511687277832</p>
<p>14 0.00312679976968</p>
<p>15 0.0017949013622</p>
<p>16 0.00097216574915</p>
<p>17 0.000498568187695</p>
<p>18 0.000242794914535</p>
<p>19 0.000112546687265</p>
<p>期望值：11.054，MLE：8</p>
<p>同樣當</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=p%28A%7CN%29" alt="">
<p>取第二式時，算出相應的結果：</p>
<p>4 0.0192593457104</p>
<p>5 0.0577780371312</p>
<p>6 0.102716510455</p>
<p>7 0.137566755074</p>
<p>8 0.151908089291</p>
<p>9 0.144935492835</p>
<p>10 0.122927359555</p>
<p>11 0.0944572942891</p>
<p>12 0.0666422932316</p>
<p>13 0.0435966953044</p>
<p>14 0.0266409079808</p>
<p>15 0.0152928890711</p>
<p>16 0.0082830306297</p>
<p>17 0.00424789247439</p>
<p>18 0.00206865723832</p>
<p>19 0.000958918434124</p>
<p>20 0.000423993151789</p>
<p>期望值：8.977，MLE：8</p>
<p>期望值的差別是因爲模型假設，後者假設男人永遠在第一次集齊的時候就炫耀，而前者沒有這個假設，男人可以在幾個女朋友之前就已經集齊了，所以女朋友數量的期望值比較大。</p>
<p>貝葉斯估計的結果與先驗概率假設密切相關。如果我們將先驗概率假設改爲平均一年找到一個女朋友，也就是</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Clambda+%3D+5" alt="">
<p>，則可以算出後一個模型相應的期望值爲 5.965，MLE 爲 5，期望值明顯變小了。這是因爲我們對男人能找到的女朋友數量的預期發生了變化。</p>
<p>不喜歡數學的分割線</p>
<p>我們分別使用了置信區間、最大似然（MLE）、最小均方誤差（MMSE）、貝葉斯估計四種方法進行了估計，大致得到的結論是：8-12 之間。</p>
<p>（剛發現這兩個概率分佈是累積分佈函數和概率密度的關係&hellip;&hellip;）</p>
</div>
</div>




</div>


</div>
</div>