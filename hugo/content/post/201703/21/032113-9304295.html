+++
date = "2017-03-21T13:00:00"
title = "知道了這個方法，兩個人不需要裁判就能玩暗軍棋"
titleimage = "https://pic4.zhimg.com/v2-a02e66fb8f6e39d445b204a00e02b8b3.jpg"
ga = 032113
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">



<div class="question">
<h2 class="question-title">用密碼學玩暗軍棋 -- 閒聊多方計算</h2>
<div class="answer">



<div class="content">
<p><strong>暗軍棋</strong></p>
<p>我們先來回顧一下兒時玩的軍棋遊戲，然後探討一下如何使用密碼學來代替裁判。軍棋遊戲的目標是通過在棋盤上移動自己的部隊攻佔對方的軍旗。 當兩方的棋子碰撞時，採取如下規則</p>
<ol>
<li>司令 &gt; 軍長 &gt; 師長 &gt; 旅長 &gt; 團長 &gt; 營長 &gt; 連長 &gt; 排長 &gt; 工兵</li>
<li>炸彈與任何非軍旗棋子相遇時，雙方都消失</li>
<li>工兵 &gt; 地雷</li>
<li>地雷 &gt; 除炸彈和工兵以外的任何子力</li>
<li>任何棋子 &gt; 對方的軍旗 (遊戲結束，一方勝利）。</li>
</ol>
<p>軍棋有 明 與 暗 兩種下法。在明軍棋中，雙方的棋子正面朝上放置。暗軍棋是一種更刺激的玩法，雙方把棋子扣過來背面朝上，用來隱藏自己的佈陣和行動。但是暗軍棋的特點是需要一個裁判：當兩枚棋子碰撞的時候，裁判觀看棋子的正面，然後執行上述的吃子規則。那麼問題來了：如果沒有裁判，兩個人還可以玩暗軍棋嗎？</p>
<p>YES! 用密碼學不僅能實現暗軍棋，還可以不依賴公正的第三方（裁判 / 法官 / 拍賣行） 來進行任何博弈（古董拍賣，德州撲克，狼人殺等等&hellip;）不過實現的方法稍微有一點複雜，所以我們先來講簡單的情形～首先，兩枚軍棋的碰撞可以抽象成一個比較函數:</p>
<img class="content-image" src="http://zhihu.com/equation?tex=f%28x%2C+y+%29+%3D+1+%5Cmbox%7B+if+%7D+x+%3E+y%2C+-1+%5Cmbox%7B+if+%7D+x+%3Cy%2C+0+%5Cmbox%7B+if+%7D+x+%3D+y" alt="">
<p>假設我的軍長是 10 級，對方的連長是 3 級，那麼因爲 10 &gt; 3, 所以比較的結果是 1 ，我的軍長吃掉對方的連長。問題是，我擁有數字 10，對方擁有數字 3， 我們怎麼能在不透露具體軍階的情況下，比較這兩個數的大小呢？這裏我們就要隆重介紹 --- 姚期智院士的百萬富翁問題！</p>
<p><strong>百萬富翁問題</strong></p>
<p>在文章[1]中，姚老師提出瞭如下問題：</p>
<blockquote>兩個富翁的財產是 1 到 10 之間的整數。他們如何在不透露自己財產的情況下，比較誰更富有？</blockquote>
<p>很容易看出，百萬富翁問題和暗軍棋比較軍銜問題是等價的：無非是比較大小。我們下面來介紹姚老師的精妙解法 ---</p>
<img class="content-image" src="http://zhihu.com/equation?tex=i" alt="">
<img class="content-image" src="http://zhihu.com/equation?tex=x" alt="">
<img class="content-image" src="http://zhihu.com/equation?tex=c+%3D+K+-+j" alt="">
<img class="content-image" src="http://zhihu.com/equation?tex=d_j+%3D+x+%5Cmod%7Bp%7D" alt="">
<p>最後，王對這一串數字作如下操作：前面 i 個數不動，後面的數字每個加一，然後發回給李。</p>
<img class="content-image" src="http://zhihu.com/equation?tex=+x+%5Cmod%7Bp%7D" alt="">
<p>這個過程的絕妙之處在於：在協議完成之後，王不知道 j 的具體值，而李也不知道 i 的值， 但是雙方都知道誰的財富更多，這就是<strong>安全多方計算</strong>。一般來說，在甲只知道 x，乙只知道 y 的情況下，雙方可以合作計算一個函數 f(x,y)。協議完成時，只有函數值是公開的，而彼此都不知道對方的輸入值。</p>
<p><strong>回到暗軍棋</strong></p>
<p>在解決了百萬富翁問題之後，暗軍棋的玩法就很簡單了。 在每次兩枚棋子碰撞的時候，只需要對弈兩方進行一次上述的比較計算就可以了。有細心的同學要問了：且慢，這種玩法下難道不可以作弊嗎？比如我的棋子只是 2 級，但我可以在比較的時候輸入一個 10 級，而對方是無法發現的，因爲計算結果只會表明我的棋子比他大？確實如此，注意到上面的協議是無法確保輸入的數字和棋子的軍階是一致的。但是解決的方法也很簡單，如在遊戲結束之後，雙方都翻開自己的所有棋子，再對照遊戲記錄進行明軍棋的覆盤，就可以找出有沒有人作弊了～</p>
<p><strong>安全多方計算(secure multiparty computation)</strong></p>
<p>安全多方計算，可以說是密碼學中的又一項黑科技。它可以看作是上面比較函數的一個推廣，是可以實現<strong>任意數量</strong>的參與者共同計算<strong>任意函數</strong>的！它的應用就非常廣泛了，所有需要公正裁判的場景，都可以用這個協議來代替裁判～</p>
<p>兩個經典的應用：</p>
<p>拍賣 -- 對應的函數是取所有輸入的最大值。利用安全多方計算，在拍賣結束後每個人的出價都還保持隱私。</p>
<p>選舉 -- 對應的函數是對所有輸入求和（假設 1 代表選舉人 A , 0 代表選舉人 B)。在這裏，安全多方計算可以確保 每個人的投票是保密的，而且計票完全公正。</p>
<p>兩個新穎的應用：</p>
<p>共同好友 -- 兩個初次見面的人希望找到彼此的共同好友，而不向對方透露自己所有的好友。這裏雙方的輸入是兩個集合，對應的函數是取交集。</p>
<p>合作機器學習 -- 對應的函數是一個訓練算法，而輸入是每人各自的 data set。這個應用是近年來興起的。如果使用得當，可以打破數據的隱私壁壘。</p>
<p>那麼這麼強大的協議是怎麼實現的呢？這就得介紹到姚老師的神作<strong>亂碼電路</strong> 了。今天先到這裏吧～</p>
<p>附加思考題：在上面的百萬富翁問題的解法，有一步是取十個明文除以素數 p 的餘數。這一步可以省略嗎？</p>
<p><strong>參考文獻</strong></p>
<p>[1] Yao, Andrew C. "Protocols for secure computations." <em>Foundations of Computer Science, 1982. SFCS'08. 23rd Annual Symposium on</em>. IEEE, 1982.</p>



</div>
</div>
</div>


</div>
</div>