+++
date = "2017-02-09T15:00:00"
title = "想想哄搶蘋果，懂了爲什麼網址裏的「HTTPS」很重要"
titleimage = "http://pic1.zhimg.com/b8da0fb5a7ce75d788ed0749cd393870.jpg"
ga = 020915
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">全面普及 HTTPS 有意義嗎？</h2>

<div class="answer">



<div class="content">
<p>記得小時候，敞篷卡車從果園拉着一車車的蘋果，運到碼頭上，然後再裝載到萬噸貨輪上運往上海。但運往碼頭的最後一公里，道路坑坑窪窪，卡車會放慢速度，這時就會有一些青少年爬上貨車，從袋子裏拿蘋果吃，每次都會有一袋或幾袋被開包，爲此運輸公司非常苦惱。</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-bdcc695fa8166f92b9f7d336f16224b4_b.jpg" alt="">
<p>後來爲了減少損失，運輸公司使用了封閉的集裝箱，裝載好蘋果再將車廂鎖起來，到達目的地再打開，這樣即使有人想從車廂裏拿蘋果，也無從下手。</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-a6af0fbf06aa21fdaec7869dba0adff0_b.jpg" alt="">
<p>以上敞篷卡車所對應的就是&nbsp;<strong>TCP</strong>，蘋果對應的是&nbsp;<strong>HTTP</strong>，由於敞篷卡車無法保證在傳輸路途上，蘋果是否被竊取、調包、所以最終有多少貨物到達目的地，那完全要看壞小子的心情，如果壞小子只是插入一些廣告，用戶的瀏覽器最多彈出一些廣告頁面。</p>
<p>更甚一步，竊取用戶 cookie，登錄用戶賬戶做非法的勾當。還可以通過明文 http 植入木馬，可以遠程控制用戶電腦，竊取用戶敏感信息。</p>
<p>集裝箱代表<strong>TCP + TLS（Transport Layer Security）</strong>，從果園運輸的十噸蘋果能夠原封不動地到達目的地，既不會多也不會少。</p>
<p><strong>明文 HTTP 讓壞人有機可乘</strong></p>
<p>爲了實現網絡的高度安全，需要很多環節協同工作，只要有一個環節有漏洞，就有可能被利用，而爲了提高網絡的相對安全性，最高優先級就應該從 HTTP 下手，因爲這個用戶使用的最頻繁。</p>
<p>目前幾乎所有的個人電腦都處於路由器 NAT 保護之下，如果用戶不主動訪問 Internet，別人無從對 NAT 後個人電腦下手。</p>
<p>一旦用戶主動訪問 Internet，就相當於在 NAT 城門上啄了一個小洞，這個小洞就是一個 NAT 映射表，如果沒有流量刷新，300 秒之後小洞就會關閉。</p>
<p>在<strong>小洞存活的 300 秒以內，允許外部主機來訪問個人電腦，而明文的 HTTP 就是最好的載體。</strong>一旦個人電腦被植入了木馬，木馬程序就會主動週期性發消息給 Internet 的控制終端，這樣 NAT 小洞會一直敞開大門，給遠程控制提供了便利。</p>
<p><strong>HTTPS 提供了端到端的安全加密</strong></p>
<p>不僅提供<strong>數據機密性（加密）</strong>，還提供<strong>數據完整性（不篡改數據）保護</strong>、<strong>防重放（把捕獲的報文再發一次無效）</strong>，這樣壞小子就很難下手，沒有 session key 很難去偷窺並篡改用戶的數據，更無法依賴 HTTPS 這個載體植入木馬。</p>
<p>一定有同學會有疑問，爲何明文傳輸的 HTTP 可以被劫持，篡改網頁內容，而加密傳輸的 HTTPS 卻不可以？</p>
<p>那是因爲 HTTP 被劫持篡改頁面，重新計算 TCP checksum，用戶電腦是無法判別是否被篡改，只好被動接收。</p>
<p>而加密傳輸之後，有了 HMAC 保護，任何篡改頁面的嘗試，由於沒有 session key，無法計算出和篡改網頁一致的 HMAC，所以<strong>數據接收端的 SSL/TLS 會輕易地識別出網頁已被篡改，然後丟棄</strong>，既然無法劫持，也就沒有篡改的衝動了，所以 HTTPS 可以很好地對付網頁劫持。</p>
<p><strong>HTTPS 並不是 100%絕對可靠</strong></p>
<p>斯諾登暴露出，針對 IPsec，TLS 的密鑰交換所依賴的 Diffie-Hellman 算法攻擊，即通過離線的超級計算機預先計算出海量的公鑰、私鑰對，一旦嘗試出私鑰就會得到 Master Key，進而推導出 session key，這樣歷史數據、現在、將來的數據全可以解密。</p>
<p>以上是被動攻擊方式，針對數字證書欺騙則屬於主動攻擊，可以實時地解密用戶數據。但種種主、被動攻擊難度都很高，往往是以國家意志爲源動力，而不是一些小團體所能完成的。</p>
<p>有讀者肯定會心生疑惑，既然 HTTPS 不是絕對可靠，那依靠 HTTPS 工作的網銀安全嗎？安全，請放心使用，因爲銀行這個場子是國家開的，自然不會自己砸自己的場子。</p>
<p>電腦網銀用戶一般都有一個 USB Token，裏面有<strong>用戶數字證書私鑰（Private Key）</strong>，網銀轉賬一定要有用戶<strong>數字證書私鑰</strong>簽名的轉賬確認，而這個私鑰只有用戶的 Token 唯一擁有，而銀行擁有用戶<strong>數字證書公鑰（Public Key）</strong>，可以成功解密出用戶私鑰（Private Key）簽名的轉賬確認，以此確信<strong>轉賬指令</strong>是由擁有 USB Token 的用戶發出來的，這樣會進一步提高網銀的安全性。</p>
<p>手機銀行一般都是 APP，可以強制使用<strong>（Public Key Pinning ）</strong>特定根證書作爲證書信任鏈的頂端，可以避免客戶端使用<strong>誤安裝的僞造證書</strong>，所以 APP 不會與假的服務器建立 TLS 連接，只會與真正的服務器建立安全隧道，一旦隧道成功建立，通信就是安全的，即使轉轉也是安全的。當然如果轉賬之前通過手機短消息確認，那安全性基本上就無懈可擊了。</p>
</div>
</div>




</div>


</div>
</div>