+++
date = "2017-02-26T07:00:00"
title = "一個也許看不明白，卻和正在上網的你密切相關的大事"
titleimage = "http://pic2.zhimg.com/5c4fd06f07852ccbef74f90f172bcfdd.jpg"
ga = 022607
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



<div class="headline-background">
<a class="headline-background-link" href="https://zhuanlan.zhihu.com/p/25401383">
<div class="heading">相關新聞</div>
<div class="heading-content">密碼學大事件！研究人員公佈第一例 SHA-1 哈希碰撞實例</div>
<i class="icon-arrow-right"></i>
</a>
</div>

</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title"></h2>

<div class="answer">



<div class="content">
<p>多圖預警，長答案預警，請在 WiFi 環境下閱讀此答案。</p>
<p>---</p>
<p><strong>寫在前面</strong></p>
<p>感謝知乎密碼學交流羣的同學 @王希 對本答案的部分地方進行了精煉，@某位老師對本答案提出了寶貴的意見。感謝安全大事件（<a href="https://zhuanlan.zhihu.com/dashijian">知乎專欄</a>）團隊成員 @Murasaki 爲本答案提出了改進的建議。</p>
<p><strong>攻擊成本問題</strong></p>
<p>SHA-1 攻擊成果令人驚異，據說還導致了小範圍比特幣的拋售&hellip;然而，事情並沒有想象的那麼嚴重。原因如下：</p>
<p>首先，比特幣系統中一共使用了 2 個哈希函數，分別爲 SHA-256、RIPEMD160。這是與 SHA-1 完全不同的哈希函數。另外，RIPEMD160 只用於交易地址的壓縮，確認交易和數字簽名所用的哈希函數均爲 SHA-256。到現在爲止學者們還沒有發現 SHA-256 的漏洞，因此比特幣的安全性仍然可以得到保證。</p>
<p>第二，正如後面答案中提到的，SHA-1 早在 2011 年就已經被建議替換。只不過因爲兼容性問題和成本問題，有些對安全不太重視的廠商還在使用 SHA-1。這次的攻擊結果能夠促使這些廠商認真考慮替換 SHA-1 的問題，否則其產品會失去市場。對於那些對安全很重視的公司，如 Google、蘋果、IBM、微軟等（感謝 @唐勇 的評論，微軟也是最先推薦使用 SHA-256 的公司之一），SHA-1 早已被拋棄使用了。</p>
<p>第三，雖然 Google 的算法是實際上可行的，但攻擊成本有多少呢？論文中提到，算法的執行時間大約爲 6500CPU 年和 100GPU 年。這是個什麼概念呢？如果某個攻擊者要使用這個算法實現攻擊，它需要在 Amazon EC2 上租賃足夠的 CPU 計算核與 GPU 計算核（當然了，租的越多花費時間越少）。正如論文中給出的，如果把時間成本也考慮其中，實施 SHA-1 攻擊的成本雖然得到了降低，但也不少，大約需要花費 7.5W-12W 美金。這對一般攻擊者來說，成本應該算比較高吧&hellip;</p>
<p>（注：7.5W-12W 美金的花費實際對應的是 Stevens 等人提出的另一種攻擊方法，此攻擊方法效率更好，但是並行處理能力相對較差。猜測新攻擊方法會花費更多的費用租賃 GPU 計算核，從而實現大規模並行處理。綜合考慮，個人認爲兩種攻擊的花銷接近，可能新攻擊方法的花銷會更大）</p>
<p>---</p>
<p><strong>前沿</strong></p>
<p>今天（2017 年 02 月 24 日）一大早，我微信的朋友圈就被刷屏了：Google 發佈了哈希函數 SHA-1 的 哈希碰撞實例。同時，我的知乎上也推送了上海交通大學 LoCCS 實驗室理論密碼研究組發佈的專欄文章：《密碼學大事件！研究人員公佈第一例 SHA-1 哈希碰撞實例》（專欄文章鏈接：<a href="https://zhuanlan.zhihu.com/p/25401383">知乎專欄</a>）。</p>
<p>起初，我還以爲 Google 團隊僅僅找到了兩組沒有意義的數據，但 SHA-1 結果相同而已。但在晚間深入閱讀了 Google 團隊的安全博客，並閱讀了論文《The First Collision for Full SHA-1》後，我發現我低估了 Google 所發佈工作的意義。實際上，Google 發佈的工作遠超我之前的想象。Google 的工作基本可以宣判了 SHA-1 的死刑！</p>
<p>專欄文章：《密碼學大事件！研究人員公佈第一例 SHA-1 哈希碰撞實例》也提到一個八卦：</p>
<blockquote>這個轟動性結果甚至讓今年某頂級學術會議的 Deadline 爲之延期！！</blockquote>
<p>而這個頂級學術會議就是密碼學界最爲著名的會議 CRYPTO 了。在 CRYPTO 2017 官方網站上我們可以看到一個大大的紅色延期標記：</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-27b3af4e793bcc073d6415dcd0ff4f28_b.jpg" alt="">
<p>一般來說，會議截稿日期延期主要是因爲投稿論文數量沒有達到期望值，但任意領域最頂級的會議從來不會缺少稿件。而且注意到，這次延期感覺很奇怪，只延長了 19 個小時而已。因此，能使這種重量級會議的截稿日期延期，唯一的情況就是某個轟動的結果所總結的論文將會投稿到此會議上。實際上，CRYPTO 組委會就是多給了 19 小時的時間，等待 Google 方面完成論文的撰寫。由此可見，Google 這一工作對密碼學理論的重要程度。這篇重量級的論文即爲前面提到的《The First Collision for Full SHA-1》（原始論文：<a href="https://shattered.io/static/shattered.pdf">https://shattered.io/static/shattered.pdf</a>）。相信這篇論文會被 CRYPTO 2017 錄用。</p>
<p>本着可觀科學的原則，我試圖撰寫一篇稍微深入的答案，爲知友們深入介紹一下 Google 所做的工作，以及這個工作的意義。本答案將包括下述幾個部分：</p>
<ol>
<li>哈希函數簡介（科普）</li>
<li>SHA-1 哈希函數簡介（科普）</li>
<li>《The First Collision for Full SHA-1》工作簡介（科普）</li>
<li>《The First Collision for Full SHA-1》工作驗證（非科普）</li>
<li>《The First Collision for Full SHA-1》工作意義（科普）</li>
</ol>
<p>---</p>
<p><strong>哈希函數簡介（科普）</strong></p>
<p>我相信很多知友們都聽說過，或者有意無意地使用過哈希函數。知乎已經實現了全站 https，因此我們訪問知乎的時候就會無意中使用哈希函數。https 的標誌是瀏覽器地址欄的左側會出現一個帶鎖的標誌。以 Google 的 Chrome 瀏覽器爲例，鎖的標誌大概是這樣的：</p>
<img class="content-image" src="http://pic2.zhimg.com/70/v2-fb10212af40f91bdbbe0280b13dd5079_b.jpg" alt="">
<p>如果知友們瞭解如何瀏覽 https 證書信息的話，可以通過一系列操作，最後看到這樣的界面：</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-17d846123a1636d5d0eeba486417a62c_b.jpg" alt="">
<p>其中，【簽名哈希算法】部分寫着 SHA-256，這就是 https 所使用的哈希函數了。有趣的是，如果拖動滾動條，會發現知乎 https 證書的【指紋算法】仍然使用了 SHA-1：</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-de9a677d52b6bf78c3dd8b801ba2579b_b.jpg" alt="">
<p>所以可能知乎所用的證書也需要更新了~</p>
<p>（注：實際上證書安全性的核心在於數字簽名、密鑰用法等，單純的指紋算法和指紋本身對安全性沒什麼影響。由於數字簽名使用的是 SHA-256，知乎的證書暫時沒什麼問題，大家還是可以放心的~）</p>
<p>另一個知友們可能經常看到的哈希函數使用實例在軟件下載界面。下載軟件時，我們經常會看到文件上傳者提供了幾個看似毫無意義的字符串。這幾個字符串就是使用不同的哈希函數計算得到的。不過，由於互聯網安全技術的不斷髮展，這些字符串的驗證過程已經變爲了後臺執行，用戶下載時不需要再人工比對了。例如，如果知友們於 2017 年 2 月 24 日訪問著名程序語言 Java 的開發環境下載界面，則會看到這樣一個警告信息：</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-9cf3206cb0a42ad7eb5a877a2ee3b078_b.jpg" alt="">
<p>關鍵地方的翻譯如下：</p>
<blockquote><strong>Important planned change for MD5-signed JARs<br></strong> <strong>有關 MD5- 簽名 JARs 的重要變化<br></strong> <br>Starting with the April Critical Patch Update releases, planned for April 18 2017, all JRE versions will treat JARs signed with MD5 as unsigned. <br>計劃於 2017 年 4 月 18 日發佈四月的重要補丁更新，此更新後，如果 JRE 版本 JARs 文件所用的簽名使用了 MD5，服務器將認爲此簽名無效。</blockquote>
<p>正是由於著名哈希函數 MD5 已經不再安全，因此安全界纔會發佈這樣一個計劃，逐漸將 MD5 退出歷史舞臺。</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Ctextsf%7BHash%7D%28%5Ccdot%29" alt="">
<ol>
<li><strong>確定性</strong>：哈希函數的算法是確定性算法，算法執行過程不引入任何隨機量。這意味着相同消息的哈希結果一定相同。</li>
<li><strong>高效性</strong>：給定任意一個消息<img class="content-image" src="http://www.zhihu.com/equation?tex=m" alt=""> ，可以快速計算<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Ctextsf%7BHash%7D%28m%29" alt=""> 。</li>
<li><strong>目標抗碰撞性</strong>：給定任意一個消息<img class="content-image" src="http://www.zhihu.com/equation?tex=m_0" alt=""> ，很難找到另一個消息<img class="content-image" src="http://www.zhihu.com/equation?tex=m_1" alt=""> ，使得<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Ctextsf%7BHash%7D%28m_0%29%3D%5Ctextsf%7BHash%7D%28m_1%29" alt=""> .</li>
<li><strong>廣義抗碰撞性</strong>：很難找到兩個消息<img class="content-image" src="http://www.zhihu.com/equation?tex=m_0+%5Cneq+m_1" alt=""> ，使得<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Ctextsf%7BHash%7D%28m_0%29%3D%5Ctextsf%7BHash%7D%28m_1%29" alt=""> 。</li>
</ol>
<p>在密碼學上，一般認爲如果第 4 個條件不滿足，那麼此哈希函數就不再安全。在實際中，一般認爲如果<strong>在某種程度上</strong>第 3 個條件不滿足，那麼此哈希函數就不再安全。當然了，如果第 3 個條件完全不滿足，那麼此哈希函數已經徹底不安全，應該被直接棄用。</p>
<p>哈希函數的（廣義）抗碰撞性使得哈希函數可以用於數據的完整性驗證。舉例來說，某個用戶上傳一個文件供其他用戶下載。用戶在網絡上公開了文件的哈希函數輸出結果。下載用戶完成下載後，計算下載結果的哈希函數輸出結果。如果結果相等，則可以認爲下載的軟件就是官方發佈的軟件，沒有遭到第三方的篡改。</p>
<p>哈希函數第二個常見的應用場景是密碼存儲。在用戶進行網站登錄時，如果服務器直接存儲用戶密碼，則如果服務器被攻擊者所攻擊，用戶的密碼就會遭到泄露。最典型的事件就是 CSDN 的密碼明文存儲事件了。爲了解決這個問題，服務器可以僅存儲用戶密碼的哈希結果。當用戶輸入登錄信息後，服務器端可以計算密碼的哈希結果，並與存儲的哈希結果進行對比，如果結果相同，則允許用戶登錄。由於服務器不直接存儲用戶密碼，因此即使服務器被攻擊者攻擊，用戶的密碼也不會被泄露。這也是爲什麼我們在使用【找回密碼】功能時，服務器直接請求輸入新的密碼，而不是把原始密碼發送給我們。畢竟，它自己也不知道用戶的密碼是什麼&hellip; 至於彩虹表攻擊等，屬於討論範疇之外，在此不多做敘述。</p>
<p>（注：特別感謝 @大空格 的指正。原始答案中我寫的是客戶端計算哈希值後傳給服務器，這是完全錯誤的。參考<a href="http://blog.jobbole.com/61872/">加鹽密碼哈希：如何正確使用 - 文章 - 伯樂在線</a>文章中的描述：</p>
<blockquote>即使瀏覽器端用 JavaScript 加密了，你仍然需要在服務端再次進行加密。試想有個網站在瀏覽器將密碼經過哈希後傳送到服務器，那麼在認證用戶的時候，網站收到哈希值和數據庫中的值進行比對就可以了。這看起來比只在服務器端加密安全得多，因爲至始至終沒有將用戶的密碼明文傳輸，但實際上不是這樣。<br><br>問題在於，從客戶端來看，經過哈希的密碼邏輯上成爲用戶真正的密碼。爲了通過服務器認證，用戶只需要發送密碼的哈希值即可。如果有壞小子獲取了這個哈希值，他甚至可以在不知道用戶密碼的情況通過認證。更進一步，如果他用某種手段入侵了網站的數據庫，那麼不需要去猜解任何人的密碼，就可以隨意使用每個人的帳號登錄。<br><br>這並不是說你不應該在瀏覽器端進行加密，但是如果你這麼做了，一定要在服務端再次加密。</blockquote>
<p>）</p>
<p>哈希函數第三個重要的應用是數字簽名。實際上， 數字簽名算法對消息的長度和格式是有要求的 ，要求數據滿足一定的條件。爲了解決這個問題，學者們指出可以對數據的哈希結果簽名。由於哈希結果的長度是固定的，一般來說容易構造一種方法，讓這個長度固定的結果進一步滿足數字簽名算法對數據輸入的要求。而由於哈希函數的抗碰撞性，如果原始數據被篡改，那麼哈希結果也會變化，同樣會導致簽名無法通過驗證。更爲重要的是，先哈希後簽名的方法可以讓簽名變得更安全。實際上可以證明，如果先哈希，再執行 RSA 數字簽名，則此算法是<strong>可證明安全的</strong>。詳細信息可以參考 Katz 和 Lindell 的書籍《Introduction to Modern Cryptography》，第 13.2.3 節，OAEP。</p>
<p>---</p>
<p><strong>SHA-1 哈希函數簡介（科普）</strong></p>
<p>SHA-1 是 1995 年國家標準技術局 NIST（National Institute of Standards and Technology）於 1995 年標準化的哈希函數。與前身 MD5 相比，SHA-1 的輸出長度更長（MD5 輸出長度爲 128bit，而 SHA-1 的輸出長度爲 160bit），這也意味着出現哈希碰撞的概率更低。同時，SHA-1 的安全性似乎也比 MD5 更好。</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=2%5E%7B160%7D" alt="">
<p>（注：在後面的論述中，我將直接用計算量級表示調用 SHA-1 的次數）</p>
<p>抽屜原理很容易理解：假設有 4 個抽屜，而有 5 個蘋果。我們要把這 5 個蘋果放在 4 個抽屜裏，那麼必然至少有 2 個蘋果被放進了同一個抽屜。就算前 4 個蘋果均放在了不同的抽屜中，由於所有抽屜都被佔滿了，而第 5 個蘋果也要佔一個抽屜，因此這個蘋果一定和前面 4 個蘋果中的某個蘋果放在了同一個抽屜裏面。</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-402451a2603c987cd9df1ce9f235fad0_b.jpg" alt="">
<p>（圖片來源：<a href="https://link.zhihu.com/?target=http%3A//blog.sina.com.cn/s/blog_be5d0b740101f2y4.html">課件《抽屜原理》_永恆的心_新浪博客</a>）</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=2%5E%7B160%7D" alt="">
<p>然而，我們可以通過概率方法尋找。我們放寬條件：如果降低一定的計算量，能不能<strong>有比較高的概率找到一組碰撞</strong>呢？這就是著名的生日攻擊（Birthday Attack）了。</p>
<p>根據抽屜原理，一個屋子裏必須有 366 個人（一年有 365 天，不考慮閏年）才能保證<strong>一定</strong>有 2 個人生日相同。然而，如果一個屋子裏有 23 個人，則<strong>有 50%的概率 2 個人生日相同</strong>。根據概率論（感謝 @程恩瓊 @韓劼羣 指出原始答案中的筆誤）：</p>
<ul>
<li>第 2 個人和第 1 個人生日不相同的概率爲<img class="content-image" src="http://www.zhihu.com/equation?tex=1-%5Cfrac%7B1%7D%7B365%7D" alt=""> ；</li>
<li>第 3 個人和第 1 個人生日不相同的概率爲<img class="content-image" src="http://www.zhihu.com/equation?tex=1-%5Cfrac%7B1%7D%7B365%7D" alt=""> ，和第 2 個人生日也不相同的概率爲<img class="content-image" src="http://www.zhihu.com/equation?tex=1-%5Cfrac%7B1%7D%7B364%7D" alt=""> （因爲此時已經假定前 2 個人生日不同），因此和前 2 個人生日都不相同的概率爲<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Cleft%281-%5Cfrac%7B1%7D%7B365%7D%5Cright%29%5Cleft%281-%5Cfrac%7B1%7D%7B364%7D%5Cright%29" alt=""> ；</li>
<li>第 4 個人和前 3 個人生日都不相同的概率爲<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Cleft%281-%5Cfrac%7B1%7D%7B365%7D%5Cright%29%5Cleft%281-%5Cfrac%7B1%7D%7B364%7D%5Cright%29%5Cleft%281-%5Cfrac%7B1%7D%7B363%7D%5Cright%29" alt=""> ；</li>
<li>......</li>
<li>第 23 個人和前 22 個人生日都不相同的概率爲<img class="content-image" src="http://www.zhihu.com/equation?tex=%5C%5B%5Cprod%5Climits_%7Bi+%3D+1%7D%5E%7B23%7D+%7B%5Cleft%28+%7B1+-+%5Cfrac%7B1%7D%7B%7B365+-+i+%2B+1%7D%7D%7D+%5Cright%29%7D+%5C%5D" alt=""> ；</li>
<li>上述事件同時發生時，23 個人生日纔會各不相同。因此，23 個人中存在 2 個人生日相同的概率爲：<img class="content-image" src="http://www.zhihu.com/equation?tex=1-%5Cfrac%7B365%21%7D%7B%28365-23%29%21+%5Ccdot+365%5E%7B23%7D%7D+%5Capprox+50%5C%25" alt=""> 。</li>
</ul>
<img class="content-image" src="http://www.zhihu.com/equation?tex=%5Csqrt%7B2%5E%7B160%7D%7D%3D2%5E%7B80%7D" alt="">
<p><img class="content-image" src="http://www.zhihu.com/equation?tex=2%5E%7B80%7D" alt=""></p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=2%5E%7B80%7D" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=2%5E%7B61%7D" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=2%5E%7B57.5%7D" alt="">
<p>當然了，如果你注意到的話，會發現 Stevens 正是 Google 所做工作論文的第一作者&hellip;</p>
<p>---</p>
<p><strong>《The First Collision for Full SHA-1》工作簡介（科普）</strong></p>
<p>現在我們可以看看，Google 的工作（同樣也是 Stevens 的工作）到底是什麼？我們直接引用此工作官方網站（原始鏈接：<a href="https://link.zhihu.com/?target=https%3A//shattered.it/">SHAttered</a>）的介紹吧：</p>
<blockquote>We have broken SHA-1 in practice. <br>我們從應用角度破解了 SHA-1。 <br><br>This industry cryptographic hash function standard is used for digital signatures and file integrity verification, and protects a wide spectrum of digital assets, including credit card transactions, electronic documents, open-source software repositories and software updates. <br>這一工業界應用的密碼學哈希函數標準被用於數字簽名、文件完整性驗證中，並在多個領域保護着人們的數字財產，這些數字財產包括信用卡交易、電子文檔、開源軟件倉庫、軟件更新等。<br><br>It is now practically possible to craft two colliding PDF files and obtain a SHA-1 digital signature on the first PDF file which can also be abused as a valid signature on the second PDF file. <br>在實際中，我們可以構造兩個 SHA-1 結果相同的 PDF 文件。這使得第二個文件 SHA-1 後的數字簽名可以通過第一個文件 SHA-1 後數字簽名的驗證。<br><br>For example, by crafting the two colliding PDF files as two rental agreements with different rent, it is possible to trick someone to create a valid signature for a high-rent contract by having him or her sign a low-rent contract. <br>舉例來說，可以構造兩個 SHA-1 結果相同的 PDF 租賃協議文件，協議文件中標註的租金不同，但高租金文件的 SHA-1 後簽名結果與低租金文件的 SHA-1 後簽名結果一樣。這樣，可以讓租賃方在低租金文件上簽字，再用高租金文件替換，達到僞造租賃協議文件的目的。 <br><strong><br>Attack Proof</strong> <br><strong>攻擊證明</strong> <br><br>Here are two PDF files that display different content, yet have the same SHA-1 digest. <br>下方有兩個 PDF 文件，其顯示的內容不同，但 SHA-1 摘要結果相同。</blockquote>
<p>從論述中可以發現，Stevens 等人成功構造了兩個 PDF 文件（<strong>這是有意義、可以真正打開的文件</strong>），使得 SHA-1 結果相同！這可是比較誇張了&hellip; 我們來看看這兩個文件。</p>
<ul>
<li>第一個文件的下載鏈接爲：<a href="https://link.zhihu.com/?target=https%3A//shattered.it/static/shattered-1.pdf">https://shattered.it/static/shattered-1.pdf</a></li>
<li>第二個文件的下載鏈接爲：<a href="https://link.zhihu.com/?target=https%3A//shattered.it/static/shattered-2.pdf">https://shattered.it/static/shattered-2.pdf</a></li>
</ul>
<p>第一個文件打開後是這樣的：</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-64ed2f90f9a6e2585a9006fdb2db96b0_b.jpg" alt="">
<p>第二個文件打開後是這樣的：</p>
<img class="content-image" src="http://pic2.zhimg.com/70/v2-32c116126e92cf9b044806bccd46d701_b.jpg" alt="">
<p>驚到了好嗎！不光是能打開的 PDF，PDF 的內容竟然還有意義！這讓我感覺 Stevens 的工作可不是找到了一組碰撞那麼簡單。實際上，官方網站後續的說明也側面說明了這一點：</p>
<blockquote><strong>File tester</strong> <br><strong>文件測試</strong> <br><br>Upload any file to test if they are part of a collision attack. Rest assured that we do not store uploaded files. <br>請上傳任意文件，來檢測文件本身是否可能被這種攻擊威脅。我們保證不存儲您所上傳的文件。</blockquote>
<p>那麼，Stevens 到底的工作到底如何？能做到什麼效果呢？我們可能不得不閱讀一下論文了。（感謝 @康尼扎羅反應 的修正建議，至於爲何這樣翻譯，需要理解下面描述的工作原理）</p>
<p>---</p>
<p><strong>《The First Collision for Full SHA-1》工作驗證（非科普）</strong></p>
<p>（本部分截圖部分來自於 Stevens 等人的原始論文：<a href="https://link.zhihu.com/?target=https%3A//shattered.it/static/shattered.pdf">https://shattered.it/static/shattered.pdf</a>）</p>
<img class="content-image" src="http://www.zhihu.com/equation?tex=P" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=M_1%5E%7B%281%29%7D%2CM_2%5E%7B%281%29%7D%2CM_1%5E%7B%282%29%7D%2CM_2%5E%7B%282%29%7D" alt="">
<p>於是，他們構造了一個滿足 PDF 文件解碼要求的文件前綴，內容爲：</p>
<img class="content-image" src="http://pic3.zhimg.com/70/v2-06344a984f73b47ca4accfa3b364d762_b.jpg" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=P" alt="">
<img class="content-image" src="http://pic4.zhimg.com/70/v2-ab89b49c2b0e1dbe97373e322e962f5b_b.jpg" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=M_2%5E%7B%281%29%7D" alt="">
<img class="content-image" src="http://pic1.zhimg.com/70/v2-dcd2e0a809c6dc8d1ad0b7adb578a820_b.jpg" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=M_1%5E%7B%282%29%7D" alt="">
<img class="content-image" src="http://pic2.zhimg.com/70/v2-3f3a9f16d28256ad95461eb3923d2689_b.jpg" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=M_2%5E%7B%282%29%7D" alt="">
<img class="content-image" src="http://pic4.zhimg.com/70/v2-b007ef0e626df95af3fa5fdf35392c03_b.jpg" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=S" alt="">
<p>既然如此，我們用二進制方式打開這兩個 PDF 文件看一看是否真的如此。首先打開<strong>shattered-2.pdf</strong>（注意，先是第 2 個文件），觀察文件開始部分：</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-130c264f0a13851c972993a846e62c93_b.jpg" alt="">
<p>可以看到：</p>
<ul>
<li>第 000 行至第 0B0 行是 Stevens 等人給出的前綴數據<img class="content-image" src="http://www.zhihu.com/equation?tex=P" alt=""> ；</li>
<li>第 0C0 行至第 0F0 行是<img class="content-image" src="http://www.zhihu.com/equation?tex=M_1%5E%7B%281%29%7D" alt=""> ；</li>
<li>第 100 行至第 130 行是<img class="content-image" src="http://www.zhihu.com/equation?tex=M_2%5E%7B%281%29%7D" alt=""> ；</li>
<li>後面是後綴數據<img class="content-image" src="http://www.zhihu.com/equation?tex=S" alt=""> 。</li>
</ul>
<p>再打開<strong>shattered-1.pdf</strong>（現在是第 1 個文件），觀察文件開始部分：</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-c8ad71ca6390461809806f5cc9ffcc84_b.jpg" alt="">
<p>可以看到：</p>
<ul>
<li>第 000 行至第 0B0 行仍然是前綴數據<img class="content-image" src="http://www.zhihu.com/equation?tex=P" alt=""> ；</li>
<li>第 0C0 行至第 0F0 行是 <img class="content-image" src="http://www.zhihu.com/equation?tex=M_1%5E%7B%282%29%7D" alt=""> ；</li>
<li>第 100 行至第 130 行是 <img class="content-image" src="http://www.zhihu.com/equation?tex=M_2%5E%7B%282%29%7D" alt=""> ；</li>
<li>後面是後綴數據<img class="content-image" src="http://www.zhihu.com/equation?tex=S" alt=""> 。</li>
</ul>
<img class="content-image" src="http://www.zhihu.com/equation?tex=P" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=M_1%5E%7B%281%29%7D%2CM_2%5E%7B%281%29%7D%2CM_1%5E%7B%282%29%7D%2CM_2%5E%7B%282%29%7D" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=m_0" alt="">
<img class="content-image" src="http://www.zhihu.com/equation?tex=M_1%5E%7B%281%29%7D%2CM_2%5E%7B%281%29%7D%2CM_1%5E%7B%282%29%7D%2CM_2%5E%7B%282%29%7D" alt="">
<img class="content-image" src="http://pic1.zhimg.com/70/v2-05540f1c7be2469a00d1c2f4f14dab58_b.jpg" alt="">
<p>（圖片來自上海交通大學 LoCCS 實驗室理論密碼研究組發佈的專欄文章：《密碼學大事件！研究人員公佈第一例 SHA-1 哈希碰撞實例》：<a href="https://zhuanlan.zhihu.com/p/25401383">知乎專欄</a>。感謝 LoCCS 實驗室團隊成員的指正，原始圖片來自於 Google 安全博客<a href="https://security.googleblog.com/2017/02/announcing-first-sha1-collision.html">https://security.googleblog.com/2017/02/announcing-first-sha1-collision.html</a>）</p>
<p>---</p>
<p><strong>《The First Collision for Full SHA-1》工作意義（科普）</strong></p>
<p>Stevens 等人工作的最大意義是，可以在較短時間內尋找到<strong>有意義</strong>的兩個文件，使得其 SHA-1 結果相同。<strong>雖然尋找碰撞的速度比已知的最好速度慢一些，但是輸出文件有意義這一點是非常亮眼的</strong>。這對於哈希函數本身來說雖不能算是徹底的破解，但也已經很接近了。此工作基本可以宣告 SHA-1 的死刑。</p>
<p>不過，其實也還好。我們應該感謝一個叫做 Kerckhoffs 的研究者。這裏引用 @王希 同學在問題<a href="https://www.zhihu.com/question/47316089">在有限專家間評議加密算法是不是比直接公開更安全？ - 網絡安全 - 知乎</a>下的回答：</p>
<blockquote>（Kerckhoffs 指出）開放密碼學設計則有如下四點優勢：<br><ol>
<li>公開的設計可以承受公開的鑽研和分析，因此可以更加強壯。構造良好的密碼學方案非常困難，更廣泛地被研究可以證明其安全性。</li>
<li>公開後有更大的可能被正義黑客發現，比被敵人發現要好。</li>
<li>系統的安全取決於算法的保密性，對代碼的逆向抵抗力很差。密鑰不是代碼的一部分，不存在這個問題。</li>
<li>公開設計使標準更容易建立。</li>
</ol></blockquote>
<p>雖然 Kerckhoffs 是在加密算法的環境下提出了公開密碼學算法的概念，這個理念也被傳到了哈希函數上面。自 2005 年王小云教授指出 SHA-1 的漏洞後，NIST 在 2011 年就提出反對使用 SHA-1 算法，應使用更安全的哈希函數。這給了業界大量的時間選擇更好的算法，並逐漸替換 SHA-1。現在，新生成的 https 數字證書已經基本淘汰了 SHA-1。同時注意到，Stevens 等人的攻擊方法還是要求消息滿足一定的條件，因此 SHA-1 還沒到已經徹底不安全的程度。</p>
<p>不過，警鐘都敲成這樣了，換不換？！</p>
<p>以上。</p>
</div>
</div>




</div>


</div>
</div>