+++
date = "2016-12-10T09:00:00"
title = "爲什麼說「網遊公佈抽取概率」非常好，我來給你算算"
titleimage = "http://pic4.zhimg.com/078659fe175594dc20d4afe5da8e2aa3.jpg"
ga = 121009
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



<div class="headline-background">
<a class="headline-background-link" href="http://mt.sohu.com/20161207/n475132046.shtml">
<div class="heading">相關新聞</div>
<div class="heading-content">玄不救非，氪不改命？文化部怒了：網遊物品抽取概率必須公開！</div>
<i class="icon-arrow-right"></i>
</a>
</div>

</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">如何評價文化部新規：網遊需公示道具抽取或合成概率？</h2>

<div class="answer">



<div class="content">
<p>此答案好像受到了很多關注，於是答主決定在原答案後面更新些更多的內容。</p>
<p>這個新規很好。我覺得既然目的是公開透明理性消費，那麼爲了針對亂用父母信用卡的小學生們，我們有必要在說明裏科普一下基礎統計學和概率論內容，以便達到真正的&ldquo;明明白白消費&rdquo;。</p>
<p><strong>方差與期望<br></strong>1/10 的概率不代表抽 10 次肯定能有 1 個，有可能有<a href="tel:123456789">123456789</a>個，但也有可能 1 個都沒抽到。 要告訴玩家 10 個裏面出 1 個是期望值，不是必然結果。</p>
<p><strong>獨立事件<br></strong>&ldquo;啊我都連續 9 次出藍卡了，下一個肯定是紫的了，不然概率就不對了啊！&rdquo; 這是很多玩家都有的心理，實際上每次抽卡理論上應該是獨立的。 在競技類遊戲中比如暴擊和格擋有時會利用修正過的概率，其本質爲&rdquo;如果這一刀沒有暴擊，下一刀的暴擊率增加，直到出現暴擊爲止&rdquo;，在一系列算法修正後，其平均發生概率爲顯示出來的概率。 如果抽卡遊戲裏沒有設置&ldquo;十連抽必出 sr&rdquo;，&ldquo;這次抽不到下次抽到的概率會增加&rdquo;等保底模式，那理論上應該將每次抽卡歸位獨立事件。</p>
<p><strong>相關和因果<br></strong>&ldquo;我今天凌晨一點的時候買了一管體力然後畫符，結果就開出個 SSR！那我每天都熬到凌晨一點買一管體力畫符，肯定每天都有 SSR！&rdquo;</p>
<p>有的事情只是有相關性（或者只是碰巧一起發生了），其實並沒有因果關係。 這種例子經常出現在&ldquo;大神教你如何強化裝備上&rdquo;。</p>
<p><strong>倖存者偏差<br></strong>&ldquo;憑什麼我周圍的朋友運氣都比我好，我是不是上了遊戲商黑名單？！&rdquo;</p>
<p>只有抽到的人才會整天秀朋友圈...運氣不好的人都默不作聲，假裝沒玩這個遊戲.</p>
<p><strong>聚類效應 clustering effect<br></strong>&ldquo;這個學長居然三包抽了三張橙卡，肯定有什麼特殊的技巧，他說今晚教我獨門絕技肯定不是騙我的！&rdquo;</p>
<p>這就和一直投硬幣總會連續有幾個正面或反面一樣，有的時候好運和黴運是會連着來的，並不能說明事件受到了操控.</p>
<p>爲了驗證遊戲方有沒有掛羊頭賣狗肉，是不是可以成立一個&ldquo;網遊概率驗證公司&rdquo;，從統計學的角度幫助玩家維權獲賠，也許是個新的創業機會呢！！想想都激動呢！！</p>
<p>以下內容爲概率論和統計學基礎&mdash;&mdash;嫌長的直接跳到結論</p>
<p>這個回答的評論 / 贊比例非常高，熱心的網友可以加入評論區的&ldquo;討論&rdquo;。<strong>我也本着爲祖國的花朵謀福利的崇高精神</strong>，繼續做一些進階（高中）科普：</p>
<p><strong>二項式分佈</strong></p>
<p>抽卡可以簡化爲二項式分佈（抽到的要麼是你想要的，要麼是你不想要的）。</p>
<p>二項式分佈(Binomial Distribution)的概率質量函數（probability mass function aka PMF)爲:</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-bad508b209785d9379f1eb6609692160_b.jpg" alt="">
<p>期望值爲 np 方差爲 np*(1-p)</p>
<p>其中 p 爲事件發生概率，n 爲總次數，k 爲理想的次數（就是你想要抽到多少張）。 其實這個公式的來源也很好理解，有 k 次成功（p^k)意味着有 n-k 次失敗(p^(n-k)，然後這 k 次成功一共有 nCk 總出現方式，所以就有了以上公式。</p>
<p>現在如果我們要計算在成功率爲 10%的前提下，抽 100 次能中 10 次的概率套入公式就是：</p>
<p>100C10*0.1^10*(0.9)^90=0.131865 約等於 13%的概率能剛好抽到 10 次。</p>
<p>不明真相的羣衆現在肯定炸開鍋了&ldquo;什麼！！！！說好的 10% 的概率難道 100 次中 10 次不應該是很容易發生的嗎！！！居然只有 13% 的概率，不良廠商你退我錢！&rdquo; 這就是我們熟知的&ldquo;方差&rdquo;。</p>
<p><strong>方差（Variance）</strong>：是衡量隨機變量或一組數據時離散程度的度量，可以理解爲好運和黴運的距離有多遠，0 方差意味着每次的結果都是守恆的，二項式分佈的方差爲 np*(1-p). 方差越大那麼結果偏離期望值的可能性就越高（可以是好運的偏離也可以是黴運的偏離）。 方差的平方根是<strong>基準差(Standard Deviation)</strong>。</p>
<p>好了我們繼續講剛剛的話題。 雖然 13% 的概率看起來不高，但實際上情況是這樣的：</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-47334ab9a520949e105d8a3706539b98_b.jpg" alt="">
<p>我們可以看到，雖然中 10 次的概率不高，但是中其他次數的概率更低啊！ 可以看到高概率的次數都是圍繞在&ldquo;10 次&rdquo;周圍，基本上 100 抽中 10 次的&ldquo;期望&rdquo;是沒有問題的。 值得注意的就是，中 20 次或者更高的概率幾乎爲 0，你們不要抱太多幻想了，呵呵。</p>
<p>細心的同學可能會看到表格中還出現了一個叫 Cumulative Probability 的東西。</p>
<p>Cumulative Probability 中文爲累積概率（CDF），定義爲：發生次數在 k 範圍內的總概率，計算方式爲將 Pr(x&lt;=k）的概率全部加起來,二項式的 CDF 爲：</p>
<img class="content-image" src="http://pic2.zhimg.com/70/v2-1a094596bf722ba04baea1cefe29b4d9_b.jpg" alt="">
<p><em>PS: 但是當 n 足夠大的時候，這種一個一個相加的方法實在太慢了，等下我會講一下</em><strong><em>&ldquo;Normal Approximation to Binomial Distribution"（正態分佈對二項式分佈的擬合）</em></strong><em>，嘗試用&rdquo;連續&ldquo;的方法來解決離散概率問題。</em></p>
<p>好了繼續我們的抽卡正題，比如上表中 P(k=10)的累積概率爲 58.316%，也就是說你抽 100 次有 58.316 的概率能抽中 10 次或更少，41.684 的概率抽中 10 次或更多。</p>
<p>相信很多人看到這裏已經要遭不住了，沒想到真相如此殘酷，你能不能直接告訴我，&ldquo;我就想要 10 張紫卡，大概得抽多少次才行？？&rdquo; 好的，請看下一個小段。</p>
<p><strong>負二項式分佈</strong></p>
<p>&ldquo;我會一直抽卡，直到抽中 10 張紫色的，那麼我總共抽卡次數的分佈是怎麼樣的呢？&rdquo;</p>
<p>這個問題屬於負二項式分佈，它表示在一連串試驗中，事件剛好在第 r+k 次試驗出現第 r 次的概率。</p>
<p>負二項式的概率質量函數爲：</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-93c2ef518109dde3586e1ed301362ebc_b.jpg" alt="">
<p><strong>期望值爲 r/p,方差爲 r/p^2<br></strong>其中 k 爲失敗次數，r 爲成功次數，p 爲事件成功概率，k+r 爲總次數。</p>
<p>負二項式的概率質量函數也很好理解：和二項式一樣，成功了 r 次，失敗了 k 次，那麼有 p^r * (1-p)^k，但是最後一次成功是在最後一次試驗中，所以前半部分的排列組合爲(k+r-1)C(r-1)。</p>
<p>用以上公式可以求出，在第 100 次剛好抽到第 10 張紫卡的概率爲：99C9*0.1^10*0.9^90=0.013187</p>
<p>這個概率低得可怕，但是玩家並不是真的關心&ldquo;我第 100 張抽到第 10 張紫卡的概率&rdquo;，玩家在意的應該是&ldquo;我在 100 張之內可以抽到 10 張紫卡的概率&rdquo;。</p>
<p>這裏又要用到之前說到的累積概率了，負二項式的累積概率算法和二項式很像，也是把 x&lt;k 的所有概率加起來。也就是 P(第 100 張抽到第 10 張紫卡)+P(第 99 張抽到第 10 張紫卡)...</p>
<p>通過各種概率論和微積分之後（我就不展開了...），這個累積概率可以"簡化&rdquo;成這樣：</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-6cd950c7107b189c8d9a6453eabc071c_b.jpg" alt="">
<p>好了不要糾結那個大寫 I 是什麼鬼，我們直接把負二項式的概率分佈畫出來，它長這樣：</p>
<img class="content-image" src="http://pic2.zhimg.com/70/v2-730994326ae4751add0fc85520201191_b.jpg" alt="">
<p>上圖爲 Neg~(r=10,p=0.1)的 pmf 和 cdf，紅色區域爲 50% 分界線，意爲被在紅色範圍內發生的概率爲 50%。 通過上圖可以看出，要想有 50%的概率得到 10 張紫卡，那你得抽 97 次。</p>
<p>那我要 80% 的概率呢？</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-3abe893b0d3ca2b03e69b31756e6afff_b.jpg" alt="">
<p>如果想要 80%的概率得到 10 張紫卡，那你得抽 124 次。</p>
<p>以相同的方法我可以看到要 99% 的概率就需要 183 次。</p>
<p>看到這裏我相信原本奔潰的朋友現在已經爆炸了。 我現在來講解一個更坑爹的抽卡形式，以求一擊致命。</p>
<p><strong>幾何分佈 Geometric Distribution </strong></p>
<p>幾何分佈的定義爲： 獲得一次成功所需要的總共嘗試次數的概率分佈。 其概率質量函數爲：</p>
<img class="content-image" src="http://pic2.zhimg.com/70/v2-1759b09cf38d38e76bd166cb40144b21_b.jpg" alt="">
<p><strong>其期望值爲 1/p,方差爲(1-p)/p^2</strong></p>
<p>這也很好理解，如果第一次成功發生在第 k 次，那麼前面的 k-1 次都肯定是失敗了。</p>
<p>所以如果 p=0.1，那麼第一次就抽到紫卡的概率爲 0.1, 第五次就抽到第一張紫卡的概率爲 0.06561</p>
<p>好了，現在我們可以來講抽卡遊戲裏最坑爹的套路了：</p>
<p><strong>獎券收集問題 Coupon Collector's Problem</strong></p>
<p>最直白的解釋就是&ldquo;集齊 N 張獎券可以換取最終獎勵。&rdquo; （集齊 9 個碎片即可召喚終極武將，集齊 9 張魏國武將即可解鎖終極屬性加成，我瞎 BB 的例子，不要當真）</p>
<p>假設一個盒子裏有 N 張不同的獎券，每張獎券被選中的概率都是相同的，並且抽走之後會放一張同樣的獎券進入這個盒子裏， 也就是說盒子裏始終保持着 N 張不同的獎券。 那麼收集到所有獎券所需要的次數是多少？</p>
<p>解決這個問題的關鍵在於你要發現剛開始的時候收集起來很容易，但是隨着你已有的獎券越來越多，獲取新獎券的概率就會逐漸減少... 而你集齊所有獎券的概率是這每一張獎券概率的集合。</p>
<p>我們現在來算一下這個問題的期望值：</p>
<p>設 T 爲獲取所有 N 種獎券所用的總次數的隨機函數，ti 爲獲取第 i 張獎券用的次數的隨機函數。獲取一張新獎券的概率爲 pi=(n-(i-1))/n，由於這事件服從幾何分佈，所以其期望值 E(ti)=1/pi</p>
<p>獲取第一張獎券的概率爲 p1=100%（因爲此時你還沒有任何獎券，任意一張對於你來說都是有用的）。 E(t1)=1</p>
<p>獲取第二張獎券的概率爲 p2=(n-1)/n （此時的概率不再是百分之百了，因爲你已經有了第一張，所以概率分子相應地減一）。 E(t2)=n/n-1</p>
<p>最後可以算出：</p>
<img class="content-image" src="http://pic1.zhimg.com/70/v2-cc244ddede7f75a259de4dd19c7381f0_b.jpg" alt="">
<p>好了，我就不解釋這公式什麼意思，直接上圖：</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-93f1ee87a054c85669c16f0f35014da7_b.jpg" alt="">
<p>可以發現，湊齊 9 個碎片需要的總次數期望值爲 26 次。。。 不要以爲 9 個碎片就只需要抽 9 次了喔。 然而更可怕的事&hellip;在湊卡牌陣容的時候，這些紫卡本身就極難獲取（不像每次抽獎券都能抽到，只是有可能重複罷了），如果還要來給這些紫卡&rdquo;搭配出某種陣容以得到最好的加成&rdquo;就更是難上加難了。</p>
<p>你以爲這就完了嗎？ 我們還沒有討論方差呢！ 剛剛說的 26 次只是個期望，方差可以讓我們有可能用更少的次數湊齊，也有可能讓我們以更多的次數湊齊。</p>
<p>請繫好安全戴，現在我們來看看方差的影響。</p>
<p>由於 ti 符合幾何分佈，而幾何分佈的方差爲 1-p/p^2，那麼導出方差 Var(T)</p>
<img class="content-image" src="http://pic3.zhimg.com/70/v2-061df66337f24768f26ae93f99ea163e_b.jpg" alt="">
<p>光是看到最後 n^2 就知道這個問題的方差很大（和前兩個比起來），發生好事的概率高,發生壞事的概率也高！</p>
<p>這是 coupon collector problem 的概率分佈圖：</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-4e4414dba42e912068c97896a9bd6617_b.jpg" alt="">
<p>紅色部分是 26（期望值）次抽卡所覆蓋的概率，大約爲 62.9%，也就是說抽 26 次能集齊 9 個碎片的概率只有 62.9%。</p>
<p>那如果你要收集所有 SR 式神，假如有 25 個，那麼分佈如下：</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-bc07a4759309f90d3bdc943fb2f83b57_b.jpg" alt="">
<p>要想 99%的概率收集齊 25 只，一共需要抽 192 次 SR。所以有強迫症的玩家要三思喔！</p>
<p>好了，我們講了那麼久的概率，期望值，方差，相信小學生們應該有個初步的統計思維了，總結一下就是：</p>
<p>1.期望值只是一個期望，並不能代表一定能發生。它的意義爲你重複地做一件事，它的結果會在期望值附近遊蕩。</p>
<p>2.方差描述了每次結果距離期望值有多遠，方差越大那麼結果在期望值附近遊蕩得越厲害（可以是好的遊蕩也可以是不好的遊蕩）。</p>
<p>有了以上概念，現在可以系統性地講一下如何理性評估自己的抽卡結果。</p>
<p>剛剛我一直在強調 &ldquo;抽 124 次有 80% 的概率拿到 10 張紫卡&rdquo;， &ldquo;抽 192 次有 99% 的概率收集齊 25 只 SR&rdquo;，現在我們引入一個概念：</p>
<p><strong>置信區間 Confidence Interval</strong></p>
<p>在統計學中，一個概率樣本的置信區間（Confidence interval）是對這個樣本的某個總體參數的區間估計。置信區間展現的是這個參數的真實值有一定概率落在測量結果的周圍的程度。置信區間給出的是被測量參數的測量值的可信程度，即前面所要求的&ldquo;一定概率&rdquo;。</p>
<p>比如說抽一百次卡，假設 95% 置信區間是在 8-12 張紫卡之間，那麼就有 95% 的可能性真實的紫卡數量在 8-12 之間。 方差越大，意味着分佈越分散，那麼這個區間的範圍就會越寬闊。</p>
<p>我們繼續用最簡單的例子來說：</p>
<p>抽 100 次，抽中的概率爲 10%，那我應該如何&rdquo;理性評估自己的結果呢？&ldquo;</p>
<p>在各式各樣的概率分佈中，正態分佈是最常用的一個，同時由於它的對稱性，其置信區間也非常容易算。</p>
<img class="content-image" src="http://pic2.zhimg.com/70/v2-2a8d03e91deaea251dc44f9063c47441_b.jpg" alt="">
<p>簡單來說，就說距離期望值 1 個基準差之內的是 68%的置信區間，2 個基準差之內的是 95%，3 個基準差之內的是 99.7%</p>
<p>細心的朋友也許發現了，這個和最開始那個二項式分佈長得好像呀！</p>
<p>當 n（抽卡次數）足夠大，p(成功概率）又不是非常小時，二項式分佈會趨近於正態分佈。</p>
<img class="content-image" src="http://pic4.zhimg.com/70/v2-34c383e37173bd4fef3821bb7d24a95f_b.jpg" alt="">
<p>Binomial~(n,p) ------&gt; Normal~(np,np(1-p))</p>
<p>還是相同的例子</p>
<p>擬合出的正態分佈期望值爲 100*0.1=10，方差爲 100*0.1*0.9=9，因此基準差爲 3</p>
<p>那麼 95%的置信區間就大約爲 (10-2*3,10+2*3)=(4,16)</p>
<p>抽 1000 次呢？</p>
<p>期望值=100，方差爲 90，基準差爲 90^0.5=9.5.</p>
<p>那麼 95%的置信區間就大約爲 (100-19,10+19)=(81,119)</p>
<p>細心的小朋友又可以發現，好像隨着樣本(n)變大，置信區間就相對地變窄了，我的理性預測也更精準了呢！</p>
<p>好了，是時候放終極大招了。</p>
<p><strong>大數定理 Law of Large Numbers</strong></p>
<p>在隨機事件的大量重複出現中，往往呈現幾乎必然的規律，這個規律就是大數定律。通俗地說，這個定理就是，<em><strong>在試驗不變的條件下，重複試驗多次，隨機事件的頻率近似於它的概率</strong></em>。偶然中包含着某種必然。 （摘自百度百科）</p>
<p>如果你還是覺得自己運氣不好，被拉進了非洲人黑名單，程序員故意和你作對，其實這些都是方差導致的，要想解決這個問題也很簡單：</p>
<p>你繼續抽啊！</p>
<p>重複試驗多次，隨機事件的頻率近似於它的概率！</p>
<p>重複試驗多次，隨機事件的頻率近似於它的概率！</p>
<p>重複試驗多次，隨機事件的頻率近似於它的概率！</p>
<p>有知友在評論區裏提到&rdquo;然而抽卡的資金會越來越少，被坑之後也很難再去大規模的試驗真實的概率了。&ldquo;</p>
<p>我回答到：&ldquo;找概率驗證公司，讓公司去找其他玩家採樣，有足夠樣本之後反推抽卡的真實概率。&rdquo;</p>
<p>現在我想來更新一下如何&ldquo;反推&rdquo;抽卡的真實概率，會更新兩個新話題：</p>
<p><strong>1.二項式分佈概率檢驗 Binomial Proportion Test</strong></p>
<p><strong>2.抽樣調查基礎理論 Sampling Survey </strong></p>
<p>如果發佈之後反響還不錯，我打算更新更多內容，比如：</p>
<p><strong>3.如何驗證遊戲公司有沒有區別對待各類別玩家（比如檢測中國的紫卡率是不是低於美國什麼的,安卓服務器是不是爆率低於蘋果服務器）</strong></p>
<p>4.強化裝備時失敗會掉級或者爆裝備，那理論上強到滿級的強化次數的期望值和方差怎麼算？</p>
</div>
</div>




</div>


</div>
</div>