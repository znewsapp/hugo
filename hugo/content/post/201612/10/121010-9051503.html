+++
date = "2016-12-10T10:00:00"
title = "新發布的完整版 Windows 10，是個新方向的開始"
titleimage = "http://pic1.zhimg.com/22dd9e61f8cc1bff41dd32f136b1c2a4.jpg"
ga = 121010
+++

<div class="main-wrap content-wrap">
<div class="headline">

<div class="img-place-holder"></div>



</div>

<div class="content-inner">




<div class="question">
<h2 class="question-title">如何評價微軟在 WinHEC 2016 大會上演示的基於 ARM 的完整版 Windows 10？</h2>

<div class="answer">



<div class="content">
<p>關於 API 模擬說的不精確，修改。</p>
<p>不願意看長篇大論的人，我給你準備了幾個言簡意賅的：</p>
<ul>
<li>HAL 的設計使得 Windows 加入新架構相對來說工作量不是無法完成。但也不是簡單的事情。</li>
<li>對於 x86 的 Emulation 不完全是軟件的指令翻譯。是利用新處理器架構加入的功能，在硬件抽象層和 Windows API 共同引入新的虛擬層，而不是模擬器或虛擬機，所以也不是絕對的直接指令翻譯。因此性能可以期待。同時因爲不是全虛擬，推測原有 X86 的內核態驅動應該是無法直接兼容。簡而言之是用戶態的二進制兼容。</li>
<li>從 Photoshop 和遊戲來看，絕大多數指令和系統 API 以外，跟 X86 關係很緊密的 DirectX 的支持應該也是實現了，不知道這裏怎麼做的，猜想下了很大精力。</li>
<li>大家可以期待一下 Surface Phone，大約就是和這個一起上了。考慮到 RS2 是 Creator Update，那這個東西到來的時間點應該是 RS3 或者 RS4（如果還這麼叫的話）。也就是&hellip;&hellip;至少明年秋&hellip;&hellip;:-(</li>
<li>目前只限於高通的 SOC，似乎還是僅限於 MSM8996 和以後的 8998。不知道啥時候可以開放給全系 ARM 使用。至少短期應該不會遍地寨機。Surface Phone 或者其它三方的旗艦 ARM 設備，可以期待一下。</li>
</ul>
<p>廢話多一點說一下我的理解，希望大家看完能有些啓發。</p>
<p>這個東西如果關注微軟 OS 近幾年的演變方向會覺得是一個很水到渠成的東西。</p>
<p>幾十年前，Microsoft 和 Intel 還是一對親密合作的好基友的時候，Intel 負責飆處理器性能，而 Microsoft 負責用軟件將這些性能榨光。這種搭配造就了 Wintel 聯盟幾十年的輝煌。</p>
<p>進入近十年以來，移動設備迅猛發展。消費領域對計算力的要求逐漸從繼續增強性能轉向到了減低功耗和增加續航。ARM 架構的 CPU 因爲良好的功耗控制以及相對越來越強的性能在移動市場攻城拔寨。同時桌面和筆記本市場本身由於被移動計算設備擠佔而增長乏力。Intel 還是想在移動計算市場拿一份蛋糕的。它使用的戰略是先拿着自家的閹割產品 Atom 去迎戰，沒想到瘦死的駱駝比馬大，然而駱駝瘦死了但市場要的是&ldquo;小&rdquo;而不是&ldquo;大&rdquo;。Atom 折騰幾年，除了因爲 Intel 的補貼讓山寨平板小發一筆外，市場一點也沒有起色。後來 Intel 砍了 Atom，但賊心不死又把 Core M 這東西拿出來，但是折騰到現在，還是解決不了幾個一直就必須要解決的問題：功耗下不來，待機上不去，GPU 弱到哭，基帶老又舊。</p>
<p>反觀微軟這邊，選擇繼續搞 X86 還是投向 ARM 都是艱難的決定，但總要押準未來風向才能佔據生態圈的頂峯。在鮑爾默時代末期，強調設備，於是乎一下子弄出兩個東西：Surface RT 和 Surface Pro。雖說都在 Surface 這個品牌下面，然而從操作系統層面講，這倆貨完全不是一個東西。RT 是跑在 ARM 上的一個定製版 Windows RT，而 Pro 是跑在 X86 上的完整 Windows。鮑老頭算盤打得好，就是腳踩兩隻船。ARM 和 X86 一個都不放棄。然而市場給出了當時的選擇：Pro 火了成就了 2-in-1 這個中間產品形態。而 RT 暴斃。RT 失敗的原因有多個，一個是當時的 ARM 性能並不強，一個是臨時拼湊的 Windows RT 太殘廢。同時，微軟在手機領域因爲跟 Nokia 的合作成立了手機部門，WP7，WP8 加上 Lumia 這個品牌軟硬一起上愣是活生生搞了幾年，叫好不叫座。情況是：X86 下正統 Windows 因爲桌面市場不景氣市場佔有率逐步下降，ARM 下 Windows RT 先天不足無力接管大局，同時 WP 也是另起爐竈的 OS 前途茫然。應用不兼容不說，維護多套系統也給微軟帶來了很大負擔。</p>
<p>好歹 Surface Pro 的成功給了 X86 以及這個生態圈新的希望。Intel 連續的 BroadWell 和 Skylake 還算堪用加上 Surface Pro 的示範效果拔羣，帶起來了二合一設備和超輕薄筆記本的市場，於是大家一窩蜂的做超輕薄的筆記本或，僞平板或者 2-in-1。然而 Intel 此時在 CPU 層面發力仍舊不夠，超低電壓的產品雖然持續改進功耗和電池消耗，但是想要達到更輕薄的平板甚至手機的要求還是勉強。大家都在想，Intel 嫩行不行啊，再擠牙膏我們就轉投 Android + ARM 陣營了。微軟一拍大腿，得了還得我發力。想我腳踩兩隻船做 RT 和 Pro，基於 ARM 的 OS 還是有點心得，我再繼續努力一下，把 Windows on ARM 不做成 RT 那種二等公民而是正宗 Windows，這樣應該可以了吧。於是全新的 Windows on ARM 就來了。</p>
<p>說拍大腿就弄出來是開玩笑，實際上一個 OS 的開發量是很恐怖的，不是想做就能做。做一個全新微處理器指令集和架構的 OS 可不是幾年就能搞定的，然而火燒眉毛了逼也要逼出一套東西來。微軟說不怕我會畫大餅，餅畫不好我還會改名！於是微軟下了很大的一盤棋：一方面把 Windows 版本號定死在 10，另一方面拋棄以往 n 年一代產品的開發模式而激進地採用了半年一個大 Release 的方式。把 OS 用互聯網快速開發快速上線這種思維來搞。同時宣佈移動操作系統也併入 Windows 10 旗下，叫做 Windows 10 Mobile。這麼做的潛臺詞是：這盤棋要下很久，但是下一點就給你扔一點成果出來給大家打打雞血。。。</p>
<p>大戲開場了。還記得前面的 Surface RT 麼，它除了燒一大筆錢外還留下了一個東西 -- WinRT，粗糙一點說，WinRT 就是一套全新爲現代硬件和移動 OS 設計的但是閹割過的 API。微軟在這個 API 的基礎上修修補補再加上重構弄出一個 Universal Windows API（具體名字到底是啥忘記了），用於跑 UWP。這套東西雖然沒辦法完全替代 Win32 API，但是優點是起點比 Win32 高，設計時就考慮了各種硬件產品形態，交互方式，以及現代的與底層分開的邏輯。Windows 10 的第一個正式版本其實就是加了 UWP 支持的 Windows，版本號應該是 10240 吧。這個版本只有 Desktop 版，因爲 Windows 10 Mobile 還沒來得及並進來。同時第一張大餅扔出來：UWP 乃未來，以後桌面手機都跑它。這套 API 因爲沒有歷史包袱加上設計時就考慮了不同形態的移動設備的支持要求，所以按照新 SDK 少量修改代碼的 WP8 或者 8.1 的 APP 也可以跑，總算是好歹出來了。</p>
<p>在第一個正式版之後接下來的的 Threshold 開發週期內，微軟不停的把 WinPhone 的代碼往 Windows 搬加上 APP 往 UWP 轉，慢慢地把 WP 釜底抽薪終於給弄出來 Win10 Mobile，記得版本號是 10586，這就是第一個 Mobile 的正式版，當然也有桌面版。不過我記得這個版本號的時候桌面版和 Mobile 版並不是一個發佈時間，從側面說明其實 Desktop 和 Mobile 還是沒有融合完全。直到 TH2，Windows 10 才做到了 Desktop 和 Mobile 的版本號同步。在 Threshold 期間，W10M 手機貌似看起來比 WP8 好不到哪兒去，甚至有時候功能還有退步，這就是因爲微軟還在吭哧吭哧地改底層東西，重心不在新功能。稍微深入點看，應用層面它既有原先 SilverLight 的 APP 又有 UWP 兩套體系，底層支持方面不停地從 WP 往 Win10 合併模塊和驅動謀求 OS 層面的完全融入。直白一點說， 一直處於修煉內功狀態而吃瓜羣衆看不出來。但是沒有餅吃瓜羣衆不幹了，這可不行。於是微軟拋出第二張餅 --Continuum。意思是你看 UWP 不光軟件能在兩邊跑，同樣的一個設備如果計算力足夠強，可以直接在一個 UWP 展現移動和桌面兩種使用形態。</p>
<p>到了 Redstone 時代，算一下此時其實已經過去了 2 年時間。對於市場來說，這實在是太長的一個時間了。回顧一下，X86 上由於 Surface Pro 的給力表現，再加上 Surface Book 的強心針，還是維持的不錯。然而 ARM 那邊一方面 RT 慘遭太監下面沒了，另一方面 Lumia 品牌由於 WP8 的不成熟和 Windows 10 Mobile 的糟糕表現，市場持續滑鐵盧。再加上跟 Nokia 的合同到期，微軟無奈之下，把 Lumia 砍了。個人來看，這個決定雖然無奈但也是可以理解的。畢竟做爲追趕者的 Windows 10 Mobile 並沒有短期追上 Android 和 iOS 的希望，再弄些糊弄人的設備出來騙不到錢也還會透支粉絲那裏的口碑。還好這些時間內功修煉的多，不是沒有收穫，在 RS1 週期內一方面 Desktop 端繼續強化 Windows 10 做出 Creator Update，另一方面 W10M 也繼續修煉內功將 WP 完全融入 Windows，從 Insider Preview 的節奏來看，這階段 Desktop 和 Mobile 可以算是完全同步了，UWP 在 API 和 SDK 層面也逐漸成熟。Windows 10 此時可算是神功初練成，可謂萬事俱備，只欠東風了。然而前面 Surface RT 的教訓還在，不管你叫 WinRT 還是叫 UWP，不能跑傳統 Win32 的東西，消費者是不買單的。如果要推出基於 ARM 的設備，Win32 程序的支持，是個繞不過去的話題。於是就出現這個現在也就解決方案了，微軟聯合高通軟硬兼施，想法簡單粗暴，既然要老的程序能跑，我就把老的 Win32 API 在 ARM 的 kernel 上再寫一遍嘛！同時通過跟高通擴展一下 ARM 指令集和增加 OS 層面虛擬層支持，軟硬兼施使得基本的 X86 指令能跑完整，這就是所謂的 X86 模擬了。</p>
<p>有了 X86 模擬，Windows 10 的下一個賣點就這麼來了 -- Windows on ARM。回頭看來，從 TH 階段就在做的 ARM64 架構支持，只有加上 X86 模擬，才能稱得上是完整的解決方案。在這上面，通過 Universal API 支持起 2 年以來的 UWP，通過 ARM 版 Windows 內核上的虛層加上支持原有的 Win32API 跑老程序。只要做到應用的二進制兼容，目的就達到了。有人說是&ldquo;模擬器&rdquo;或者是&ldquo;虛擬機&rdquo;從而擔心性能損失，然而這並不是完全的一對一的指令 CPU 微指令翻譯，所以可以相信即使有損失也不會很大。如果要類比的話，近一點可以類比 WSL，遠一點可以類比 WinNT 或者 2000 裏面的 NTVDM。當然這種層面的模擬也是有限制的，例如給 Win32 寫的內核驅動肯定不能直接拿來用，牽扯到 HAL 的內核子系統也需要重寫。微軟實現這個模擬 x86 的目的，只是爲了客戶一個時間窗口能夠慢慢地由使用 Win32 程序轉變到使用 UWP 應用。有人說只有完整原生支持 WinAPI 的程序纔是好 Windows 程序，然而 x86 和 WIN32 的歷史包袱實在是太重了，它們確實需要被替代。我個人認爲這種新設計一套 API，然後讓基於老 API 的程序在能被兼容運行的前提下慢慢消亡的做法，纔是正確的道路。</p>
<p>按照這個脈絡來看，微軟對於 Windows 的未來是貫徹並且堅決執行了 Windows as a service 這條道路的。就是說不管你硬件怎麼發展，Windows 都能做到讓用戶以最舒服的形式使用到即可。打通處理器架構的次元壁，確實是很有野心的想法。當然，這需要 Windows 發生一次由內到外猶如新生一般的蛻變，Windows 10，正處在這個蛻變過程當中。我個人認爲，微軟畫的大餅，其實已經暗含了以後的發展道路：打通處理器架構次元壁是其一，打通設備形態次元壁是其二，請期待 Continuum 接下來的形態。</p>
<p>從吃瓜羣衆的角度來看，Windows 10 其實在幾年內出現各種抽風不穩定和邏輯混亂的表現。消極的想，可以簡單認爲微軟不行了操作系統玩不轉了，而積極的想，是不是可以認爲其中蘊含着 OS 的大革命呢？ 同時，再聯想一下友商：你覺得 MacOS 最近表現不正常是爲什麼；MacOS 和 iOS 說要合併的流言是不是隔三差五就會聽到？再然後，你聽說過 Google 的 Andromeda 嗎？</p>
<p><strong>或許，你正處於見證這個行業再一次出現變革的偉大時代。</strong></p>
<p>本文通篇都是 YY。</p>
</div>
</div>




</div>


</div>
</div>